(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"+ooL":function(t,e,i){"use strict";i.d(e,"a",function(){return s});var n=i("TYT/"),r=i("K9Ia"),s=function(){function t(){this.colorSource=new r.a,this.blobSource=new r.a,this.color$=this.colorSource.asObservable(),this.blob$=this.blobSource.asObservable()}return t.prototype.setColor=function(t){this.colorSource.next(t)},t.prototype.setBlob=function(){this.blobSource.next(!0)},t.ngInjectableDef=n.Lb({token:t,factory:function(e){return new(e||t)},providedIn:null}),t}()},"/1T7":function(t,e,i){"use strict";e.a=function(){function t(t){this.tracks=[],this.discs=[],this.sortedDiscs=[],this.modified=0,this.isContinues=!0,t.album&&t.title&&(this.name=t.album,this.sortName=this.name.toUpperCase(),this.year=t.year,this.modified=t.modified,this.year&&-1!==this.year.indexOf("-")&&(this.year=this.year.split("-")[0]))}return t.prototype.url=function(){return"/letter/"+this.artist.letter.escapedLetter+"/artist/"+encodeURIComponent(this.artist.name)+"/album/"+encodeURIComponent(this.name)},t}()},0:function(t,e,i){t.exports=i("zUnb")},"0/mZ":function(t,e,i){"use strict";var n=i("TYT/"),r=i("ztCj"),s=i("XWo6"),a=i("cUzu"),o=function(t,e,i,n){return new(i||(i=Promise))(function(r,s){function a(t){try{c(n.next(t))}catch(e){s(e)}}function o(t){try{c(n.throw(t))}catch(e){s(e)}}function c(t){t.done?r(t.value):new i(function(e){e(t.value)}).then(a,o)}c((n=n.apply(t,e||[])).next())})},c=function(t,e){var i,n,r,s,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(r=2&s[0]?n.return:s[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,s[1])).done)return r;switch(n=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(o){s=[6,o],n=0}finally{i=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}},l=function(){function t(t){this.http=t,this.API_KEY="639fca5adcf955a19f9a04f8985e9ded",this.lastFMImageRetriever=new s.a(t)}return t.prototype.getMediaArt=function(t){var e=this.extractInfo(t);return this.lastFMImageRetriever.getMediaArt(e.artist,e.album,e.type)},t.prototype.getMediaArtFromLastFm=function(t){var e=this.extractInfo(t);return this.lastFMImageRetriever.getMediaArt(e.artist,e.album,e.type)},t.prototype.returnImageUrlFromLastFMResponse=function(t){return o(this,void 0,void 0,function(){var e;return c(this,function(i){return t.album?[2,t.album.image[t.album.image.length-1]["#text"]]:t.artist?(e=t.artist.mbid)?[2,this.getArtistURLArtFormFanart(e,t.artist)]:[2,t.artist.image[t.artist.image.length-1]["#text"]]:[2,t]})})},t.prototype.getArtistURLArtFormFanart=function(t,e){return o(this,void 0,void 0,function(){var i,n;return c(this,function(r){switch(r.label){case 0:return[4,fetch("https://webservice.fanart.tv/v3/music/"+t+"&?api_key="+this.API_KEY+"&format=json")];case 1:return 200!==(i=r.sent()).status?[3,3]:[4,i.json()];case 2:if((n=r.sent()).artistbackground)return[2,n.artistbackground[0].url];r.label=3;case 3:return[2,this.getArtistURLArtFromAudioDB(e)]}})})},t.prototype.getArtistURLArtFromAudioDB=function(t){return o(this,void 0,void 0,function(){var e,i;return c(this,function(n){switch(n.label){case 0:return[4,fetch("https://www.theaudiodb.com/api/v1/json/1/search.php?s="+encodeURIComponent(t.name))];case 1:return 200!==(e=n.sent()).status?[3,3]:[4,e.json()];case 2:if((i=n.sent())&&i.artists)return[2,i.artists[0].strArtistFanart];n.label=3;case 3:return[2,t.image[t.image.length-1]["#text"]]}})})},t.prototype.extractInfo=function(t){var e="",i="",n="artist";return t.trackArtist&&t.album.artist.isCollection?e=t.trackArtist:t.artist?(e=t.artist.albumArtist||t.artist.name,i=t.name||t.album.name,n="album"):e=t.albumArtist||t.name,{artist:e,album:i,type:n}},t.ngInjectableDef=n.Lb({token:t,factory:function(e){return new(e||t)(n.Wb(a.a))},providedIn:null}),t}();i.d(e,"a",function(){return d});var u=function(t,e,i,n){return new(i||(i=Promise))(function(r,s){function a(t){try{c(n.next(t))}catch(e){s(e)}}function o(t){try{c(n.throw(t))}catch(e){s(e)}}function c(t){t.done?r(t.value):new i(function(e){e(t.value)}).then(a,o)}c((n=n.apply(t,e||[])).next())})},h=function(t,e){var i,n,r,s,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(r=2&s[0]?n.return:s[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,s[1])).done)return r;switch(n=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(o){s=[6,o],n=0}finally{i=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}},d=function(){function t(t,e){var i=this;this.backgroundArtService=e,this.NOIMAGE="global/images/no-cover.png",this.loading=!1,this.loaded=!1,this.error=!1,this.loadingClass="loading",this.loadedClass="loaded",this.errorClass="error",this.el=t.nativeElement,setTimeout(function(){i.loadImage()},100)}return t.prototype.loadImage=function(){var t=this;if(!this.loaded&&!this.loading||this.hasClassName("always-replace")){this.loading=!0,this.addClassName(this.loadingClass);var e="art-"+this.media.name;this.media.artist&&!this.media.trackArtist?e="art-"+this.media.artist.name+"-"+this.media.name:this.media.trackArtist&&(e="art-"+this.media.trackArtist+"-"+this.media.album.name),Object(r.b)(e).then(function(e){e?t.setImage(e):t.backgroundArtService.getMediaArt(t.media).subscribe(function(e){return t.setImage(e)},function(e){t.el.style.backgroundImage="url("+t.NOIMAGE+")",t.error=!0,t.loading=!1,t.removeClassName(t.loadingClass),t.addClassName(t.errorClass)})})}},t.prototype.setImage=function(t){return u(this,void 0,void 0,function(){var e,i,n=this;return h(this,function(s){switch(s.label){case 0:return(e=localStorage.getItem("dsm"))&&(e+="/data/image-proxy?url="),this.loaded&&!this.hasClassName("always-replace")?[3,4]:t!==this.NOIMAGE&&""!==t&&t?[3,1]:(this.backgroundArtService.getMediaArtFromLastFm(this.media).subscribe(function(t){return u(n,void 0,void 0,function(){var i;return h(this,function(n){switch(n.label){case 0:return[4,this.backgroundArtService.returnImageUrlFromLastFMResponse(t)];case 1:return(t=n.sent())&&t!==this.NOIMAGE?this.el.style.backgroundImage="url("+e+encodeURIComponent(t)+")":(t||(t=this.NOIMAGE),this.el.style.backgroundImage="url("+t+")"),i={_id:"art-"+this.media.name,url:t||this.NOIMAGE},this.media.artist&&(i._id="art-"+this.media.artist.name+"-"+this.media.name),Object(r.c)(i._id,i.url),[2]}})})},function(t){return n.el.style.backgroundImage="url("+n.NOIMAGE+")"}),[3,3]);case 1:return[4,this.backgroundArtService.returnImageUrlFromLastFMResponse(t)];case 2:t=s.sent(),this.el.style.backgroundImage=t?"url("+t+")":"url("+this.NOIMAGE+")",i={_id:"art-"+this.media.name,url:t||this.NOIMAGE},this.media.artist&&(i._id="art-"+this.media.artist.name+"-"+this.media.name),Object(r.c)(i._id,i.url),s.label=3;case 3:this.loading=!1,this.toggleLoaded(!0),s.label=4;case 4:return[2]}})})},t.prototype.getPosition=function(){var t=this.el.getBoundingClientRect(),e=t.top+(window.pageYOffset-document.documentElement.clientTop);return{top:e,left:t.left+(window.pageXOffset-document.documentElement.clientLeft),bottom:e+this.el.clientHeight}},t.prototype.getLoadingContainer=function(){return this.el},t.prototype.hasClassName=function(t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(this.getLoadingContainer().className)},t.prototype.addClassName=function(t){if(!this.hasClassName(t)){var e=this.getLoadingContainer();e.className=e.className?[e.className,t].join(" "):t}},t.prototype.removeClassName=function(t){if(this.hasClassName(t)){var e=this.getLoadingContainer();e.className=e.className.replace(new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)","g"),"")}},t.prototype.toggleLoaded=function(t){this.loaded=t,t?(this.removeClassName(this.loadingClass),this.addClassName(this.loadedClass)):this.removeClassName(this.loadedClass)},t.ngDirectiveDef=n.Kb({type:t,selectors:[["","mdb-BackgroundArt",""]],factory:function(e){return new(e||t)(n.Pb(n.p),n.Pb(l))},inputs:{media:["mdb-BackgroundArt","media"]},features:[n.Db([l])]}),t}()},"1gFc":function(t,e,i){"use strict";i.d(e,"a",function(){return r});var n=i("TYT/"),r=function(){function t(){}return t.prototype.requestAnimation=function(t,e,i){void 0===t&&(t="enter"),void 0===i&&(i=!0),e&&(e.classList.contains(t)&&e.classList.remove(t),setTimeout(function(){e.classList.add(t)},10),i&&setTimeout(function(){e.classList.remove(t)},150))},t.ngInjectableDef=n.Lb({token:t,factory:function(e){return new(e||t)},providedIn:null}),t}()},"9dPn":function(t,e,i){"use strict";var n=i("TYT/"),r=i("ztCj"),s=(i("/1T7"),i("uwnU"),i("Zp9u")),a=i("+ooL"),o=i("riCG"),c=function(){return function(){}}();i.d(e,"a",function(){return u});var l=[1,"albumart",3,"src","alt"],u=function(){function t(t,e,i){var n=this;this.albumArtService=t,this.elementRef=e,this.colorService=i,this.albumart=new c,this.dynamicAccentColor=!1,this.searchType="album",this.NOIMAGE="global/images/no-cover.png",this.hasEvent=!1,this.albumart.name="Unknown album",this.albumart.url=this.NOIMAGE,this.subscription=this.colorService.blob$.subscribe(function(){var t=new Blob([window.externalBlob],{type:"image/png"}),e=URL.createObjectURL(t),i=new Image;i.src=e,Object(o.d)(i,function(t){var e=Object(o.c)(t);n.colorService.setColor(e.rgba),Object(o.a)(e)},!0)})}return t.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},t.prototype.ngOnInit=function(){var t=this,e="";if(this.album?(this.albumart.name=this.album.name,this.searchArtist=this.album.artist.albumArtist||this.album.artist.name,this.searchAlbum=this.album.name,e="art-"+this.searchArtist+"-"+this.searchAlbum):(this.albumart.name=this.track.album.name,this.searchArtist=this.track.trackArtist,this.searchAlbum=this.track.album.name,this.track.album.artist.isCollection?(this.searchType="artist",e="art-"+this.searchArtist):(this.searchType="album",e="art-"+this.searchArtist+"-"+this.searchAlbum)),Object(r.b)(e).then(function(e){e?t.setImage(e):t.albumArtService.getAlbumArt(t.searchArtist,t.searchAlbum,t.searchType).subscribe(function(e){return t.setImage(e)},function(e){return t.albumart.url=t.NOIMAGE})}),this.dynamicAccentColor&&!this.hasEvent){var i=this;this.elementRef.nativeElement.childNodes[0].addEventListener("load",function(){Object(o.d)(this,function(t){var e=Object(o.c)(t);i.colorService.setColor(e.rgba),Object(o.a)(e)},!1)},{passive:!0}),this.hasEvent=!0}},t.prototype.ngOnChanges=function(t){this.ngOnInit()},t.prototype.setImage=function(t){var e=this,i=localStorage.getItem("dsm");if(i&&(i+="/data/image-proxy?url="),"global/images/no-cover.png"!==t&&""!==t&&t){(t=this.albumArtService.returnImageUrlFromLastFMResponse(t))instanceof Object?(t=this.NOIMAGE,this.albumart.url=this.NOIMAGE):this.albumart.url=""+i+encodeURIComponent(t);var n={_id:"art-"+this.searchArtist+"-"+this.searchAlbum,url:t||this.NOIMAGE};Object(r.c)(n._id,n.url)}else this.albumArtService.getMediaArtFromLastFm(this.searchArtist,this.searchAlbum,this.searchType).subscribe(function(t){(t=e.albumArtService.returnImageUrlFromLastFMResponse(t))instanceof Object&&(t=e.NOIMAGE),t&&"global/images/no-cover.png"!==t?e.albumart.url=""+i+encodeURIComponent(t):(t||(t=e.NOIMAGE),e.albumart.url=t);var n={_id:"art-"+e.searchArtist+"-"+e.searchAlbum,url:t||e.NOIMAGE};Object(r.c)(n._id,n.url)},function(t){return e.albumart.url=e.NOIMAGE})},t.ngComponentDef=n.Jb({type:t,selectors:[["mdb-album-art"]],factory:function(e){return new(e||t)(n.Pb(s.a),n.Pb(n.p),n.Pb(a.a))},inputs:{album:"album",track:"track",dynamicAccentColor:["dynamic-accent-color","dynamicAccentColor"]},features:[n.Db([s.a]),n.Cb()],consts:1,vars:2,template:function(t,e){1&t&&n.Qb(0,"img",l),2&t&&(n.lc("src",e.albumart.url,n.xc),n.lc("alt",e.albumart.name))},encapsulation:2}),t}()},EAnT:function(t,e,i){"use strict";i.d(e,"a",function(){return l});var n=i("TYT/"),r=(i("LNEh"),i("0/mZ")),s=i("DUip"),a=[1,"panel-background",3,"mdb-BackgroundArt","click"],o=[1,"panel-info","color-type-primary-alt"],c=[1,"small","muted"],l=function(){function t(t){this.router=t}return t.prototype.select=function(){this.router.navigate(["letter",this.artist.letter.escapedLetter,"artist",this.artist.sortName])},t.ngComponentDef=n.Jb({type:t,selectors:[["mdb-artist"]],factory:function(e){return new(e||t)(n.Pb(s.c))},viewQuery:function(t,e){var i;1&t&&n.Kc(r.a,!0,null),2&t&&n.sc(i=n.bc())&&(e.backgroundArt=i.first)},inputs:{artist:"artist"},consts:6,vars:3,template:function(t,e){1&t&&(n.Tb(0,"div",a),n.Zb("click",function(t){return e.select()}),n.Tb(1,"div",o),n.Tb(2,"span"),n.Gc(3),n.Rb(),n.Tb(4,"span",c),n.Gc(5),n.Rb(),n.Rb(),n.Rb()),2&t&&(n.kc("mdb-BackgroundArt",e.artist),n.yc(3),n.Hc(e.artist.albumArtist||e.artist.name),n.yc(5),n.Ic("Albums: ",e.artist.albums.length,""))},directives:[r.a],encapsulation:2}),t}()},Gcu2:function(t,e,i){"use strict";i.d(e,"a",function(){return l});var n=i("TYT/"),r=i("K9Ia"),s=i("LNEh"),a=i("ktVm"),o=i("t083"),c=i("KI15"),l=function(){function t(t,e){this.coreService=t,this.lastfmservice=e,this.playlistSubject=new r.a,this.playlistAnnounced$=this.playlistSubject.asObservable(),this.numberOfTracksInAPlaylist=100,this.username=localStorage.getItem("lastfm-username"),this.core=this.coreService.getCore()}return t.prototype.generateRandom=function(){var t=this,e=Object.keys(this.core.tracks),i=this.shuffle(e).splice(0,this.numberOfTracksInAPlaylist),n=new c.a;return n.name=this.numberOfTracksInAPlaylist+" random tracks",i.map(function(e){n.tracks.push(t.core.tracks[e])}),n},t.prototype.generateRadio=function(){var t=this;this.lastfmservice.getTopArtists(this.username).subscribe(function(e){t.playlistSubject.next(t.extractArtists(e))})},t.prototype.extractTracks=function(t){var e=this,i=new c.a;return i.name="Loved tracks on Last.FM",t.map(function(t){var n=e.core.getTrackByArtistAndName(t.artist.name,t.name);n&&i.tracks.push(n)}),i},t.prototype.extractArtists=function(t){var e=this,i=[],n=[];return t.forEach(function(t,r){t.dummy=!0;var a=new s.a(t),o=e.core.artists[a.sortName];o&&r<10?i.push(o):n.push(o)}),this.generateRadioList(i,n)},t.prototype.generateRadioList=function(t,e){var i=new c.a;i.name=this.numberOfTracksInAPlaylist+" random tracks based on your recently listened tracks";for(var n=0;n<this.numberOfTracksInAPlaylist;n++)i.tracks.push(this.getRandomTrackFromList(n%3==0||n%5==0?t:n%4==0||n%7==0?e:this.core.artistsList()));return i},t.prototype.getRandomTrackFromList=function(t){var e=this.shuffle(t)[0];if(e){var i=this.shuffle(e.albums)[0],n=this.shuffle(i.tracks)[0];return n.duration<=6e5?n:this.getRandomTrackFromList(t)}return this.getRandomTrackFromList(t)},t.prototype.shuffle=function(t){for(var e=t.length-1;e>0;e--){var i=Math.floor(Math.random()*(e+1)),n=t[e];t[e]=t[i],t[i]=n}return t},t.prototype.getNextTrackForPlaylist=function(t,e){var i=this.getRandomTrackFromList(t);return i?e.tracks.length>1&&e.tracks[e.tracks.length-1].artist===i.artist&&t.length>1?this.getNextTrackForPlaylist(t,e):i:null},t.ngInjectableDef=n.Lb({token:t,factory:function(e){return new(e||t)(n.Wb(a.a),n.Wb(o.a))},providedIn:null}),t}()},KI15:function(t,e,i){"use strict";i.d(e,"a",function(){return n});var n=function(){return function(){this.tracks=[],this.isOwn=!1,this.isContinues=!1}}()},LNEh:function(t,e,i){"use strict";e.a=function(){function t(t){this.albums=[],(t.album&&t.title||t.dummy)&&(this.name=t.name||t.artist||"",this.albumArtist=t.albumartist||t.albumArtist||"",this.sortName=this.stripFromName(this.albumArtist?this.albumArtist.toUpperCase():t.sortName?t.sortName.toUpperCase():this.name.toUpperCase(),["the ",'"',"a "]),this.bio=t.bio,this.isCollection=!!this.albumArtist&&this.name!==this.albumArtist)}return t.prototype.url=function(){return"/letter/"+this.letter.escapedLetter+"/artist/"+encodeURIComponent(this.albumArtist||this.name)+"/"},t.prototype.sortAlbumsBy=function(t,e){void 0===t&&(t="name"),void 0===e&&(e="asc"),this.albums.sort(function(i,n){if(-1!==t.indexOf(".")){var r=t.split(".");return i[r[0]][r[1]]<n[r[0]][r[1]]?"asc"===e?-1:1:i[r[0]][r[1]]>n[r[0]][r[1]]?"asc"===e?1:-1:0}return i[t]<n[t]?"asc"===e?-1:1:i[t]>n[t]?"asc"===e?1:-1:0})},t.prototype.sortAndReturnAlbumsBy=function(t,e){return void 0===t&&(t="name"),void 0===e&&(e="asc"),this.sortAlbumsBy(t,e),this.albums},t.prototype.stripFromName=function(t,e){var i=t?t.toUpperCase():"";return i=i.trim(),e.forEach(function(t){var e=t.toUpperCase();0===i.indexOf(e)&&(i=i.substring(e.length))}),i},t}()},MDLy:function(t,e,i){"use strict";i.d(e,"a",function(){return c});var n=i("TYT/"),r=i("XlPw"),s=i("9Z1F"),a=i("Gi3i"),o=i("cUzu"),c=function(){function t(t){this.http=t,this.collectionUrl="/data/node-music.json",this.reloadUrl="/rescan",this.pollUrl="/progress",this.dsm=localStorage.getItem("dsm")}return t.prototype.getCollection=function(){return this.dsm=localStorage.getItem("dsm"),this.http.get(this.dsm+this.collectionUrl).pipe(Object(s.a)(this.handleError))},t.prototype.reload=function(){var t=this.dsm+this.reloadUrl,e=localStorage.getItem("jwt");return this.http.get(t+"?_ts="+(new Date).getTime()+"&jwt="+e).pipe(Object(s.a)(this.handleError))},t.prototype.poll=function(){var t=this.dsm+this.pollUrl,e=localStorage.getItem("jwt");return this.http.get(t+"?_ts="+(new Date).getTime()+"&jwt="+e).pipe(Object(a.a)(300),Object(s.a)(this.handleError))},t.prototype.handleError=function(t){var e=t.message?t.message:t.status?t.status+" - "+t.statusText:"Server error";return Object(r.a)(e)},t.ngInjectableDef=n.Lb({token:t,factory:function(e){return new(e||t)(n.Wb(o.a))},providedIn:null}),t}()},OgP6:function(t,e,i){"use strict";i.d(e,"a",function(){return c});var n=i("K9Ia"),r=i("XlPw"),s=i("TYT/"),a=i("9Z1F"),o=i("cUzu"),c=function(){function t(t){this.http=t,this.geoSource=new n.a,this.themeSource=new n.a,this.modeSource=new n.a,this.theme$=this.themeSource.asObservable(),this.mode$=this.modeSource.asObservable(),this.geo$=this.geoSource.asObservable(),this._theme=localStorage.getItem("theme")||"light",this._mode="light",this.counter=0,this.COUNTERTIMER=6e4}return Object.defineProperty(t.prototype,"theme",{get:function(){return this._theme},set:function(t){var e=this;this._theme!==t&&(this._theme=t),"auto"!==this._theme||this.counter?"auto"===this._theme||(this.setStyleSheet(this._theme),clearInterval(this.counter),this.counter=0,this._mode=this._theme):(this.counter=setInterval(function(){e.checkTheme()},this.COUNTERTIMER),this.checkTheme())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mode",{get:function(){return this._mode},enumerable:!0,configurable:!0}),t.prototype.getSunriseInfo=function(t,e){return void 0===t&&(t=51),void 0===e&&(e=5),this.http.get("https://api.sunrise-sunset.org/json?lat="+t+"&lng="+e+"&formatted=0").pipe(Object(a.a)(this.handleError))},t.prototype.applyTheme=function(){var t=this;"auto"===this._theme?(this.counter||(this.counter=setInterval(function(){t.checkTheme()},this.COUNTERTIMER)),this.checkTheme(!0)):this.setStyleSheet(this._theme)},t.prototype.checkTheme=function(t){void 0===t&&(t=!1);var e=new Date;e<this.stopDate&&e>this.startDate&&"dark"!==this._mode?(this._mode="dark",this.setStyleSheet(this._mode)):(e>this.stopDate||e<this.startDate)&&"light"!==this._mode&&(this._mode="light",this.setStyleSheet(this._mode)),t&&this.setStyleSheet(this._mode)},t.prototype.handleError=function(t){return Object(r.a)(null)},t.prototype.setStyleSheet=function(t){var e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("href","prod"!==window.ENV&&window.ENV?"/dist/sass/"+t+".css":"global/css/"+t+".css"),e.setAttribute("id","customStylesheet");var i=document.getElementById("customStylesheet");i&&document.getElementsByTagName("head")[0].removeChild(i),document.getElementsByTagName("head")[0].appendChild(e),localStorage.setItem("theme",this._theme),localStorage.setItem("style",t),this.themeSource.next(this._theme),this.modeSource.next(t)},t.ngInjectableDef=s.Lb({token:t,factory:function(e){return new(e||t)(s.Wb(o.a))},providedIn:null}),t}()},Oz9T:function(t,e,i){"use strict";i.d(e,"a",function(){return T});var n=i("TYT/"),r=i("KI15"),s=i("ufXC"),a=i("Valr"),o=i("cpgm"),c=[1,"list-group","list-tracks"],l=["class","list-group-item row",3,"ngClass","click",4,"ngFor","ngForOf"],u=[1,"list-group-item","row",3,"ngClass","click"],h=[1,"col-8","col-md-10","track-info"],d=[4,"ngIf"],p=[1,"small","muted","color-type-secondary"],f=[1,"col","text-right"],m=[1,"glyph","glyph-pause"];function b(t,e){1&t&&(n.Tb(0,"span"),n.Qb(1,"span",m),n.Rb())}var g=[1,"glyph","glyph-play"];function y(t,e){1&t&&(n.Tb(0,"span"),n.Qb(1,"span",g),n.Rb())}function v(t,e){if(1&t&&(n.Tb(0,"span"),n.Tb(1,"span",p),n.Gc(2),n.Rb(),n.Rb()),2&t){var i=n.ec().$implicit;n.yc(2),n.Hc(i.type)}}function k(t,e){if(1&t&&(n.Tb(0,"span"),n.Tb(1,"span",p),n.Gc(2),n.fc(3,"timeFormat"),n.Rb(),n.Rb()),2&t){var i=n.ec().$implicit;n.yc(2),n.Ic("",n.gc(3,1,i.position)," \xa0")}}var S=function(t){return{active:t}};function w(t,e){if(1&t){var i=n.Ub();n.Tb(0,"li",u),n.Zb("click",function(t){n.vc(i);var r=e.$implicit;return n.ec().select(r)}),n.Tb(1,"div",h),n.Ec(2,b,2,0,"span",d),n.Ec(3,y,2,0,"span",d),n.Gc(4),n.Qb(5,"br"),n.Tb(6,"span",p),n.Gc(7),n.Rb(),n.Rb(),n.Tb(8,"div",f),n.Gc(9),n.fc(10,"timeFormat"),n.Qb(11,"br"),n.Ec(12,v,3,1,"span",d),n.Ec(13,k,4,3,"span",d),n.Rb(),n.Rb()}if(2&t){var r=e.$implicit;n.kc("ngClass",n.nc(11,S,r.isPlaying||r.isPaused)),n.yc(2),n.kc("ngIf",!r.isPlaying&&r.isPaused),n.yc(3),n.kc("ngIf",r.isPlaying&&!r.isPaused),n.yc(4),n.Ic("",r.title," "),n.yc(7),n.Jc(" ",r.trackArtist," \u2022 ",r.album.name," "),n.yc(9),n.Ic(" ",n.gc(10,9,r.duration)," "),n.yc(12),n.kc("ngIf",!r.isPlaying),n.yc(13),n.kc("ngIf",r.isPlaying)}}var T=function(){function t(t){var e=this;if(this.playerservice=t,this.playlist={},this.isBusy=!1,this.ownPlaylists=[],localStorage.getItem("customlisttest")){var i=JSON.parse(localStorage.getItem("customlisttest"));i&&i.forEach(function(t){var i=new r.a;i.isOwn=!0,i.name=t.name,i.tracks=t.tracks,e.ownPlaylists.push(i)})}}return t.prototype.select=function(t){this.isBusy||this.playerservice.doPlayAlbum(this.playlist,this.playlist.tracks.indexOf(t),!0)},t.prototype.removeFromPlaylist=function(t,e){var i=this;this.isBusy=!0,setTimeout(function(){i.isBusy=!1},5),this.ownPlaylists.forEach(function(i){if(t.name===i.name){var n=t.tracks.indexOf(e);t.tracks.splice(n,1),i.tracks.splice(n,1)}}),localStorage.setItem("customlisttest",JSON.stringify(this.ownPlaylists))},t.ngComponentDef=n.Jb({type:t,selectors:[["mdb-tracklist"]],factory:function(e){return new(e||t)(n.Pb(s.a))},inputs:{playlist:"playlist"},consts:2,vars:1,template:function(t,e){1&t&&(n.Tb(0,"ol",c),n.Ec(1,w,14,13,"li",l),n.Rb()),2&t&&(n.yc(1),n.kc("ngForOf",e.playlist.tracks))},directives:[a.k,a.j,a.l],pipes:[o.a],encapsulation:2}),t}()},UrAU:function(t,e,i){"use strict";i.d(e,"a",function(){return d});var n=i("TYT/"),r=(i("/1T7"),i("0/mZ")),s=i("DUip"),a=i("Valr"),o=[1,"panel-background",3,"mdb-BackgroundArt","click"],c=[1,"panel-info","color-type-primary-alt"],l=[1,"small","muted"],u=[4,"ngIf"];function h(t,e){if(1&t&&(n.Tb(0,"span"),n.Gc(1),n.Rb()),2&t){var i=n.ec();n.yc(1),n.Ic("Year: ",i.album.year,"")}}var d=function(){function t(t){this.router=t}return t.prototype.select=function(){this.router.navigate(["letter",this.album.artist.letter.escapedLetter,"artist",this.album.artist.sortName,"album",this.album.sortName])},t.ngComponentDef=n.Jb({type:t,selectors:[["mdb-album"]],factory:function(e){return new(e||t)(n.Pb(s.c))},viewQuery:function(t,e){var i;1&t&&n.Kc(r.a,!0,null),2&t&&n.sc(i=n.bc())&&(e.backgroundArtDirective=i.first)},inputs:{album:"album"},consts:6,vars:3,template:function(t,e){1&t&&(n.Tb(0,"div",o),n.Zb("click",function(t){return e.select()}),n.Tb(1,"div",c),n.Tb(2,"span"),n.Gc(3),n.Rb(),n.Tb(4,"span",l),n.Ec(5,h,2,1,"span",u),n.Rb(),n.Rb(),n.Rb()),2&t&&(n.kc("mdb-BackgroundArt",e.album),n.yc(3),n.Hc(e.album.name),n.yc(5),n.kc("ngIf",0!==e.album.year))},directives:[r.a,a.l],encapsulation:2}),t}()},Vmu9:function(t,e,i){"use strict";i.d(e,"a",function(){return c});var n=i("TYT/"),r=document.documentElement,s=r.matches?"matches":r.matchesSelector?"matchesSelector":r.webkitMatches?"webkitMatches":r.webkitMatchesSelector?"webkitMatchesSelector":r.msMatches?"msMatches":r.msMatchesSelector?"msMatchesSelector":r.mozMatches?"mozMatches":r.mozMatchesSelector?"mozMatchesSelector":null;function a(){if("pageYOffset"in window)return{scrollTop:pageYOffset,scrollLeft:pageXOffset};var t=document,e=t.documentElement,i=t.body;return{scrollTop:e.scrollTop||i.scrollTop||0,scrollLeft:e.scrollLeft||i.scrollLeft||0}}function o(t,e){return t===window||t===document.querySelector("body")?"clientWidth"===e?window.innerWidth:window.innerHeight:t[e]}var c=function(){function t(t,e,i,n){var r,s=this;this._element=t,this._viewContainer=e,this._templateRef=i,this._ngZone=n,this.vsOffsetBefore=0,this.vsOffsetAfter=0,this.vsExcess=2,this.tagName="div",this.__horizontal=!1,this._originalCollection=[],this._slicedCollection=[],this.updateInnerCollection=function(){var t,e,i,n,r=(t=window,e=s.scrollPos,t===window?a()[e]:t[e]),c=o(s.scrollParent,s.clientSize),l=s.parent===s.scrollParent?0:(i=s.scrollParent,n=s.__horizontal,s.parent.getBoundingClientRect()[n?"left":"top"]-(i===window?0:i.getBoundingClientRect()[n?"left":"top"])+(i===window?a():i)[n?"scrollLeft":"scrollTop"]),u=s.startIndex,h=s.endIndex;if(void 0!==s.vsSize){for(u=0;s.sizesCumulative[u]<r-s.vsOffsetBefore;)u++;for(u>0&&u--,h=u=Math.max(Math.floor(u-s.vsExcess/2),0);s.sizesCumulative[h]<r-s.vsOffsetBefore+c;)h++;h=Math.min(Math.ceil(h+s.vsExcess/2),s.originalLength)}else u=Math.max(Math.floor((r-s.vsOffsetBefore-l)/s.elementSize)-s.vsExcess/2,0),h=Math.min(u+Math.ceil(c/s.elementSize)+s.vsExcess,s.originalLength);s._minStartIndex=Math.min(u,s._minStartIndex),s._maxEndIndex=Math.max(h,s._maxEndIndex),s.startIndex=s.__options.latch?s._minStartIndex:u,s.endIndex=s.__options.latch?s._maxEndIndex:h;var d=!1;if(null==s._prevStartIndex?d=!0:null==s._prevEndIndex&&(d=!0),d||(s.__options.hunked?Math.abs(s.startIndex-s._prevStartIndex)>=s.vsExcess/2||0===s.startIndex&&0!==s._prevStartIndex?d=!0:(Math.abs(s.endIndex-s._prevEndIndex)>=s.vsExcess/2||s.endIndex===s.originalLength&&s._prevEndIndex!==s.originalLength)&&(d=!0):d=s.startIndex!==s._prevStartIndex||s.endIndex!==s._prevEndIndex),d){s.slicedCollection=s.originalCollection.slice(s.startIndex,s.endIndex),s.view.context.vsStartIndex=s.startIndex,s._prevStartIndex=s.startIndex,s._prevEndIndex=s.endIndex;var p=s._getOffset(0),f=s._getOffset(s.slicedCollection.length),m=s.totalSize,b=s.__horizontal?"width":"height";s.before.style[b]=p+"px",s.after.style[b]=m-f+"px"}return d},this.onZone=this._ngZone.onStable.subscribe(function(){if(s.scrollParent){var t=o(s.scrollParent,s.clientSize);t!==r?(r=t,s._ngZone.run(function(){s.refresh()})):r=t}})}return Object.defineProperty(t.prototype,"originalCollection",{get:function(){return this._originalCollection},set:function(t){this._originalCollection=t||[],this.scrollParent?this.refresh():this.postDigest(this.refresh.bind(this))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"slicedCollection",{get:function(){return this._slicedCollection},set:function(t){this._slicedCollection=t,this.view.context.vsCollection=this._slicedCollection},enumerable:!0,configurable:!0}),t.prototype.ngOnChanges=function(){this.scrollParent?this.refresh():this.postDigest(this.refresh.bind(this))},t.prototype.postDigest=function(t){var e=this._ngZone.onStable.subscribe(function(){t(),e.unsubscribe()})},t.prototype.initPlaceholders=function(){this.before=document.createElement(this.tagName),this.before.className="vsFor-before",this.after=document.createElement(this.tagName),this.after.className="vsFor-after",this.parent.insertBefore(this.before,this.parent.childNodes[0]),this.parent.appendChild(this.after),this.__horizontal?(this.before.style.height="100%",this.after.style.height="100%"):(this.before.style.width="100%",this.after.style.width="100%")},t.prototype.ngOnInit=function(){var t=this;this.view=this._viewContainer.createEmbeddedView(this._templateRef),this.parent=this.view.rootNodes[0],this.initPlaceholders(),this.__horizontal=!1,this.__autoSize=!0,this.__options={},this.clientSize=this.__horizontal?"clientWidth":"clientHeight",this.offsetSize=this.__horizontal?"offsetWidth":"offsetHeight",this.scrollPos=this.__horizontal?"scrollLeft":"scrollTop",this.scrollParent=this.vsScrollParent?function(t,e){for(;t!==document.documentElement&&null!=t&&!t[s](e);)t=t.parentNode;return t&&t[s](e)?t:null}(this.parent,this.vsScrollParent):this.parent,this.elementSize=o(this.scrollParent,this.clientSize)||50,this.totalSize=0,void 0!==this.vsSize&&(this.sizesCumulative=[]),this.startIndex=0,this.endIndex=0,document.addEventListener("scroll",this.updateInnerCollection),this.onWindowResize=function(){t.vsAutoresize?(t.__autoSize=!0,t._ngZone.run(function(){t.setAutoSize()})):t._ngZone.run(function(){t.updateInnerCollection()})},window.addEventListener("resize",this.onWindowResize)},t.prototype.ngOnDestroy=function(){window.removeEventListener("resize",this.onWindowResize),this.onZone&&this.onZone.unsubscribe(),document.removeEventListener("scroll",this.updateInnerCollection)},t.prototype.refresh=function(){var t=this;if(!this.originalCollection||this.originalCollection.length<1)this.slicedCollection=[],this.originalLength=0,this.updateTotalSize(0),this.sizesCumulative=[0];else if(this.originalLength=this.originalCollection.length,void 0!==this.vsSize){this.sizes=this.originalCollection.map(function(e,i){return"function"==typeof t.vsSize?t.vsSize(e,i):+t.vsSize});var e=0;this.sizesCumulative=this.sizes.map(function(t){var i=e;return e+=t,i}),this.sizesCumulative.push(e)}else this.__autoSize=!0,this.postDigest(this.setAutoSize.bind(this));this.reinitialize()},t.prototype.updateTotalSize=function(t){this.totalSize=this.vsOffsetBefore+t+this.vsOffsetAfter},t.prototype.reinitialize=function(){this._prevStartIndex=void 0,this._prevEndIndex=void 0,this._minStartIndex=this.originalLength,this._maxEndIndex=0,this.updateTotalSize(void 0!==this.vsSize?this.sizesCumulative[this.originalLength]:this.elementSize*this.originalLength),this.updateInnerCollection()},t.prototype.setAutoSize=function(){var t=this;if(void 0!==this.vsSize)this._ngZone.run(function(){t.refresh()});else if(this.__autoSize){var e=!1;if(this.parent.offsetHeight||this.parent.offsetWidth){var i=this.parent.children[1];i[this.offsetSize]&&(e=!0,this.elementSize=i[this.offsetSize])}e&&(this.__autoSize=!1,this._ngZone.run(function(){t.reinitialize()}))}},t.prototype._getOffset=function(t){return void 0!==this.vsSize?this.sizesCumulative[t+this.startIndex]+this.vsOffsetBefore:(t+this.startIndex)*this.elementSize+this.vsOffsetBefore},t.ngDirectiveDef=n.Kb({type:t,selectors:[["","vsFor",""]],factory:function(e){return new(e||t)(n.Pb(n.p),n.Pb(n.bb),n.Pb(n.W),n.Pb(n.I))},inputs:{vsSize:["vsForSize","vsSize"],vsOffsetBefore:["vsForOffsetBefore","vsOffsetBefore"],vsOffsetAfter:["vsForOffsetAfter","vsOffsetAfter"],vsExcess:["vsForExcess","vsExcess"],tagName:["vsForTagName","tagName"],__horizontal:["vsForHorizontal","__horizontal"],vsScrollParent:["vsForScrollParent","vsScrollParent"],vsAutoresize:["vsForAutoresize","vsAutoresize"],originalCollection:["vsFor","originalCollection"]},features:[n.Cb()]}),t}()},XNvx:function(t,e,i){"use strict";i.d(e,"a",function(){return c});var n=i("XlPw"),r=i("cUzu"),s=i("TYT/"),a=i("gfpf"),o=i("9Z1F"),c=function(){function t(t){this.http=t,this.hasToken=!1,localStorage.getItem("jwt")&&(this.hasToken=!0)}return t.prototype.doLogin=function(t,e){void 0===e&&(e=!1);var i=t;e||(localStorage.setItem("dsm",t.dsmport),i=this.encode(t));var n={headers:new r.c({"X-Cred":i})};return this.http.post(localStorage.getItem("dsm")+"/login",null,n).pipe(Object(o.a)(this.handleError))},t.prototype.autoLogin=function(){var t=localStorage.getItem("jwt");return t?this.doLogin(t,!0):(localStorage.removeItem("jwt"),Object(n.a)(null))},t.prototype.encode=function(t){return a.KJUR.jws.JWS.sign("HS256",{alg:"HS256",typ:"JWT"},t,"jsmusicdbnext")},t.prototype.handleError=function(t){return Object(n.a)(null)},t.ngInjectableDef=s.Lb({token:t,factory:function(e){return new(e||t)(s.Wb(r.a))},providedIn:null}),t}()},XWo6:function(t,e,i){"use strict";i.d(e,"a",function(){return o});var n=i("XlPw"),r=i("cUzu"),s=i("9Z1F"),a=i("epau"),o=function(){function t(t){this.http=t}return t.prototype.getMediaArt=function(t,e,i){var n=new r.d({encoder:new a.a}).set("api_key","956c1818ded606576d6941de5ff793a5").set("artist",t).set("format","json").set("autoCorrect","true");return n="album"===i?(n=n.set("method","album.getinfo")).set("album",e):n.set("method","artist.getinfo"),this.http.get("https://ws.audioscrobbler.com/2.0/",{params:n}).pipe(Object(s.a)(this.handleError))},t.prototype.handleError=function(t){return Object(n.a)(this.NOIMAGE)},t}()},XtVx:function(t,e,i){"use strict";i.d(e,"a",function(){return s});var n=i("TYT/"),r=i("K9Ia"),s=function(){function t(){this.pathAnnouncementSource=new r.a,this.pageAnnouncementSource=new r.a,this.pathAnnounced$=this.pathAnnouncementSource.asObservable(),this.pageAnnounced$=this.pageAnnouncementSource.asObservable()}return t.prototype.announcePath=function(t){this.pathAnnouncementSource.next(t)},t.prototype.announcePage=function(t,e){void 0===e&&(e=null),this.pageAnnouncementSource.next({page:t,letter:e})},t.ngInjectableDef=n.Lb({token:t,factory:function(e){return new(e||t)},providedIn:null}),t}()},Zp9u:function(t,e,i){"use strict";i.d(e,"a",function(){return a});var n=i("TYT/"),r=i("XWo6"),s=i("cUzu"),a=function(){function t(t){this.http=t,this.lastfmImageRetriever=new r.a(t)}return t.prototype.getAlbumArt=function(t,e,i){return this.lastfmImageRetriever.getMediaArt(t,e,i)},t.prototype.getMediaArtFromLastFm=function(t,e,i){return this.lastfmImageRetriever.getMediaArt(t,e,i)},t.prototype.returnImageUrlFromLastFMResponse=function(t){return t.album?t.album.image[t.album.image.length-1]["#text"]:t.artist?t.artist.image[t.artist.image.length-1]["#text"]:t},t.ngInjectableDef=n.Lb({token:t,factory:function(e){return new(e||t)(n.Wb(s.a))},providedIn:null}),t}()},cpgm:function(t,e,i){"use strict";i.d(e,"a",function(){return r});var n=i("TYT/"),r=function(){function t(){}return t.prototype.transform=function(t,e){var i="",n=Math.floor(t/1e3),r=Math.floor(n/60);n%=60;var s=Math.floor(r/60);r%=60;var a=Math.floor(s/24);return a>0&&(i+=a+" days,"),(s%=24)>0&&(i+=this.prefixZero(s)+":"),i+(this.prefixZero(r)+":")+this.prefixZero(n)},t.prototype.prefixZero=function(t){return t<10?"0"+t.toString():t.toString()},t.ngPipeDef=n.Ob({name:"timeFormat",type:t,factory:function(e){return new(e||t)},pure:!0}),t}()},crnd:function(t,e){function i(t){return Promise.resolve().then(function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e})}i.keys=function(){return[]},i.resolve=i,t.exports=i,i.id="crnd"},epau:function(t,e,i){"use strict";i.d(e,"a",function(){return n});var n=function(){function t(){}return t.prototype.encodeKey=function(t){return encodeURIComponent(t)},t.prototype.encodeValue=function(t){return encodeURIComponent(t)},t.prototype.decodeKey=function(t){return decodeURIComponent(t)},t.prototype.decodeValue=function(t){return decodeURIComponent(t)},t}()},hDf6:function(t,e,i){"use strict";i.d(e,"a",function(){return s});var n=i("Valr"),r=i("TYT/"),s=(i("UrAU"),i("EAnT"),i("Oz9T"),i("cpgm"),i("9dPn"),i("0/mZ"),i("Vmu9"),function(){function t(){}return t.ngModuleDef=r.Nb({type:t}),t.ngInjectorDef=r.Mb({factory:function(e){return new(e||t)},imports:[[n.c]]}),t.ngLocaleIdDef="en-GB",t}())},ktVm:function(t,e,i){"use strict";var n=i("K9Ia"),r=i("/1T7"),s=i("LNEh"),a=function(){function t(t){this.artists=[],this.active=!1,t.album&&t.title&&(this.letter=t.letter||this.getFirstLetterOf(t.albumArtist||t.albumartist||t.artist),"1"===this.letter&&(this.letter="#"),this.escapedLetter=encodeURIComponent(this.letter))}return t.prototype.url=function(){return"/letter/"+this.escapedLetter+"/"},t.prototype.sortArtistsBy=function(t,e){void 0===t&&(t="sortName"),void 0===e&&(e="asc"),this.artists.sort("albums"===t?function(t,i){return t.albums.length>i.albums.length?"asc"===e?-1:1:t.albums.length<i.albums.length?"asc"===e?1:-1:0}:function(i,n){if(-1!==t.indexOf(".")){var r=t.split(".");return i[r[0]][r[1]]<n[r[0]][r[1]]?"asc"===e?-1:1:i[r[0]][r[1]]>n[r[0]][r[1]]?"asc"===e?1:-1:0}return i[t].toUpperCase()<n[t].toUpperCase()?"asc"===e?-1:1:i[t].toUpperCase()>n[t].toUpperCase()?"asc"===e?1:-1:0})},t.prototype.sortAndReturnArtistsBy=function(t,e){return void 0===t&&(t="name"),void 0===e&&(e="asc"),this.sortArtistsBy(t,e),this.artists},t.prototype.getFirstLetterOf=function(t){var e="";return e=this.stripFromName(t,["the ",'"',"a "]),this.groupIfSpecialChar(e.substr(0,1))},t.prototype.stripFromName=function(t,e){var i=t?t.toUpperCase():"";return i=i.trim(),e.forEach(function(t){var e=t.toUpperCase();0===i.indexOf(e)&&(i=i.substring(e.length))}),i},t.prototype.groupIfSpecialChar=function(t){return-1!==["1","2","3","4","5","6","7","8","9","0","(",")","[","]","{","}","_","-","."].indexOf(t)?"#":t},t}(),o=i("uwnU"),c=function(){return function(t){this.albums=[],this.sanitize=function(t){var e=parseInt(t,10);return isNaN(e)&&(e=0),e},t.year&&(this.year=this.sanitize(t.year))}}(),l="1.4.0",u=function(){function t(){this.artists={},this.albums={},this.tracks={},this.letters={},this.years={},this.sortedLetters=[],this.sortedAlbums=[],this.isCoreParsed=!1,this.coreParsedSource=new n.a,this.coreParsed$=this.coreParsedSource.asObservable(),this.totals={artists:0,albums:0,tracks:0,playingTime:0,parsingTime:0},this.latestAdditions=[],console.info("Core init "+l)}return t.prototype.resetCollection=function(){this.artists={},this.albums={},this.tracks={},this.letters={},this.years={},this.sortedLetters=[],this.sortedAlbums=[],this.totals={artists:0,albums:0,tracks:0,playingTime:0,parsingTime:0},this.latestAdditions=[]},t.prototype.parseSourceJson=function(t,e){var i,n,r=this;void 0===e&&(e=!0);var s=(new Date).getTime();if(t.length)try{for(var a=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],i=0;return e?e.call(t):{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}}}(t),o=a.next();!o.done;o=a.next())this.parseLine(o.value,e)}catch(u){i={error:u}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}else t.tree&&this.parseTree(t.tree);var c=Object.keys(this.letters).sort(function(t,e){return t<e?-1:1}),l=[];c.forEach(function(t,e){l.push(r.letters[t]),r.letters[t].sortAndReturnArtistsBy("name","asc")}),this.sortedLetters=l,this.totals.parsingTime+=(new Date).getTime()-s,this.coreParsedSource.next(!0),this.isCoreParsed=!0},t.prototype.getTrackByArtistAndName=function(t,e){var i=new s.a({name:t,dummy:!0}),n=this.artists[i.sortName],r=null;return n&&n.albums.some(function(t){t.tracks.some(function(t){if(t.title&&t.title.toLowerCase()===e.toLowerCase())return r||(r=t),!0})}),r},t.prototype.getTrackById=function(t){var e=new o.a({});return this.tracks.forEach(function(i){i.id===t&&(e=i)}),e},t.prototype.getArtistByName=function(t){var e=new s.a({name:t,dummy:!0});return this.artists[e.sortName]},t.prototype.getAlbumByArtistAndName=function(t,e){var i=null;return t.albums.forEach(function(t){t.name.toLowerCase()===e.toLowerCase()&&(i=t)}),i},t.prototype.getTrackByAlbumAndName=function(t,e){var i=null;return t.tracks.forEach(function(t){t.title.toLowerCase()===e.toLowerCase()&&(i=t)}),i},t.prototype.artistsList=function(){var t=this,e=[];return Object.keys(this.artists).sort(function(t,e){return t<e?-1:1}).forEach(function(i,n){e.push(t.artists[i])}),e},t.prototype.searchArtist=function(t){var e=this,i=[],n=Object.keys(this.artists);return(n=n.filter(function(e){if(-1!==e.indexOf(t.toUpperCase()))return!0})).forEach(function(t){i.push(e.artists[t])}),i},t.prototype.searchAlbum=function(t){var e=this,i=[],n=Object.keys(this.albums);return(n=n.filter(function(e){if(-1!==(e=e.substring(e.indexOf("|"))).indexOf(t.toUpperCase()))return!0})).forEach(function(t){i.push(e.albums[t])}),i},t.prototype.searchTrack=function(t){var e=this,i=[],n=Object.keys(this.tracks);return(n=n.filter(function(i){if(-1!==e.tracks[i].title.toLowerCase().indexOf(t.toLowerCase()))return!0})).forEach(function(t){i.push(e.tracks[t])}),i},t.prototype.getLatestAdditions=function(t){return void 0===t&&(t=14),0!==this.latestAdditions.length?this.latestAdditions:(this.sortedAlbums.sort(function(t,e){return t.modified>e.modified?-1:t.modified<e.modified?1:0}),this.latestAdditions=this.sortedAlbums.splice(0,t),this.latestAdditions)},t.prototype.getNextAlbum=function(t){var e=t.artist,i=e.albums.indexOf(t),n=e.albums[i+1];return n||(n=this.getNextArtist(e).albums[0]),n},t.prototype.getNextArtist=function(t){var e=t.letter,i=e.artists.indexOf(t),n=e.artists[i+1];return n||(n=this.getNextLetter(e).artists[0]),n},t.prototype.getNextLetter=function(t){var e=this.sortedLetters.indexOf(t),i=this.sortedLetters[e+1];return i||(i=this.sortedLetters[0]),i},t.prototype.instanceIfPresent=function(t,e,i,n,r){var s=null;return i[e]?s=i[e]:(i[e]=n,s=n,r(t)),s},t.prototype.handleLetter=function(t){return this.instanceIfPresent(this,t.letter,this.letters,t,function(t){})},t.prototype.handleArtist=function(t,e){return this.instanceIfPresent(this,e.sortName,this.artists,e,function(i){t.artists.push(e),e.letter=t,i.totals.artists++})},t.prototype.handleAlbum=function(t,e,i){return void 0===i&&(i=!0),this.instanceIfPresent(this,t.sortName+"|"+e.sortName,this.albums,e,function(n){if("flac"===e.type&&i||"flac"!==e.type)if(e.artist=t,t.albums.push(e),t.sortAndReturnAlbumsBy("year","asc"),n.sortedAlbums.push(e),n.totals.albums++,n.years[e.year])n.years[e.year].albums.push(e);else{var r=new c(e);r.albums.push(e),n.years[r.year]=r}})},t.prototype.handleTrack=function(t,e,i,n){return void 0===n&&(n=!0),this.instanceIfPresent(this,i.id,this.tracks,i,function(r){if(e.type=e.type&&e.type!==i.type?"mixed":i.type,"flac"===i.type&&n||"flac"!==i.type){r.totals.tracks++,r.totals.playingTime+=i.duration,i.artist=t,i.album=e,e.tracks.push(i);var s=i.disc;e.discs["disc-"+s]?e.discs["disc-"+s].push(i):(e.discs["disc-"+s]=[],e.discs["disc-"+s].push(i)),e.discs["disc-"+s].sort(function(t,e){return t.number<e.number?-1:1}),e.tracks.sort(function(t,e){return t.disc<e.disc?-1:t.disc===e.disc&&t.number<e.number?-1:1})}else console.warn("skipping flac track, flac is not supported")})},t.prototype.parseLine=function(t,e){void 0===e&&(e=!0);var i=new a(t);i.letter&&(i=this.handleLetter(i));var n=new s.a(t);n.name&&(n=this.handleArtist(i,n));var c=new r.a(t);c.name&&(c=this.handleAlbum(n,c,e));var l=new o.a(t);l.title&&(l=this.handleTrack(n,c,l,e))},t.prototype.parseTree=function(t){for(var e in t){var i=new a(t[e]);for(var n in i=this.handleLetter(i),t[e].artists){var c=new s.a(t[e].artists[n]);for(var l in c=this.handleArtist(i,c),t[e].artists[n].albums){var u=new r.a(t[e].artists[n].albums[l]);for(var h in u=this.handleAlbum(c,u),t[e].artists[n].albums[l].tracks){var d=new o.a(t[e].artists[n].albums[l].tracks[h]);d=this.handleTrack(c,u,d)}}}}},t}();i.d(e,"a",function(){return h});var h=function(){function t(){this.core=new u}return t.prototype.getCore=function(){return this.core},t}()},riCG:function(t,e,i){"use strict";i.d(e,"d",function(){return c}),i.d(e,"c",function(){return l}),i.d(e,"a",function(){return u}),i.d(e,"b",function(){return h}),i.d(e,"e",function(){return d});var n=i("meIv"),r=i("Pbcf"),s=function(t){return t.r=Math.floor(t.r),t.g=Math.floor(t.g),t.b=Math.floor(t.b),t},a=function(t,e){return n.a.isReadable(t,e)?s(new n.a(t).toRgb()):a("#000"===e?new n.a(t).lighten(3):new n.a(t).darken(3),e)},o=function(t){return n.a.readability("#000",t)>n.a.readability("#fff",t)?"#000":"#fff"};function c(t,e,i){if(window.runningInElectron&&!i)document.querySelector("mdb-player").dispatchEvent(new CustomEvent("external.mdbuntaint",{detail:{url:t.src}}));else{var a=new Image;a.crossOrigin="Anonymous",a.src=t.src,(new r.a).getColorAsync(a,function(t){e(s(new n.a(t.rgba).toRgb()))})}}function l(t){var e=s(new n.a(t).lighten().toRgb());return{rgba:t,textLight:a(t,"#fff"),textDark:a(t,"#000"),lighten:e,darken:s(new n.a(t).darken().toRgb()),letterColor:o(new n.a(t))}}function u(t){var e=document.createElement("style"),i=t.rgba,n=t.darken,r=t.lighten,s=t.textLight,a=t.textDark,o=t.letterColor;e.setAttribute("type","text/css"),e.id="custom-css-node",e.textContent='\n      @charset "UTF-8";\n      :root {\n        --primary: rgba('+i.r+", "+i.g+", "+i.b+", 1);\n        --darken: rgba("+n.r+", "+n.g+", "+n.b+", 1);\n        --lighten: rgba("+r.r+", "+r.g+", "+r.b+", 1);\n        --text-light: rgba("+s.r+", "+s.g+", "+s.b+", 1);\n        --text-dark: rgba("+a.r+", "+a.g+", "+a.b+", 1);\n        --letter-color: "+o+";\n      }",d(),document.querySelector("body").appendChild(e)}function h(t){t&&u(l(t))}function d(){document.querySelector("#custom-css-node")&&document.querySelector("#custom-css-node").remove()}},t083:function(t,e,i){"use strict";i.d(e,"a",function(){return d});var n=i("K9Ia"),r=i("XlPw"),s=i("TYT/"),a=i("9Z1F"),o=i("cUzu"),c=i("ztCj"),l=i("epau"),u="956c1818ded606576d6941de5ff793a5",h="4d183e73f7578dee78557665e9be3acc",d=function(){function t(t){this.http=t,this.manualScrobbleListSource=new n.a,this.manualScrobbleList$=this.manualScrobbleListSource.asObservable(),this.hexcase=0,this.b64pad=""}return t.prototype.getLovedTracks=function(t){return this.http.get("https://ws.audioscrobbler.com/2.0/",{params:{api_key:u,format:"json",limit:"1000",method:"user.getlovedtracks",user:t}}).pipe(Object(a.a)(this.handleError))},t.prototype.toggleLoved=function(t){var e=localStorage.getItem("lastfm-token"),i=(new URLSearchParams,t.isLoved?"track.love":"track.unlove"),n=new o.d({encoder:new l.a}).set("method",i).set("api_key",u).set("api_sig",this.signTrack(t.trackArtist,t.album.name,t.title,null,e,i)).set("artist",t.trackArtist).set("album",t.album.name).set("track",t.title).set("sk",e),r=new o.c({"Content-Type":"application/x-www-form-urlencoded"});return this.http.post("https://ws.audioscrobbler.com/2.0/",null,{params:n,headers:r}).pipe(Object(a.a)(this.handleError))},t.prototype.getTrackInfo=function(t,e){if(t){var i=new o.d({encoder:new l.a}).set("method","track.getInfo").set("artist",t.trackArtist).set("album",t.album.name).set("track",t.title).set("api_key",u).set("format","json").set("user",e);return this.http.get("https://ws.audioscrobbler.com/2.0/",{params:i}).pipe(Object(a.a)(this.handleError))}return Object(r.a)(null)},t.prototype.getTopArtists=function(t){var e=new o.d({encoder:new l.a}).set("api_key",u).set("format","json").set("limit","50").set("method","user.gettopartists").set("period","1month").set("user",t);return this.http.get("https://ws.audioscrobbler.com/2.0/",{params:e}).pipe(Object(a.a)(this.handleError))},t.prototype.getSimilairArtists=function(t){var e=new o.d({encoder:new l.a}).set("api_key",u).set("format","json").set("limit","20").set("autocorrect","1").set("method","artist.getSimilar").set("artist",t.name);return this.http.get("https://ws.audioscrobbler.com/2.0/",{params:e}).pipe(Object(a.a)(this.handleError))},t.prototype.authenticate=function(t){var e=new o.d({encoder:new l.a}).set("api_key",u).set("api_sig",this.signAuthentication(t.user,t.password)).set("format","json").set("username",t.user).set("password",t.password),i=new o.c({"Content-Type":"application/x-www-form-urlencoded"});return this.http.post("https://ws.audioscrobbler.com/2.0/?method=auth.getMobileSession",null,{params:e,headers:i}).pipe(Object(a.a)(this.handleError))},t.prototype.announceNowPlaying=function(t){if("mdb-skipped"!==localStorage.getItem("lastfm-username")){var e=new Date,i=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes()+e.getTimezoneOffset(),e.getSeconds())/1e3,n=localStorage.getItem("lastfm-token"),r=new o.c({"Content-Type":"application/x-www-form-urlencoded"}),s=new o.d({encoder:new l.a}).set("method","track.updateNowPlaying").set("api_key",u).set("api_sig",this.signTrack(t.trackArtist,t.album.name,t.title,i,n,"track.updateNowPlaying")).set("artist",t.trackArtist).set("album",t.album.name).set("track",t.title).set("timestamp",i.toString()).set("sk",n);return this.http.post("https://ws.audioscrobbler.com/2.0/",null,{params:s,headers:r}).pipe(Object(a.a)(this.handleError))}},t.prototype.scrobbleTrack=function(t){var e=this,i=localStorage.getItem("lastfm-username"),n=new Date,r=Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes()+n.getTimezoneOffset(),n.getSeconds())/1e3;if("mdb-skipped"!==i){var s=localStorage.getItem("lastfm-token");if(!this.booleanState("manual-scrobble-state")){var h=new o.c({"Content-Type":"application/x-www-form-urlencoded"}),d=new o.d({encoder:new l.a}).set("method","track.scrobble").set("api_key",u).set("api_sig",this.signTrack(t.trackArtist,t.album.name,t.title,r,s,"track.scrobble")).set("artist",t.trackArtist).set("album",t.album.name).set("track",t.title).set("timestamp",r.toString()).set("sk",s);return this.http.post("https://ws.audioscrobbler.com/2.0/",null,{params:d,headers:h}).pipe(Object(a.a)(this.handleError))}Object(c.b)("manual-scrobble-list").then(function(i){var n=i||[],s={artist:t.trackArtist,album:t.album.name,track:t.title,timestamp:r.toString()};n.unshift(s),Object(c.c)("manual-scrobble-list",n),e.manualScrobbleListSource.next(n)})}else{var p="art-"+t.trackArtist+"-"+t.album.name;Object(c.b)(p).then(function(i){e.saveInLocal(t,r,i||"global/images/no-cover.png")})}},t.prototype.updateManualScrobbleList=function(){var t=this;Object(c.b)("manual-scrobble-list").then(function(e){t.manualScrobbleListSource.next(e||[])})},t.prototype.saveInLocal=function(t,e,i){var n={artist:{"#text":t.trackArtist},album:{"#text":t.album.name},image:[{"#text":i}],name:t.title,date:{uts:e}},r=[];Object(c.b)("recentlyListened").then(function(t){t&&(r=t.tracks).length>10&&(r=r.splice(0,10)),r.unshift(n);var e={_id:"recentlyListened",tracks:r};Object(c.c)(e._id,e.tracks)})},t.prototype.scrobbleCachedTrack=function(t){var e=localStorage.getItem("lastfm-token"),i=new o.c({"Content-Type":"application/x-www-form-urlencoded"}),n=new o.d({encoder:new l.a}).set("method","track.scrobble").set("api_key",u).set("api_sig",this.signTrack(t.artist,t.album,t.track,t.timestamp,e,"track.scrobble")).set("artist",t.artist).set("album",t.album).set("track",t.track).set("timestamp",t.timestamp.toString()).set("sk",e);return this.http.post("https://ws.audioscrobbler.com/2.0/",null,{params:n,headers:i,responseType:"text"}).pipe(Object(a.a)(this.handleError))},t.prototype.booleanState=function(t){var e=localStorage.getItem(t);return!(!e||"true"!==e)},t.prototype.signAuthentication=function(t,e){return this.hex_md5("api_key"+u+"methodauth.getMobileSessionpassword"+e+"username"+t+h)},t.prototype.signTrack=function(t,e,i,n,r,s){return this.hex_md5(n?"album"+e+"api_key"+u+"artist"+t+"method"+s+"sk"+r+"timestamp"+n+"track"+i+h:"album"+e+"api_key"+u+"artist"+t+"method"+s+"sk"+r+"track"+i+h)},t.prototype.handleError=function(t){return Object(r.a)(null)},t.prototype.hex_md5=function(t){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(t)))},t.prototype.rstr2hex=function(t){try{this.hexcase=this.hexcase}catch(s){this.hexcase=0}for(var e,i=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",n="",r=0;r<t.length;r++)e=t.charCodeAt(r),n+=i.charAt(e>>>4&15)+i.charAt(15&e);return n},t.prototype.rstr_md5=function(t){return this.binl2rstr(this.binl_md5(this.rstr2binl(t),8*t.length))},t.prototype.str2rstr_utf8=function(t){for(var e,i,n="",r=-1;++r<t.length;)e=t.charCodeAt(r),i=r+1<t.length?t.charCodeAt(r+1):0,55296<=e&&e<=56319&&56320<=i&&i<=57343&&(e=65536+((1023&e)<<10)+(1023&i),r++),e<=127?n+=String.fromCharCode(e):e<=2047?n+=String.fromCharCode(192|e>>>6&31,128|63&e):e<=65535?n+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):e<=2097151&&(n+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return n},t.prototype.binl2rstr=function(t){for(var e="",i=0;i<32*t.length;i+=8)e+=String.fromCharCode(t[i>>5]>>>i%32&255);return e},t.prototype.binl_md5=function(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var i=1732584193,n=-271733879,r=-1732584194,s=271733878,a=0;a<t.length;a+=16){var o=i,c=n,l=r,u=s;i=this.md5_ff(i,n,r,s,t[a+0],7,-680876936),s=this.md5_ff(s,i,n,r,t[a+1],12,-389564586),r=this.md5_ff(r,s,i,n,t[a+2],17,606105819),n=this.md5_ff(n,r,s,i,t[a+3],22,-1044525330),i=this.md5_ff(i,n,r,s,t[a+4],7,-176418897),s=this.md5_ff(s,i,n,r,t[a+5],12,1200080426),r=this.md5_ff(r,s,i,n,t[a+6],17,-1473231341),n=this.md5_ff(n,r,s,i,t[a+7],22,-45705983),i=this.md5_ff(i,n,r,s,t[a+8],7,1770035416),s=this.md5_ff(s,i,n,r,t[a+9],12,-1958414417),r=this.md5_ff(r,s,i,n,t[a+10],17,-42063),n=this.md5_ff(n,r,s,i,t[a+11],22,-1990404162),i=this.md5_ff(i,n,r,s,t[a+12],7,1804603682),s=this.md5_ff(s,i,n,r,t[a+13],12,-40341101),r=this.md5_ff(r,s,i,n,t[a+14],17,-1502002290),n=this.md5_ff(n,r,s,i,t[a+15],22,1236535329),i=this.md5_gg(i,n,r,s,t[a+1],5,-165796510),s=this.md5_gg(s,i,n,r,t[a+6],9,-1069501632),r=this.md5_gg(r,s,i,n,t[a+11],14,643717713),n=this.md5_gg(n,r,s,i,t[a+0],20,-373897302),i=this.md5_gg(i,n,r,s,t[a+5],5,-701558691),s=this.md5_gg(s,i,n,r,t[a+10],9,38016083),r=this.md5_gg(r,s,i,n,t[a+15],14,-660478335),n=this.md5_gg(n,r,s,i,t[a+4],20,-405537848),i=this.md5_gg(i,n,r,s,t[a+9],5,568446438),s=this.md5_gg(s,i,n,r,t[a+14],9,-1019803690),r=this.md5_gg(r,s,i,n,t[a+3],14,-187363961),n=this.md5_gg(n,r,s,i,t[a+8],20,1163531501),i=this.md5_gg(i,n,r,s,t[a+13],5,-1444681467),s=this.md5_gg(s,i,n,r,t[a+2],9,-51403784),r=this.md5_gg(r,s,i,n,t[a+7],14,1735328473),n=this.md5_gg(n,r,s,i,t[a+12],20,-1926607734),i=this.md5_hh(i,n,r,s,t[a+5],4,-378558),s=this.md5_hh(s,i,n,r,t[a+8],11,-2022574463),r=this.md5_hh(r,s,i,n,t[a+11],16,1839030562),n=this.md5_hh(n,r,s,i,t[a+14],23,-35309556),i=this.md5_hh(i,n,r,s,t[a+1],4,-1530992060),s=this.md5_hh(s,i,n,r,t[a+4],11,1272893353),r=this.md5_hh(r,s,i,n,t[a+7],16,-155497632),n=this.md5_hh(n,r,s,i,t[a+10],23,-1094730640),i=this.md5_hh(i,n,r,s,t[a+13],4,681279174),s=this.md5_hh(s,i,n,r,t[a+0],11,-358537222),r=this.md5_hh(r,s,i,n,t[a+3],16,-722521979),n=this.md5_hh(n,r,s,i,t[a+6],23,76029189),i=this.md5_hh(i,n,r,s,t[a+9],4,-640364487),s=this.md5_hh(s,i,n,r,t[a+12],11,-421815835),r=this.md5_hh(r,s,i,n,t[a+15],16,530742520),n=this.md5_hh(n,r,s,i,t[a+2],23,-995338651),i=this.md5_ii(i,n,r,s,t[a+0],6,-198630844),s=this.md5_ii(s,i,n,r,t[a+7],10,1126891415),r=this.md5_ii(r,s,i,n,t[a+14],15,-1416354905),n=this.md5_ii(n,r,s,i,t[a+5],21,-57434055),i=this.md5_ii(i,n,r,s,t[a+12],6,1700485571),s=this.md5_ii(s,i,n,r,t[a+3],10,-1894986606),r=this.md5_ii(r,s,i,n,t[a+10],15,-1051523),n=this.md5_ii(n,r,s,i,t[a+1],21,-2054922799),i=this.md5_ii(i,n,r,s,t[a+8],6,1873313359),s=this.md5_ii(s,i,n,r,t[a+15],10,-30611744),r=this.md5_ii(r,s,i,n,t[a+6],15,-1560198380),n=this.md5_ii(n,r,s,i,t[a+13],21,1309151649),i=this.md5_ii(i,n,r,s,t[a+4],6,-145523070),s=this.md5_ii(s,i,n,r,t[a+11],10,-1120210379),r=this.md5_ii(r,s,i,n,t[a+2],15,718787259),n=this.md5_ii(n,r,s,i,t[a+9],21,-343485551),i=this.safe_add(i,o),n=this.safe_add(n,c),r=this.safe_add(r,l),s=this.safe_add(s,u)}return Array(i,n,r,s)},t.prototype.rstr2binl=function(t){for(var e=Array(t.length>>2),i=0;i<e.length;i++)e[i]=0;for(i=0;i<8*t.length;i+=8)e[i>>5]|=(255&t.charCodeAt(i/8))<<i%32;return e},t.prototype.md5_cmn=function(t,e,i,n,r,s){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(e,t),this.safe_add(n,s)),r),i)},t.prototype.md5_ff=function(t,e,i,n,r,s,a){return this.md5_cmn(e&i|~e&n,t,e,r,s,a)},t.prototype.md5_gg=function(t,e,i,n,r,s,a){return this.md5_cmn(e&n|i&~n,t,e,r,s,a)},t.prototype.md5_hh=function(t,e,i,n,r,s,a){return this.md5_cmn(e^i^n,t,e,r,s,a)},t.prototype.md5_ii=function(t,e,i,n,r,s,a){return this.md5_cmn(i^(e|~n),t,e,r,s,a)},t.prototype.safe_add=function(t,e){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i},t.prototype.bit_rol=function(t,e){return t<<e|t>>>32-e},t.ngInjectableDef=s.Lb({token:t,factory:function(e){return new(e||t)(s.Wb(o.a))},providedIn:null}),t}()},ufXC:function(t,e,i){"use strict";i.d(e,"a",function(){return h});var n=i("TYT/"),r=i("ztCj"),s=i("K9Ia"),a=i("KI15"),o=i("Gcu2"),c=i("ktVm"),l=i("t083"),u=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,r,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=s.next()).done;)a.push(n.value)}catch(o){r={error:o}}finally{try{n&&!n.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return a},h=function(){function t(t,e,i){var n=this;this.lastFMService=t,this.coreService=e,this.playlistService=i,this.playlistSource=new s.a,this.volumeSource=new s.a,this.hideVolumeWindowAsSource=new s.a,this.playlistAnnounced$=this.playlistSource.asObservable(),this.volumeAnnounced=this.volumeSource.asObservable(),this.hideVolumeWindowAnnounced$=this.hideVolumeWindowAsSource.asObservable(),this.isPlaying=!1,this.isPaused=!1,this.isShuffled=!1,this.forceRestart=!1,this.volume=100,this.lastfmUserName=localStorage.getItem("lastfm-username"),this.subscription=this.playlistService.playlistAnnounced$.subscribe(function(t){n.doPlayPlaylist(t,0,!0,n.isShuffled)})}return t.prototype.setPosition=function(t){this.position=t,this.announce(),this.position=null},t.prototype.doPlayAlbum=function(t,e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1),this.currentTrack&&(this.currentTrack.isPaused=!1,this.currentTrack.isPlaying=!1),this.setPlaylist(t,e,i,n,"album"),this.announce()},t.prototype.doQueueAlbum=function(t){var e=this.currentPlaylist,i=e.playlist,n=e.startIndex,r=new a.a;r.name="queued playlist",r.type="queue",r.tracks=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(u(arguments[e]));return t}(i.tracks,t.tracks),this.setPlaylist(r,n,!1,!1,"playlist")},t.prototype.doPlayPlaylist=function(t,e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1),this.currentTrack&&(this.currentTrack.isPaused=!1,this.currentTrack.isPlaying=!1),this.setPlaylist(t,e,i,n,"playlist"),this.announce()},t.prototype.doPlayTrack=function(t){this.currentTrack&&(this.currentTrack.isPaused=!1,this.currentTrack.isPlaying=!1);var e=new a.a;e.isOwn=!0,e.name=t.title,e.tracks.push(t),this.currentPlaylist={playlist:e,startIndex:0,isPlaying:this.isPlaying=!0,isPaused:this.isPaused=!1,isShuffled:!1,forceRestart:this.forceRestart=!0,isContinues:!1},this.announce()},t.prototype.nextPlaylist=function(t){if(this.booleanState("continues-play"))if("random"===t){var e=this.playlistService.generateRandom();this.doPlayPlaylist(e,0,!0,this.isShuffled)}else this.playlistService.generateRadio();else this.stop()},t.prototype.nextAlbum=function(t){if(this.booleanState("continues-play")){var e=this.coreService.getCore().getNextAlbum(t);e?this.doPlayAlbum(e,0,!0,this.isShuffled):(console.warn("no new album found, stopping playback"),this.stop())}else this.stop()},t.prototype.playlistToString=function(){var t=[];return this.currentPlaylist.playlist.tracks.forEach(function(e){e&&t.push(e.id)}),JSON.stringify({ids:t,isShuffled:this.isShuffled,isContinues:this.currentPlaylist.isContinues,current:this.currentPlaylist.startIndex,type:this.currentPlaylist.type})},t.prototype.playlistSync=function(){var t=[];return this.currentPlaylist.playlist.tracks.forEach(function(e){e&&t.push(e.id)}),{ids:t,isShuffled:this.isShuffled,isContinues:this.currentPlaylist.isContinues,current:this.currentPlaylist.startIndex,type:this.currentPlaylist.type}},t.prototype.getCurrentPlaylist=function(){return this.currentPlaylist},t.prototype.shufflePlaylist=function(t){this.isShuffled=t,this.currentPlaylist.playlist.tracks.sort(this.sortPlaylist),t&&(this.currentPlaylist.playlist.tracks=this.shuffle(this.currentPlaylist.playlist.tracks)),this.currentPlaylist.startIndex=this.currentPlaylist.playlist.tracks.indexOf(this.currentTrack),this.currentPlaylist.forceRestart=!1,this.announce()},t.prototype.sortPlaylist=function(t,e){return t.disc<e.disc?-1:t.disc>e.disc?1:t.number<e.number?-1:t.number>e.number?1:0},t.prototype.shuffle=function(t){for(var e=t.length-1;e>0;e--){var i=Math.floor(Math.random()*(e+1)),n=t[e];t[e]=t[i],t[i]=n}return t},t.prototype.next=function(){this.currentTrack&&(this.currentTrack.isPaused=!1,this.currentTrack.isPlaying=!1),this.currentPlaylist&&(this.currentPlaylist.startIndex++,this.currentPlaylist.forceRestart=!1,this.announce())},t.prototype.prev=function(){this.currentTrack&&(this.currentTrack.isPaused=!1,this.currentTrack.isPlaying=!1),this.currentPlaylist&&(this.currentPlaylist.startIndex--,this.currentPlaylist.startIndex<=0&&(this.currentPlaylist.startIndex=0),this.currentPlaylist.forceRestart=!1,this.announce())},t.prototype.pause=function(){this.currentPlaylist&&(this.isPlaying=!1,this.isPaused=!0,this.currentPlaylist.forceRestart=!1,this.announce())},t.prototype.resume=function(){this.currentPlaylist&&(this.isPlaying=!0,this.isPaused=!1,this.currentPlaylist.forceRestart=!1,this.announce())},t.prototype.stop=function(){this.isPlaying=!1,this.isPaused=!1,this.currentPlaylist=null,Object(r.a)("current-playlist"),localStorage.removeItem("current-time"),this.playlistSource.next(this.currentPlaylist)},t.prototype.togglePlayPause=function(){this.isPlaying?this.pause():this.resume()},t.prototype.announce=function(){var t=this;this.currentPlaylist&&(this.currentTrack=this.currentPlaylist.playlist.tracks[this.currentPlaylist.startIndex],this.lastfmUserName&&this.lastFMService.getTrackInfo(this.currentTrack,this.lastfmUserName).subscribe(function(e){t.currentTrack&&e.track&&(t.currentTrack.isLoved="1"===e.track.userloved)}),this.currentTrack&&(this.currentTrack.isPaused=this.isPaused,this.currentTrack.isPlaying=this.isPlaying,this.currentPlaylist.isPlaying=this.isPlaying,this.currentPlaylist.isPaused=this.isPaused,this.currentPlaylist.isShuffled=this.isShuffled,this.currentPlaylist.position=this.position,Object(r.c)("current-playlist",this.playlistSync()),this.playlistSource.next(this.currentPlaylist)))},t.prototype.getVolume=function(){return this.volume},t.prototype.setVolume=function(t){this.volume=t,this.volumeSource.next(this.volume)},t.prototype.hideVolumeControl=function(){this.hideVolumeWindowAsSource.next(!0)},t.prototype.booleanState=function(t){var e=localStorage.getItem(t);return!(!e||"true"!==e)},t.prototype.setPlaylist=function(t,e,i,n,r){void 0===e&&(e=0),void 0===i&&(i=!0),void 0===n&&(n=!1),void 0===r&&(r="album"),this.currentPlaylist={playlist:t,startIndex:e,isPlaying:this.isPlaying=!0,isPaused:this.isPaused=!1,isShuffled:this.isShuffled=n,forceRestart:this.forceRestart=i,isContinues:t.isContinues||"album"===r,type:t.type}},t.ngInjectableDef=n.Lb({token:t,factory:function(e){return new(e||t)(n.Wb(l.a),n.Wb(c.a),n.Wb(o.a))},providedIn:null}),t}()},uwnU:function(t,e,i){"use strict";var n=function(){return function(t){this.url=t.file||t.url||t.path||t.id}}();e.a=function(){function t(t){this.isPlaying=!1,this.isPaused=!1,this.isLoved=!1,this.position=0,this.buffered={start:0,end:0},this.showActions=!1,this.image="",t.album&&t.title&&(this.id=t.id,this.duration=t.seconds?1e3*t.seconds:t.duration&&!isNaN(t.duration)?t.duration:0,this.title=t.title,this.source=new n(t),this.disc=t.disc||this.guessBySource(t),this.number=t.number,this.trackArtist=t.artist,this.type=t.type||"mp3")}return t.prototype.url=function(){return"/letter/"+this.artist.letter.escapedLetter+"/artist/"+encodeURIComponent(this.artist.name)+"/album/"+encodeURIComponent(this.album.name)+"/track/"+encodeURIComponent(this.title)},t.prototype.toJSON=function(){return this.id},t.prototype.guessBySource=function(t){var e,i,n=this.source.url;try{for(var r=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],i=0;return e?e.call(t):{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}}}([1,2,3,4,5,6,7,8,9,10]),s=r.next();!s.done;s=r.next()){var a=s.value;if(-1!==n.indexOf(" - "+a+".")||-1!==n.indexOf("("+a+") - ")||-1!==n.indexOf("CD"+a)||-1!==n.indexOf("\\"+a+"-"))return a}}catch(o){e={error:o}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(e)throw e.error}}return 1},t}()},zUnb:function(t,e,i){"use strict";i.r(e);var n=i("URqu"),r=i.n(n),s=i("Valr"),a=i("TYT/"),o=i("cUzu"),c=i("QJY3"),l=i("E1rE"),u=i("oW1M"),h=i("XNvx"),d=i("ufXC"),p=i("Gcu2"),f=i("1gFc"),m=i("MDLy"),b=i("+ooL"),g=i("OgP6"),y=i("ktVm"),v=i("t083"),k=i("XtVx"),S=i("ztCj"),w=i("f07x"),T=function(){return function(){}}(),C=i("DUip"),A=[1,"menu-top","fixed-top"],x=[1,"menu-toggle",3,"click"],I=["aria-label","menu button",1,"btn","btn-menu","d-md-none"],P=["aria-hidden","true",1,"glyph","glyph-hamburger"],_=[1,"d-none","d-md-inline-block"],L=["version","1.1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","x","0px","y","0px","width","276.164px","height","276.164px","viewBox","0 0 276.164 276.164",0,"xml","space","preserve",1,"logo"],O=["d","M156.716,61.478c-4.111,6.276-8.881,11.511-14.212,15.609l-8.728,6.962c-13.339,11.855-22.937,21.433-28.542,28.464\n                  c-10.209,12.788-15.806,25.779-16.65,38.611c-0.942,14.473,3.187,28.21,12.275,40.84c9.636,13.458,21.8,20.754,36.164,21.69\n                  c3.291,0.218,6.897,0.182,9.896-0.015l-1.121-10.104c-2.09,0.192-4.306,0.223-6.628,0.068c-9.437-0.617-17.864-4.511-25.064-11.573\n                  c-7.524-7.333-10.895-15.415-10.287-24.7c1.149-17.59,12.562-35.004,33.925-51.792l9.543-7.599\n                  c8.394-7.174,15.192-16.191,20.216-26.825c4.971-10.556,7.886-21.983,8.673-33.96c0.466-7.037-0.513-15.775-2.874-25.965\n                  c-3.241-13.839-7.854-20.765-14.136-21.179c-2.232-0.138-4.676,0.986-7.658,3.617c-7.252,6.548-12.523,14.481-15.683,23.542\n                  c-2.438,6.926-4.057,16.189-4.805,27.529c-0.313,4.72,0.313,13.438,1.805,23.962l8.844-8.192c-0.028-1.183,0.005-2.413,0.096-3.703\n                  c0.466-7.221,2.289-15.062,5.394-23.293c3.956-10.296,7.689-13.409,10.133-14.204c0.668-0.218,1.32-0.298,2.015-0.254\n                  c3.185,0.212,6.358,1.559,5.815,9.979C164.664,46.132,161.831,53.693,156.716,61.478z"],R=["d","M164.55,209.161c5.728-2.568,10.621-6.478,14.576-11.651c5.055-6.561,7.897-14.316,8.467-23.047\n                  c0.72-10.719-1.854-20.438-7.617-28.895c-6.322-9.264-14.98-14.317-25.745-15.026c-1.232-0.081-2.543-0.075-3.895,0.025\n                  l-2.304-17.191l-9.668,7.112l1.483,12.194c-5.789,2.393-10.827,6.17-15.017,11.255c-4.823,5.924-7.508,12.443-7.964,19.382\n                  c-0.466,7.208,1.142,13.81,4.782,19.583c1.895,3.081,4.507,5.82,7.498,8.058c4.906,3.65,10.563,3.376,11.459,1.393\n                  c0.906-1.983-2.455-5.095-5.09-9.248c-1.502-2.351-2.242-5.173-2.242-8.497c0-7.053,4.256-13.116,10.317-15.799l5.673,44.211\n                  l1.325,10.258c0.864,4.873,1.719,9.725,2.537,14.52c1,6.488,1.352,12.112,1.041,16.715c-0.419,6.375-2.408,11.584-5.919,15.493\n                  c-2.234,2.485-4.844,4.055-7.795,4.925c3.961-3.962,6.414-9.43,6.414-15.478c0-12.075-9.792-21.872-21.87-21.872\n                  c-3.353,0-6.491,0.812-9.329,2.159c-0.36,0.155-0.699,0.388-1.054,0.574c-0.779,0.425-1.559,0.85-2.286,1.362\n                  c-0.249,0.187-0.487,0.403-0.732,0.605c-4.888,3.816-8.091,9.616-8.375,16.229c0,0.01-0.011,0.021-0.011,0.031\n                  c0,0.005,0,0.01,0,0.016c-0.013,0.311-0.09,0.59-0.09,0.896c0,0.259,0.067,0.492,0.078,0.74\n                  c-0.011,7.084,2.933,13.179,8.839,18.118c5.584,4.666,12.277,7.28,19.892,7.777c4.327,0.28,8.505-0.217,12.407-1.485\n                  c3.189-1.041,6.275-2.62,9.149-4.687c6.96-5.022,10.75-11.584,11.272-19.532c0.399-6.063,0.094-13.235-0.937-21.411l-2.838-18.429\n                  l-7.156-52.899c7.984,1.532,14.027,8.543,14.027,16.968c0,5.986-1.937,15.431-5.551,20.376L164.55,209.161z"],E=[4,"ngIf"],M=["aria-label","search button",1,"btn","btn-menu","btn-search","d-md-none",3,"click"],j=["class","glyph glyph-magnifier",4,"ngIf"],N=["class","glyph glyph-clear",4,"ngIf"],D=["role","form",3,"ngClass","ngSubmit"],U=["searchForm","ngForm"],z=["type","text","id","mobileSearch","placeholder","Search for","name","search",1,"form-control",3,"ngModel","ngModelChange"],F=["name","ngModel"],B=[1,"js-side-nav","side-nav",3,"ngClass"],W=[1,"js-side-nav-container","side-nav__container"],G=[1,"side-nav__content","nav","flex-column"],Z=[1,"d-none","d-md-block","search-bar"],V=[1,"form-group"],Q=[1,"input-group"],H=["role","form",3,"ngSubmit"],q=["type","text","id","search","placeholder","Search for","name","search",1,"form-control",3,"ngModel","ngModelChange"],Y=[1,"input-group-addon"],$=[1,"glyph","glyph-magnifier"],J=[3,"ngClass"],X=["routerLink","/home"],K=[1,"glyph","glyph-home"],tt=[1,"d-sm-none",3,"ngClass"],et=["routerLink","/letters"],it=[1,"glyph","glyph-characters"],nt=["routerLink","/artists"],rt=[1,"glyph","glyph-people"],st=["routerLink","/albums"],at=[1,"glyph","glyph-music-album"],ot=["routerLink","/years"],ct=[1,"glyph","glyph-calendar"],lt=["routerLink","/playlists"],ut=[1,"glyph","glyph-music-info"],ht=["routerLink","/now-playing"],dt=[1,"glyph","glyph-audio"],pt=[3,"ngClass",4,"ngIf"],ft=["routerLink","/settings"],mt=[1,"glyph","glyph-settings"],bt=[1,"d-none","d-lg-block","side-nav-xl"],gt=[1,"nav-item",3,"ngClass"],yt=["routerLink","/home","tooltip","Home","triggers","hover"],vt=[1,"d-md-none","nav-item",3,"ngClass"],kt=["routerLink","/letters","tooltip","Letters","triggers","hover"],St=["routerLink","/artists","tooltip","Artists","triggers","hover"],wt=["routerLink","/albums","tooltip","Albums","triggers","hover"],Tt=["routerLink","/years","tooltip","Years","triggers","hover"],Ct=["routerLink","/playlists","tooltip","Playlists","triggers","hover"],At=["routerLink","/now-playing","tooltip","Now Playing","triggers","hover"],xt=["class","nav-item",3,"ngClass",4,"ngIf"],It=["routerLink","/settings","tooltip","Settings","triggers","hover"],Pt=[1,"clickable","d-none","d-sm-inline",3,"click"];function _t(t,e){if(1&t){var i=a.Ub();a.Tb(0,"span"),a.Tb(1,"span",Pt),a.Zb("click",function(t){a.vc(i);var e=a.ec();return e.selectArtist(e.path)}),a.Gc(2),a.Rb(),a.Tb(3,"span"),a.Gc(4),a.Rb(),a.Rb()}if(2&t){var n=a.ec();a.yc(2),a.Ic("",n.path.artist.albumArtist||n.path.artist.name," \u2022 "),a.yc(4),a.Hc(n.path.album.name)}}function Lt(t,e){if(1&t&&(a.Tb(0,"span"),a.Gc(1),a.Rb()),2&t){var i=a.ec();a.yc(1),a.Hc(i.path.artist.albumArtist||i.path.artist.name)}}function Ot(t,e){1&t&&(a.Tb(0,"span"),a.Gc(1,"JSMusicDB Next"),a.Rb())}function Rt(t,e){if(1&t&&(a.Tb(0,"span"),a.Gc(1),a.Rb()),2&t){var i=a.ec();a.yc(1),a.Hc(i.page)}}function Et(t,e){1&t&&(a.Tb(0,"span"),a.Gc(1,"JSMusicDB Next"),a.Rb())}function Mt(t,e){1&t&&a.Qb(0,"i",$)}var jt=[1,"glyph","glyph-clear"];function Nt(t,e){1&t&&a.Qb(0,"i",jt)}var Dt=["routerLink","/scrobble-cache"],Ut=[1,"glyph","glyph-upload"],zt=function(t){return{active:t}};function Ft(t,e){if(1&t&&(a.Tb(0,"li",J),a.Tb(1,"a",Dt),a.Qb(2,"span",Ut),a.Gc(3),a.Rb(),a.Rb()),2&t){var i=a.ec();a.kc("ngClass",a.nc(2,zt,"Scrobble cache"===i.page)),a.yc(3),a.Ic(" Scrobble cache (",i.manualScrobblingList.length,")")}}var Bt=["routerLink","/scrobble-cache","triggers","hover",3,"tooltip"];function Wt(t,e){if(1&t&&(a.Tb(0,"li",gt),a.Tb(1,"a",Bt),a.Qb(2,"span",Ut),a.Rb(),a.Rb()),2&t){var i=a.ec();a.kc("ngClass",a.nc(2,zt,"Scrobble cache"===i.page)),a.yc(1),a.mc("tooltip","Scrobble cache (",i.manualScrobblingList.length,")")}}var Gt=function(t){return{visible:t}},Zt=function(t){return{"side-nav--visible":t}};function Vt(){return Object.assign(new w.a,{placement:"right",delay:250})}var Qt=function(){function t(t,e,i,n){var r=this;this.pathService=t,this.router=e,this.lastFMService=i,this.coreService=n,this.menuVisible=!1,this.topSearchVisible=!1,this.manualScrobblingList=[],this.onDocumentClick=function(t){t.target.classList.contains("side-nav--visible")&&r.toggleMenu()},this.core=this.coreService.getCore(),this.subscription=t.pathAnnounced$.subscribe(function(t){r.path=t,r.page=null,r.menuVisible=!1,r.disableActiveLetter(),r.activateLetter(t.letter)}),this.subscription2=t.pageAnnounced$.subscribe(function(t){r.page=t.page,r.path=null,r.menuVisible=!1,r.disableActiveLetter(),r.activateLetter(t.letter)}),this.subscription3=this.lastFMService.manualScrobbleList$.subscribe(function(t){r.manualScrobblingList=t}),this.subscription4=this.core.coreParsed$.subscribe(function(t){r.ngOnInit()}),this.search=new T,Object(S.b)("manual-scrobble-list").then(function(t){r.manualScrobblingList=t||[]})}return t.prototype.ngOnInit=function(){this.letters=this.core.sortedLetters},t.prototype.disableActiveLetter=function(){this.letters.forEach(function(t){t.active&&(t.active=!1)})},t.prototype.activateLetter=function(t){t&&(t.active=!0)},t.prototype.ngOnDestroy=function(){this.subscription.unsubscribe(),this.subscription2.unsubscribe()},t.prototype.toggleMenu=function(){this.menuVisible=!this.menuVisible,this.menuVisible?this.slideOut():this.slideIn()},t.prototype.slideOut=function(){var t=document.querySelector(".js-side-nav");t.classList.add("side-nav--animatable"),t.classList.add("side-nav--visible"),document.addEventListener("click",this.onDocumentClick),t.addEventListener("transitionend",this.onTransitionEnd)},t.prototype.slideIn=function(){var t=document.querySelector(".js-side-nav");t.classList.add("side-nav--animatable"),t.classList.remove("side-nav--visible"),document.removeEventListener("click",this.onDocumentClick),t.addEventListener("transitionend",this.onTransitionEnd)},t.prototype.onTransitionEnd=function(t){var e=document.querySelector(".js-side-nav");e.classList.remove("side-nav--animatable"),e.removeEventListener("transitionend",this.onTransitionEnd)},t.prototype.onSubmit=function(){this.topSearchVisible=!1,this.menuVisible&&this.toggleMenu(),this.router.navigate(["/search",this.search.query])},t.prototype.toggleSearch=function(){this.topSearchVisible=!this.topSearchVisible,!0===this.topSearchVisible&&setTimeout(function(){document.getElementById("mobileSearch").focus()},100)},t.prototype.selectArtist=function(t){this.router.navigate(["letter",t.artist.letter.escapedLetter,"artist",t.artist.sortName])},t.prototype.selectAlbum=function(t){this.router.navigate(["letter",t.album.artist.letter.escapedLetter,"artist",t.album.artist.sortName,"album",t.album.sortName])},t.ngComponentDef=a.Jb({type:t,selectors:[["mdb-topmenu"]],factory:function(e){return new(e||t)(a.Pb(k.a),a.Pb(C.c),a.Pb(v.a),a.Pb(y.a))},features:[a.Db([{provide:w.a,useFactory:Vt}])],consts:94,vars:65,template:function(t,e){1&t&&(a.Tb(0,"div",A),a.Tb(1,"span",x),a.Zb("click",function(t){return e.toggleMenu()}),a.Tb(2,"button",I),a.Qb(3,"span",P),a.Rb(),a.Tb(4,"a",_),a.dc(),a.Tb(5,"svg",L),a.Tb(6,"g"),a.Qb(7,"path",O),a.Qb(8,"path",R),a.Rb(),a.Rb(),a.Rb(),a.Rb(),a.cc(),a.Tb(9,"h1"),a.Ec(10,_t,5,2,"span",E),a.Ec(11,Lt,2,1,"span",E),a.Ec(12,Ot,2,0,"span",E),a.Ec(13,Rt,2,1,"span",E),a.Ec(14,Et,2,0,"span",E),a.Rb(),a.Tb(15,"button",M),a.Zb("click",function(t){return e.toggleSearch()}),a.Ec(16,Mt,1,0,"i",j),a.Ec(17,Nt,1,0,"i",N),a.Rb(),a.Tb(18,"form",D,U),a.Zb("ngSubmit",function(t){return e.onSubmit()}),a.Tb(20,"input",z,F),a.Zb("ngModelChange",function(t){return e.search.query=t}),a.Rb(),a.Rb(),a.Rb(),a.Tb(22,"aside",B),a.Tb(23,"nav",W),a.Tb(24,"ul",G),a.Tb(25,"li",Z),a.Tb(26,"div",V),a.Tb(27,"div",Q),a.Tb(28,"form",H,U),a.Zb("ngSubmit",function(t){return e.onSubmit()}),a.Tb(30,"input",q,F),a.Zb("ngModelChange",function(t){return e.search.query=t}),a.Rb(),a.Tb(32,"button",Y),a.Qb(33,"i",$),a.Rb(),a.Rb(),a.Rb(),a.Rb(),a.Rb(),a.Tb(34,"li",J),a.Tb(35,"a",X),a.Qb(36,"span",K),a.Gc(37," Home"),a.Rb(),a.Rb(),a.Tb(38,"li",tt),a.Tb(39,"a",et),a.Qb(40,"span",it),a.Gc(41," Letters"),a.Rb(),a.Rb(),a.Tb(42,"li",J),a.Tb(43,"a",nt),a.Qb(44,"span",rt),a.Gc(45," Artists"),a.Rb(),a.Rb(),a.Tb(46,"li",J),a.Tb(47,"a",st),a.Qb(48,"span",at),a.Gc(49," Albums"),a.Rb(),a.Rb(),a.Tb(50,"li",J),a.Tb(51,"a",ot),a.Qb(52,"span",ct),a.Gc(53," Years"),a.Rb(),a.Rb(),a.Tb(54,"li",J),a.Tb(55,"a",lt),a.Qb(56,"span",ut),a.Gc(57," Playlists"),a.Rb(),a.Rb(),a.Tb(58,"li",J),a.Tb(59,"a",ht),a.Qb(60,"span",dt),a.Gc(61," Now playing"),a.Rb(),a.Rb(),a.Ec(62,Ft,4,4,"li",pt),a.Tb(63,"li",J),a.Tb(64,"a",ft),a.Qb(65,"span",mt),a.Gc(66," Settings"),a.Rb(),a.Rb(),a.Rb(),a.Rb(),a.Rb(),a.Tb(67,"aside",bt),a.Tb(68,"ul",G),a.Tb(69,"li",gt),a.Tb(70,"a",yt),a.Qb(71,"span",K),a.Rb(),a.Rb(),a.Tb(72,"li",vt),a.Tb(73,"a",kt),a.Qb(74,"span",it),a.Rb(),a.Rb(),a.Tb(75,"li",gt),a.Tb(76,"a",St),a.Qb(77,"span",rt),a.Rb(),a.Rb(),a.Tb(78,"li",gt),a.Tb(79,"a",wt),a.Qb(80,"span",at),a.Rb(),a.Rb(),a.Tb(81,"li",gt),a.Tb(82,"a",Tt),a.Qb(83,"span",ct),a.Rb(),a.Rb(),a.Tb(84,"li",gt),a.Tb(85,"a",Ct),a.Qb(86,"span",ut),a.Rb(),a.Rb(),a.Tb(87,"li",gt),a.Tb(88,"a",At),a.Qb(89,"span",dt),a.Rb(),a.Rb(),a.Ec(90,Wt,3,4,"li",xt),a.Tb(91,"li",gt),a.Tb(92,"a",It),a.Qb(93,"span",mt),a.Rb(),a.Rb(),a.Rb(),a.Rb()),2&t&&(a.yc(10),a.kc("ngIf",e.path&&e.path.album),a.yc(11),a.kc("ngIf",e.path&&e.path.artist&&!e.path.album),a.yc(12),a.kc("ngIf",e.path&&!e.path.artist),a.yc(13),a.kc("ngIf",!e.path&&e.page),a.yc(14),a.kc("ngIf",!e.path&&!e.page),a.yc(16),a.kc("ngIf",!e.topSearchVisible),a.yc(17),a.kc("ngIf",e.topSearchVisible),a.yc(18),a.kc("ngClass",a.nc(29,Gt,e.topSearchVisible)),a.yc(20),a.kc("ngModel",e.search.query),a.yc(22),a.kc("ngClass",a.nc(31,Zt,e.menuVisible)),a.yc(30),a.kc("ngModel",e.search.query),a.yc(34),a.kc("ngClass",a.nc(33,zt,"Home"===e.page)),a.yc(38),a.kc("ngClass",a.nc(35,zt,"Letters"===e.page)),a.yc(42),a.kc("ngClass",a.nc(37,zt,"Artists"===e.page)),a.yc(46),a.kc("ngClass",a.nc(39,zt,"Albums"===e.page)),a.yc(50),a.kc("ngClass",a.nc(41,zt,"Years"===e.page)),a.yc(54),a.kc("ngClass",a.nc(43,zt,"Playlists"===e.page)),a.yc(58),a.kc("ngClass",a.nc(45,zt,"Now playing"===e.page)),a.yc(62),a.kc("ngIf",e.manualScrobblingList.length>0),a.yc(63),a.kc("ngClass",a.nc(47,zt,"Settings"===e.page)),a.yc(69),a.kc("ngClass",a.nc(49,zt,"Home"===e.page)),a.yc(72),a.kc("ngClass",a.nc(51,zt,"Letters"===e.page)),a.yc(75),a.kc("ngClass",a.nc(53,zt,"Artists"===e.page)),a.yc(78),a.kc("ngClass",a.nc(55,zt,"Albums"===e.page)),a.yc(81),a.kc("ngClass",a.nc(57,zt,"Years"===e.page)),a.yc(84),a.kc("ngClass",a.nc(59,zt,"Playlists"===e.page)),a.yc(87),a.kc("ngClass",a.nc(61,zt,"Now playing"===e.page)),a.yc(90),a.kc("ngIf",e.manualScrobblingList.length>0),a.yc(91),a.kc("ngClass",a.nc(63,zt,"Settings"===e.page)))},directives:[s.l,c.p,c.g,c.h,s.j,c.a,c.f,c.i,C.d,u.a],encapsulation:2}),t}(),Ht=[1,"nav","d-none","d-md-flex","nav-letters"],qt=["class","nav-item align-self-stretch flex-grow-1 text-center",4,"ngFor","ngForOf"],Yt=[1,"nav-item","align-self-stretch","flex-grow-1","text-center"],$t=[3,"ngClass","click"],Jt=function(t){return{active:t}};function Xt(t,e){if(1&t){var i=a.Ub();a.Tb(0,"li",Yt),a.Tb(1,"a",$t),a.Zb("click",function(t){a.vc(i);var n=e.$implicit;return a.ec().onSelect(n)}),a.Gc(2),a.Rb(),a.Rb()}if(2&t){var n=e.$implicit;a.yc(1),a.kc("ngClass",a.nc(2,Jt,n.active)),a.yc(2),a.Hc(n.letter)}}var Kt=function(){function t(t,e){var i=this;this.coreService=t,this.router=e,this.activeLetter=null,this.core=this.coreService.getCore(),this.subscription=this.core.coreParsed$.subscribe(function(t){i.ngOnInit()})}return t.prototype.ngOnInit=function(){this.letters=this.core.sortedLetters},t.prototype.onSelect=function(t){this.activeLetter&&(this.activeLetter.active=!1),this.activeLetter=t,this.router.navigate(["/letter",t.escapedLetter])},t.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},t.ngComponentDef=a.Jb({type:t,selectors:[["mdb-letters"]],factory:function(e){return new(e||t)(a.Pb(y.a),a.Pb(C.c))},consts:2,vars:1,template:function(t,e){1&t&&(a.Tb(0,"ul",Ht),a.Ec(1,Xt,3,4,"li",qt),a.Rb()),2&t&&(a.yc(1),a.kc("ngForOf",e.letters))},directives:[s.k,s.j],encapsulation:2}),t}(),te=i("KI15"),ee=i("Zp9u"),ie=i("9dPn"),ne=i("riCG"),re=["class","player",4,"ngIf"],se=[1,"player"],ae=[1,"row"],oe=[1,"progress",3,"click"],ce=["role","progressbar",1,"progress-bar",3,"ngStyle"],le=[1,"container-fluid"],ue=[1,"row","row-sm"],he=[1,"col-xs-4","col-player-art",3,"click"],de=[3,"track","dynamic-accent-color"],pe=[1,"col-xs-11","col-player-special"],fe=[3,"click"],me=[1,"hidden-xs","color-type-secondary"],be=[1,"col-xs-9","text-right","col-player-controls"],ge=[1,"btn","btn-link",3,"click"],ye=[1,"glyph","glyph-previous"],ve=["class","glyph glyph-pause",4,"ngIf"],ke=["class","glyph glyph-play",4,"ngIf"],Se=[1,"glyph","glyph-next"],we=[1,"btn","btn-link","d-none","d-md-inline-block",3,"click"],Te=[1,"glyph",3,"ngClass"],Ce=[1,"btn","btn-link","d-none","d-md-inline-block","btn-love",3,"ngClass","click"],Ae=[1,"glyph","glyph-star-outline"],xe=[1,"btn","btn-link","d-none","d-md-inline-block","btn-shuffle",3,"ngClass","click"],Ie=[1,"glyph","glyph-shuffle"],Pe=[1,"volume-control",3,"hidden"],_e=["type","range","min","0","max","100",3,"ngModel","ngModelChange","input","change"],Le=[1,"glyph","glyph-pause"];function Oe(t,e){1&t&&a.Qb(0,"i",Le)}var Re=[1,"glyph","glyph-play"];function Ee(t,e){1&t&&a.Qb(0,"i",Re)}var Me=function(t){return{width:t}},je=function(t,e){return{"glyph-volume":t,"glyph-mute":e}},Ne=function(t){return{active:t}};function De(t,e){if(1&t){var i=a.Ub();a.Tb(0,"div",se),a.Tb(1,"div",ae),a.Tb(2,"div",oe),a.Zb("click",function(t){return a.vc(i),a.ec().jump(t)}),a.Qb(3,"div",ce),a.Rb(),a.Rb(),a.Tb(4,"div",le),a.Tb(5,"div",ue),a.Tb(6,"div",he),a.Zb("click",function(t){return a.vc(i),a.ec().navigateToNowPlaying()}),a.Qb(7,"mdb-album-art",de),a.Rb(),a.Tb(8,"div",pe),a.Tb(9,"h4"),a.Gc(10),a.Rb(),a.Tb(11,"h5"),a.Tb(12,"a",fe),a.Zb("click",function(t){return a.vc(i),a.ec().navigateToArtist()}),a.Gc(13),a.Rb(),a.Tb(14,"span",me),a.Gc(15," \u2022 "),a.Tb(16,"a",fe),a.Zb("click",function(t){return a.vc(i),a.ec().navigateToAlbum()}),a.Gc(17),a.Rb(),a.Rb(),a.Rb(),a.Rb(),a.Tb(18,"div",be),a.Tb(19,"a",ge),a.Zb("click",function(t){return a.vc(i),a.ec().prev()}),a.Qb(20,"span",ye),a.Rb(),a.Tb(21,"a",ge),a.Zb("click",function(t){return a.vc(i),a.ec().togglePlayPause()}),a.Ec(22,Oe,1,0,"i",ve),a.Ec(23,Ee,1,0,"i",ke),a.Rb(),a.Tb(24,"a",ge),a.Zb("click",function(t){return a.vc(i),a.ec().next()}),a.Qb(25,"span",Se),a.Rb(),a.Tb(26,"a",we),a.Zb("click",function(t){return a.vc(i),a.ec().toggleVolumeWindow(t)}),a.Qb(27,"span",Te),a.Rb(),a.Tb(28,"a",Ce),a.Zb("click",function(t){return a.vc(i),a.ec().toggleLoved()}),a.Qb(29,"i",Ae),a.Rb(),a.Tb(30,"a",xe),a.Zb("click",function(t){return a.vc(i),a.ec().toggleShuffle()}),a.Qb(31,"i",Ie),a.Rb(),a.Rb(),a.Rb(),a.Rb(),a.Tb(32,"div",Pe),a.Tb(33,"input",_e),a.Zb("ngModelChange",function(t){return a.vc(i),a.ec().volume=t}),a.Zb("input",function(t){return a.vc(i),a.ec().setVolume()}),a.Zb("change",function(t){return a.vc(i),a.ec().setVolume()}),a.Rb(),a.Rb(),a.Rb()}if(2&t){var n=a.ec();a.yc(3),a.kc("ngStyle",a.nc(13,Me,n.track.position/n.track.duration*100+"%")),a.yc(7),a.kc("track",n.track)("dynamic-accent-color",n.usesDynamicAccentColor),a.yc(10),a.Hc(n.track.title),a.yc(13),a.Hc(n.track.trackArtist),a.yc(17),a.Hc(n.track.album.name),a.yc(22),a.kc("ngIf",n.isPlaying),a.yc(23),a.kc("ngIf",n.isPaused),a.yc(27),a.kc("ngClass",a.oc(15,je,n.volume>0,0==n.volume)),a.yc(28),a.kc("ngClass",a.nc(18,Ne,n.track.isLoved)),a.yc(30),a.kc("ngClass",a.nc(20,Ne,n.isShuffled)),a.yc(32),a.kc("hidden",!n.showVolumeWindow),a.yc(33),a.kc("ngModel",n.volume)}}var Ue=function(){function t(t,e,i,n,r,s,a,o){var c=this;this.pathService=t,this.playerService=e,this.router=i,this.lastFMService=n,this.coreService=r,this.animationService=s,this.albumartService=a,this.colorService=o,this.showPlayer=!1,this.usesDynamicAccentColor=this.booleanState("dynamic-accent-color"),this.isPlaying=!1,this.isPaused=!1,this.hasScrobbledCurrentTrack=!1,this.isCurrentPlaylistLoaded=!1,this.isShuffled=!1,this.forceRestart=!1,this.showVolumeWindow=!1,this.volume=100,this.isHostedApp="undefined"!=typeof Windows,this.subscription=this.playerService.playlistAnnounced$.subscribe(function(t){t?(c.playlist=t.playlist,c.trackIndex=t.startIndex,c.isPaused=t.isPaused,c.isPlaying=t.isPlaying,c.isShuffled=t.isShuffled,c.forceRestart=t.forceRestart,c.showPlayer=c.isPaused||c.isPlaying,c.setTrack(t.position)):(c.isPlaying=!1,c.showPlayer=!1,c.mediaObject.pause())}),this.subscription5=this.playerService.hideVolumeWindowAnnounced$.subscribe(function(){c.showVolumeWindow=!1}),this.mediaObject=document.querySelector("audio"),this.mediaObject.crossOrigin="anonymous",this.mediaObject.canPlayType("audio/flac"),this.mediaObject.addEventListener("ended",function(){c.next()}),this.mediaObject.addEventListener("timeupdate",function(){c.updateTime()}),this.mediaObject.addEventListener("play",function(){c.onplay()}),this.mediaObject.addEventListener("progress",function(){c.onprogress()}),this.mediaObject.addEventListener("pause",function(){c.onpause()}),this.mediaObject.addEventListener("ended",function(){c.onstop()});var l=localStorage.getItem("dsm");if(l&&(this.url=l),this.core=this.coreService.getCore(),this.subscription2=this.core.coreParsed$.subscribe(function(t){var e=localStorage.getItem("save-playlist-state");e&&"true"===e&&c.readCurrentPlaylist()}),this.subscription3=this.playerService.volumeAnnounced.subscribe(function(t){c.volume=t,c.mediaObject.volume=c.volume/100}),this.subscription4=t.pageAnnounced$.subscribe(function(t){"Now playing"===t.page&&(c.showVolumeWindow=!1)}),this.isHostedApp&&(this.systemMediaControls=Windows.Media.SystemMediaTransportControls.getForCurrentView(),this.displayUpdater=this.systemMediaControls.displayUpdater,this.systemMediaControls.isEnabled=!0,this.systemMediaControls.isPlayEnabled=!0,this.systemMediaControls.isPauseEnabled=!0,this.systemMediaControls.isStopEnabled=!0,this.systemMediaControls.isNextEnabled=!0,this.systemMediaControls.isPreviousEnabled=!0,this.systemMediaControls.addEventListener("buttonpressed",function(t){var e=Windows.Media.SystemMediaTransportControlsButton;switch(t.button){case e.play:c.mediaObject.play();break;case e.pause:c.mediaObject.pause();break;case e.stop:c.playerService.stop();break;case e.next:c.next();break;case e.previous:c.prev();break;default:console.warn("key not mapped in application",t.button)}},!1),this.systemMediaControls.playbackStatus=Windows.Media.MediaPlaybackStatus.closed),-1===navigator.userAgent.indexOf("Mobi")){var u=document.querySelector("canvas"),h=u.offsetWidth,d=u.offsetHeight;u.width=h,u.height=d,u.getContext("2d"),this.audioCtx=new(window.AudioContext||window.webkitAudioContext);var p=this.audioCtx.createScriptProcessor(2048,1,1);p.connect(this.audioCtx.destination);var f=this.audioCtx.createAnalyser(),m=this.audioCtx.createMediaElementSource(this.mediaObject);f.fftSize=128;var b=f.frequencyBinCount;m.connect(f),f.connect(p),m.connect(this.audioCtx.destination),p.onaudioprocess=function(){var t=document.querySelector("canvas"),e=c.rgba||{r:0,g:110,b:205,a:1};d=t.offsetHeight,t.width=h=t.offsetWidth,t.height=d;var i=t.getContext("2d"),n=new Uint8Array(b);f.getByteFrequencyData(n),i.clearRect(0,0,h,d);for(var r,s=Math.floor(h/b*1.1),a=0,o=d/150*1.17,l=0;l<b;l++)r=n[l]*o,i.fillStyle="rgba("+e.r+","+e.g+","+e.b+","+n[l]/255+")",i.fillRect(a,d-r/2,s,r/2),a+=s+1}}this.subscription6=this.colorService.color$.subscribe(function(t){c.rgba=t})}return t.prototype.setTrack=function(t){var e=this;if(setTimeout(function(){e.albumart&&e.albumart.ngOnInit()}),this.track=this.playlist.tracks[this.trackIndex],!this.currentTrack||this.track&&this.currentTrack.id!==this.track.id||this.forceRestart){var i=localStorage.getItem("dsm");i&&(this.url=i);var n=localStorage.getItem("jwt");this.mediaObject.src=this.url+"/listen?path="+encodeURIComponent(this.track.source.url)+"&jwt="+n,this.currentTrack=this.track,this.hasScrobbledCurrentTrack=!1,this.animationService.requestAnimation("enter",document.querySelector(".player h4")),this.animationService.requestAnimation("enter",document.querySelector(".player h5"))}this.isPlaying?this.mediaObject.play():this.mediaObject.pause(),this.isCurrentPlaylistLoaded&&(this.mediaObject.currentTime=localStorage.getItem("current-time")||0,this.isCurrentPlaylistLoaded=!1),t&&(this.mediaObject.currentTime=t)},t.prototype.readCurrentPlaylist=function(){var t=this;Object(S.b)("current-playlist").then(function(e){var i=e;if(i){var n=t.coreService.getCore(),r=[];i.ids.forEach(function(t){r.push(n.tracks[t])});var s=new te.a;s.tracks=r,s.name="Current Playlist",s.isContinues=i.isContinues||!1,s.type=i.type,t.isShuffled=i.isShuffled,t.isCurrentPlaylistLoaded=!0,t.playerService.doPlayPlaylist(s,i.current,!1,i.isShuffled)}})},t.prototype.ngOnDestroy=function(){this.subscription.unsubscribe(),this.subscription2.unsubscribe(),this.subscription3.unsubscribe(),this.subscription4.unsubscribe(),this.subscription5.unsubscribe(),this.subscription6.unsubscribe(),this.mediaObject.removeEventListener("ended"),this.mediaObject.removeEventListener("timeupdate"),this.mediaObject.removeEventListener("play"),this.showVolumeWindow=!1},t.prototype.navigateToArtist=function(){this.router.navigate(["/letter",this.track.album.artist.letter.escapedLetter,"artist",this.track.album.artist.sortName])},t.prototype.navigateToAlbum=function(){this.router.navigate(["/letter",this.track.album.artist.letter.escapedLetter,"artist",this.track.album.artist.sortName,"album",this.track.album.sortName])},t.prototype.navigateToNowPlaying=function(){this.router.navigate(["/now-playing"])},t.prototype.next=function(){this.trackIndex<this.playlist.tracks.length-1?(this.trackIndex++,this.playerService.next()):this.playlist.isContinues?(this.trackIndex=0,"random"===this.playlist.type||"radio"===this.playlist.type?this.playerService.nextPlaylist(this.playlist.type):this.playerService.nextAlbum(this.track.album)):this.playerService.stop()},t.prototype.prev=function(){this.trackIndex>0&&(this.trackIndex--,this.playerService.prev())},t.prototype.togglePlayPause=function(){this.playerService.togglePlayPause()},t.prototype.updateTime=function(){if(this.track.position=1e3*this.mediaObject.currentTime,!this.hasScrobbledCurrentTrack&&(this.track.position>=t.SCROBBLETIME||this.track.position/this.track.duration>=.5&&performance.now()>t.SCROBBLETIME)){this.hasScrobbledCurrentTrack=!0;try{this.lastFMService.scrobbleTrack(this.track).subscribe(function(){})}catch(e){console.error(e)}}localStorage.setItem("current-time",this.mediaObject.currentTime.toString())},t.prototype.onplay=function(){var t=this;try{this.lastFMService.announceNowPlaying(this.track).subscribe()}catch(e){}document.title=this.track.title+" by "+this.track.trackArtist,"mediaSession"in navigator&&Object(S.b)("art-"+this.track.trackArtist+"-"+this.track.album.name).then(function(e){e&&(navigator.mediaSession.metadata=new MediaMetadata({title:t.track.title,artist:t.track.trackArtist,album:t.track.album.name,artwork:[{src:e,sizes:"500x500",type:"image/png"}]})),navigator.mediaSession.setActionHandler("play",function(){t.togglePlayPause()}),navigator.mediaSession.setActionHandler("pause",function(){t.togglePlayPause()}),navigator.mediaSession.setActionHandler("previoustrack",function(){t.prev()}),navigator.mediaSession.setActionHandler("nexttrack",function(){t.next()})}),this.isHostedApp&&(this.systemMediaControls.playbackStatus=Windows.Media.MediaPlaybackStatus.playing,this.displayUpdater.type=Windows.Media.MediaPlaybackType.music,Object(S.b)("art-"+this.track.trackArtist+"-"+this.track.album.name).then(function(i){try{void 0!==t.displayUpdater&&(t.displayUpdater.musicProperties.albumArtist=t.track.trackArtist,t.displayUpdater.musicProperties.artist=t.track.trackArtist,t.displayUpdater.musicProperties.albumTitle=t.track.album.name,t.displayUpdater.musicProperties.title=t.track.title,i&&(t.displayUpdater.thumbnail=Windows.Storage.Streams.RandomAccessStreamReference.createFromUri(new Windows.Foundation.Uri(i))),t.displayUpdater.update())}catch(e){console.error("error occurred",e)}t.updateWinTile(i)})),document.querySelector("mdb-player").dispatchEvent(new CustomEvent("external.mdbplaying",{detail:this.track})),this.audioCtx&&this.audioCtx.resume(),this.usesDynamicAccentColor=this.booleanState("dynamic-accent-color"),this.usesDynamicAccentColor&&Object(ne.b)(this.rgba)},t.prototype.onstop=function(){document.querySelector("mdb-player").dispatchEvent(new Event("external.mdbstopped")),document.title="JSMusicDB Next",this.isHostedApp&&(this.systemMediaControls.playbackStatus=Windows.Media.MediaPlaybackStatus.stopped),this.audioCtx&&this.audioCtx.suspend(),Object(ne.e)()},t.prototype.onpause=function(){document.querySelector("mdb-player").dispatchEvent(new CustomEvent("external.mdbpaused",{detail:this.track})),document.title="JSMusicDB Next",this.isHostedApp&&(this.systemMediaControls.playbackStatus=Windows.Media.MediaPlaybackStatus.paused),this.audioCtx&&this.audioCtx.suspend(),Object(ne.e)()},t.prototype.toggleShuffle=function(){this.isShuffled=!this.isShuffled,this.playerService.shufflePlaylist(this.isShuffled)},t.prototype.toggleLoved=function(){this.track.isLoved=!this.track.isLoved,this.lastFMService.toggleLoved(this.track).subscribe()},t.prototype.toggleVolumeWindow=function(t){t.stopPropagation(),t.stopImmediatePropagation(),t.preventDefault(),this.showVolumeWindow=!this.showVolumeWindow},t.prototype.onprogress=function(){var t=this.mediaObject.buffered;0!==t.length&&(this.track.buffered.start=1e3*t.start(0!==t.length?t.length-1:0),this.track.buffered.end=1e3*t.end(0!==t.length?t.length-1:0))},t.prototype.setVolume=function(){this.mediaObject.volume=this.volume/100,this.playerService.setVolume(this.volume)},t.prototype.jump=function(t){var e=(t.clientX||t.changedTouches[0].clientX)/document.querySelector(".player").clientWidth;this.playerService.setPosition(this.track.duration/1e3*e)},t.prototype.booleanState=function(t){var e=localStorage.getItem(t);return!(!e||"true"!==e)},t.prototype.updateWinTile=function(t){var e=Windows.UI.Notifications;e.TileUpdateManager.createTileUpdaterForApplication("App").clear();var i=e.TileUpdateManager.getTemplateContent(e.TileTemplateType.tileSquare150x150PeekImageAndText02),n=i.getElementsByTagName("text")[0];n.innerText=this.track.title,(n=i.getElementsByTagName("text")[1]).innerText=this.track.trackArtist,t&&(i.getElementsByTagName("image")[0].attributes[1].value=t);var r=new Date,s=new Date(r.getTime()+Number(this.track.duration)),a=i.importNode(this.getTileContent(t,"tileSquare310x310ImageAndText02").getElementsByTagName("binding").item(0),!0);i.getElementsByTagName("visual").item(0).appendChild(a),a=i.importNode(this.getTileContent(t,"tileWide310x150PeekImage02").getElementsByTagName("binding").item(0),!0),i.getElementsByTagName("visual").item(0).appendChild(a),a=i.importNode(this.getTileContent(t,"tileSquare71x71Image").getElementsByTagName("binding").item(0),!0),i.getElementsByTagName("visual").item(0).appendChild(a);var o=new e.TileNotification(i);o.expirationTime=s,e.TileUpdateManager.createTileUpdaterForApplication("App").update(o)},t.prototype.getTileContent=function(t,e){var i=Windows.UI.Notifications,n=i.TileUpdateManager.getTemplateContent(i.TileTemplateType[e]);try{n.getElementsByTagName("text")[0].innerText=this.track.title}catch(r){console.error(r)}try{n.getElementsByTagName("text")[1].innerText=this.track.trackArtist}catch(r){console.error(r)}return t&&(n.getElementsByTagName("image")[0].attributes[1].value=t),n},t.SCROBBLETIME=24e4,t.ngComponentDef=a.Jb({type:t,selectors:[["mdb-player"]],factory:function(e){return new(e||t)(a.Pb(k.a),a.Pb(d.a),a.Pb(C.c),a.Pb(v.a),a.Pb(y.a),a.Pb(f.a),a.Pb(ee.a),a.Pb(b.a))},viewQuery:function(t,e){var i;1&t&&a.Kc(ie.a,!0,null),2&t&&a.sc(i=a.bc())&&(e.albumart=i.first)},features:[a.Db([ee.a])],consts:1,vars:1,template:function(t,e){1&t&&a.Ec(0,De,34,22,"div",re),2&t&&a.kc("ngIf",e.showPlayer)},directives:[s.l,s.m,ie.a,s.j,c.l,c.a,c.f,c.i],encapsulation:2}),t}(),ze=["id","reloading",4,"ngIf"],Fe=[3,"ngClass","click"],Be=[1,"fixed-top",2,"z-index","1029",3,"click"],We=[1,"main-content",3,"ngClass","click"],Ge=[2,"display","none"],Ze=[3,"mdbprev","mdbnext","mdbtoggle","mdbstop","click","mdbblob"],Ve=["id","reloading"],Qe=[1,"container"],He=[1,"row"],qe=[1,"col"],Ye=[4,"ngIf"],$e=[1,"progress-bar"],Je=[1,"progress-circle"];function Xe(t,e){if(1&t&&(a.Tb(0,"div"),a.Gc(1),a.Rb()),2&t){var i=a.ec(2);a.yc(1),a.Ic(" progress: ",i.scanperc,"% ")}}function Ke(t,e){if(1&t&&(a.Tb(0,"div",Ve),a.Tb(1,"div",Qe),a.Tb(2,"div",He),a.Tb(3,"div",qe),a.Gc(4," Collection is being reloaded, please wait. "),a.Ec(5,Xe,2,1,"div",Ye),a.Tb(6,"div",$e),a.Qb(7,"div",Je),a.Qb(8,"div",Je),a.Qb(9,"div",Je),a.Qb(10,"div",Je),a.Qb(11,"div",Je),a.Rb(),a.Rb(),a.Rb(),a.Rb(),a.Rb()),2&t){var i=a.ec();a.yc(5),a.kc("ngIf",i.scanperc)}}var ti=function(t){return{isPlaying:t}},ei=function(){function t(t,e,i,n,r,s,a){var o=this;this.collectionService=t,this.coreService=e,this.loginService=i,this.configService=n,this.playerService=r,this.colorService=s,this.isPlaying=!1,this.scanperc=0,this.isReloading=!1,this.letter="N",this.path="JSMusicDB Next",this.isLoading=!1,this.hasBeenReloading=!1,this.isHostedApp="undefined"!=typeof Windows,this.loginService.hasToken&&(this.isLoading=!0,this.poll()),this.viewContainerRef=a,this.subscription=this.playerService.playlistAnnounced$.subscribe(function(t){o.isPlaying=!!t}),this.booleanState("tracking-state")?navigator.geolocation.getCurrentPosition(function(t){o.configService.getSunriseInfo(t.coords.latitude,t.coords.longitude).subscribe(function(t){o.configService.startDate=new Date(t.results.sunset),o.configService.stopDate=new Date(t.results.sunrise),o.configService.stopDate.setDate(o.configService.stopDate.getDate()+1),o.configService.geoSource.next(),o.configService.applyTheme()})},function(t){o.configService.startDate=new Date,o.configService.startDate.setHours(21,0,0),o.configService.stopDate=new Date,o.configService.stopDate.setDate(o.configService.stopDate.getDate()+1),o.configService.stopDate.setHours(7,0,0),o.configService.geoSource.next(),o.configService.applyTheme()}):(this.configService.startDate=new Date,this.configService.startDate.setHours(21,0,0),this.configService.stopDate=new Date,this.configService.stopDate.setDate(this.configService.stopDate.getDate()+1),this.configService.stopDate.setHours(7,0,0),this.configService.geoSource.next(),this.configService.applyTheme())}return t.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},t.prototype.ngOnInit=function(){this.mediaObject=document.querySelector("audio");var t=this.mediaObject.canPlayType("audio/flac");this.isFlacSupported="probably"===t||"maybe"===t},t.prototype.getCollection=function(){var t=this;this.collectionService.getCollection().subscribe(function(e){return t.fillCollection(e)},function(t){return console.error(t)})},t.prototype.fillCollection=function(t){localStorage.setItem("lastParsed",(new Date).getTime().toString()),this.coreService.getCore().parseSourceJson(t,this.isFlacSupported),this.isLoading=!1},t.prototype.hideVolumeWindow=function(){this.playerService.hideVolumeControl()},t.prototype.poll=function(){var t=this;this.collectionService.poll().subscribe(function(e){t.scanperc=e.progress,"ready"!==e.status?(t.isReloading=!0,document.querySelector("mdb-player").dispatchEvent(new CustomEvent("external.mdbscanning",{detail:{percentage:t.scanperc}})),setTimeout(function(e){t.poll()},5e3),t.hasBeenReloading=!0):(t.isReloading=!1,t.hasBeenReloading&&document.querySelector("mdb-player").dispatchEvent(new CustomEvent("external.mdbscanstop")),t.getCollection())})},t.prototype.onExternalPrev=function(t){this.playerService.prev()},t.prototype.onExternalNext=function(t){this.playerService.next()},t.prototype.onExternalToggle=function(t){this.playerService.togglePlayPause()},t.prototype.onExternalStop=function(t){this.playerService.stop()},t.prototype.onExternalBlob=function(){this.colorService.setBlob()},t.prototype.booleanState=function(t){var e=localStorage.getItem(t);return!(!e||"true"!==e)},t.ngComponentDef=a.Jb({type:t,selectors:[["mdb-root"]],factory:function(e){return new(e||t)(a.Pb(m.a),a.Pb(y.a),a.Pb(h.a),a.Pb(g.a),a.Pb(d.a),a.Pb(b.a),a.Pb(a.bb))},features:[a.Db([m.a,y.a,k.a,d.a,v.a,f.a,g.a,p.a,b.a])],consts:10,vars:7,template:function(t,e){1&t&&(a.Ec(0,Ke,12,1,"div",ze),a.Tb(1,"div",Fe),a.Zb("click",function(t){return e.hideVolumeWindow}),a.Qb(2,"mdb-topmenu"),a.Rb(),a.Tb(3,"div",Be),a.Zb("click",function(t){return e.hideVolumeWindow}),a.Qb(4,"mdb-letters"),a.Rb(),a.Tb(5,"div",We),a.Zb("click",function(t){return e.hideVolumeWindow}),a.Qb(6,"router-outlet"),a.Rb(),a.Qb(7,"audio",Ge),a.Qb(8,"canvas"),a.Tb(9,"mdb-player",Ze),a.Zb("mdbprev",function(t){return e.onExternalPrev(t)}),a.Zb("mdbnext",function(t){return e.onExternalNext(t)}),a.Zb("mdbtoggle",function(t){return e.onExternalToggle(t)}),a.Zb("mdbstop",function(t){return e.onExternalStop(t)}),a.Zb("click",function(t){return e.hideVolumeWindow()}),a.Zb("mdbblob",function(t){return e.onExternalBlob()}),a.Rb()),2&t&&(a.kc("ngIf",e.isReloading),a.yc(1),a.kc("ngClass",a.nc(3,ti,e.isPlaying)),a.yc(5),a.kc("ngClass",a.nc(5,ti,e.isPlaying)))},directives:[s.l,s.j,Qt,Kt,C.f,Ue],encapsulation:2}),t}(),ii=function(){function t(t,e){this.loginService=t,this.router=e}return t.prototype.canActivate=function(t,e){var i=this;return new Promise(function(t){var n=e.url;window.scrollTo(0,0),t(i.checkLogin(n))})},t.prototype.checkLogin=function(t){return!!localStorage.getItem("jwt")||(this.router.navigate(["/login"]),!1)},t.ngInjectableDef=a.Lb({token:t,factory:function(e){return new(e||t)(a.Wb(h.a),a.Wb(C.c))},providedIn:null}),t}(),ni=[ii,h.a],ri=C.e.forRoot([{path:"login",loadChildren:function(){return i.e(8).then(i.bind(null,"X3zk")).then(function(t){return t.LoginModule})}},{path:"home",loadChildren:function(){return i.e(5).then(i.bind(null,"ct+p")).then(function(t){return t.HomeModule})},canActivate:[ii]},{path:"letters",loadChildren:function(){return i.e(7).then(i.bind(null,"mCIM")).then(function(t){return t.LettersModule})},canActivate:[ii]},{path:"artists",loadChildren:function(){return i.e(4).then(i.bind(null,"3r4j")).then(function(t){return t.ArtistsModule})},canActivate:[ii]},{path:"albums",loadChildren:function(){return i.e(2).then(i.bind(null,"fX0g")).then(function(t){return t.AlbumsModule})},canActivate:[ii]},{path:"years",loadChildren:function(){return i.e(18).then(i.bind(null,"ZutQ")).then(function(t){return t.YearsModule})},canActivate:[ii]},{path:"playlists",loadChildren:function(){return i.e(11).then(i.bind(null,"kez3")).then(function(t){return t.PlaylistsModule})},canActivate:[ii]},{path:"now-playing",loadChildren:function(){return i.e(10).then(i.bind(null,"YxDV")).then(function(t){return t.NowPlayingModule})},canActivate:[ii]},{path:"settings",loadChildren:function(){return i.e(15).then(i.bind(null,"7wo0")).then(function(t){return t.SettingsModule})},canActivate:[ii]},{path:"scrobble-cache",loadChildren:function(){return i.e(13).then(i.bind(null,"BSpc")).then(function(t){return t.ScrobbleCacheModule})},canActivate:[ii]},{path:"search/:query",loadChildren:function(){return i.e(14).then(i.bind(null,"RmqX")).then(function(t){return t.SearchModule})},canActivate:[ii]},{path:"letter/:letter",loadChildren:function(){return i.e(6).then(i.bind(null,"pJo8")).then(function(t){return t.LetterDetailModule})},canActivate:[ii]},{path:"letter/:letter/artist/:artist",loadChildren:function(){return i.e(3).then(i.bind(null,"2+yB")).then(function(t){return t.ArtistDetailModule})},canActivate:[ii]},{path:"letter/:letter/artist/:artist/album/:album",loadChildren:function(){return i.e(1).then(i.bind(null,"jJnS")).then(function(t){return t.AlbumDetailModule})},canActivate:[ii]},{path:"",loadChildren:function(){return i.e(5).then(i.bind(null,"ct+p")).then(function(t){return t.HomeModule})},canActivate:[ii]}],{preloadingStrategy:C.b}),si=function(){function t(){}return t.prototype.supports=function(t){var e=!1;return 0===t.indexOf("mdb")&&(e=!0),e},t.prototype.addEventListener=function(t,e,i){var n=this,r=this.manager.getZone(),s=function(t){r.run(function(){return i(t)})};return this.manager.getZone().runOutsideAngular(function(){n.manager.addEventListener(t,"external."+e,s)})},t.prototype.addGlobalEventListener=function(t,e,i){var n=this,r=this.manager.getZone(),s=function(t){return r.run(function(){return i(t)})};return this.manager.getZone().runOutsideAngular(function(){n.manager.addGlobalEventListener(t,e,s)})},t.ngInjectableDef=a.Lb({token:t,factory:function(e){return new(e||t)},providedIn:null}),t}(),ai=i("hDf6"),oi=function(){function t(){"serviceWorker"in navigator&&navigator.serviceWorker.register("sw.js").then(function(t){}).catch(function(t){console.error("Registration failed with "+t)})}return t.ngModuleDef=a.Nb({type:t,bootstrap:[ei]}),t.ngInjectorDef=a.Mb({factory:function(e){return new(e||t)},providers:[ni,{provide:l.b,useClass:si,multi:!0},{provide:a.C,useValue:"en-GB"}],imports:[[l.a,o.b,c.b,ri,u.b.forRoot(),ai.a]]}),t.ngLocaleIdDef="en-GB",t}();u.b.forRoot(),s.v(r.a),Object(a.fb)(),window.addEventListener("beforeinstallprompt",function(t){t.preventDefault(),window.deferredPrompt=t}),l.c().bootstrapModule(oi).catch(function(t){return console.error(t)})}},[[0,0,17]]]);