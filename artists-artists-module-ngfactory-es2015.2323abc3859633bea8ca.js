(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"0/mZ":function(t,l,n){"use strict";n.d(l,"a",function(){return s});var e=n("ztCj"),i=(n("xOws"),function(t,l,n,e){return new(n||(n=Promise))(function(i,s){function a(t){try{u(e.next(t))}catch(l){s(l)}}function r(t){try{u(e.throw(t))}catch(l){s(l)}}function u(t){t.done?i(t.value):new n(function(l){l(t.value)}).then(a,r)}u((e=e.apply(t,l||[])).next())})});class s{constructor(t,l){this.backgroundArtService=l,this.NOIMAGE="global/images/no-cover.png",this.loading=!1,this.loaded=!1,this.error=!1,this.loadingClass="loading",this.loadedClass="loaded",this.errorClass="error",this.el=t.nativeElement,setTimeout(()=>{this.loadImage()},100)}loadImage(){if(!this.loaded&&!this.loading||this.hasClassName("always-replace")){this.loading=!0,this.addClassName(this.loadingClass);let t=`art-${this.media.name}`;this.media.artist&&!this.media.trackArtist?t=`art-${this.media.artist.name}-${this.media.name}`:this.media.trackArtist&&(t=`art-${this.media.trackArtist}-${this.media.album.name}`),Object(e.c)(t).then(t=>{t?this.setImage(t):this.backgroundArtService.getMediaArt(this.media).subscribe(t=>this.setImage(t),t=>{this.el.style.backgroundImage=`url(${this.NOIMAGE})`,this.error=!0,this.loading=!1,this.removeClassName(this.loadingClass),this.addClassName(this.errorClass)})})}}setImage(t){return i(this,void 0,void 0,function*(){let l=localStorage.getItem("dsm");if(l&&(l+="/data/image-proxy?url="),!this.loaded||this.hasClassName("always-replace")){if(t!==this.NOIMAGE&&""!==t&&t){this.el.style.backgroundImage=(t=yield this.backgroundArtService.returnImageUrlFromLastFMResponse(t))?`url(${t})`:`url(${this.NOIMAGE})`;const l={_id:`art-${this.media.name}`,url:t||this.NOIMAGE};this.media.artist&&(l._id=`art-${this.media.artist.name}-${this.media.name}`),Object(e.d)(l._id,l.url)}else this.backgroundArtService.getMediaArtFromLastFm(this.media).subscribe(t=>i(this,void 0,void 0,function*(){(t=yield this.backgroundArtService.returnImageUrlFromLastFMResponse(t))&&t!==this.NOIMAGE?this.el.style.backgroundImage=`url(${l}${encodeURIComponent(t)})`:(t||(t=this.NOIMAGE),this.el.style.backgroundImage=`url(${t})`);const n={_id:`art-${this.media.name}`,url:t||this.NOIMAGE};this.media.artist&&(n._id=`art-${this.media.artist.name}-${this.media.name}`),Object(e.d)(n._id,n.url)}),t=>this.el.style.backgroundImage=`url(${this.NOIMAGE})`);this.loading=!1,this.toggleLoaded(!0)}})}getPosition(){const t=this.el.getBoundingClientRect(),l=t.top+(window.pageYOffset-document.documentElement.clientTop);return{top:l,left:t.left+(window.pageXOffset-document.documentElement.clientLeft),bottom:l+this.el.clientHeight}}getLoadingContainer(){return this.el}hasClassName(t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(this.getLoadingContainer().className)}addClassName(t){if(!this.hasClassName(t)){const l=this.getLoadingContainer();l.className=l.className?[l.className,t].join(" "):t}}removeClassName(t){if(this.hasClassName(t)){const l=this.getLoadingContainer();l.className=l.className.replace(new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)","g"),"")}}toggleLoaded(t){this.loaded=t,t?(this.removeClassName(this.loadingClass),this.addClassName(this.loadedClass)):this.removeClassName(this.loadedClass)}}},"q+AI":function(t,l,n){"use strict";n.r(l);var e=n("8Y7J");class i{}var s=n("pMnS"),a=n("BZiF"),r=n("EAnT"),u=n("iInd"),o=n("SVse"),c=n("Vmu9"),m=n("ktVm"),h=n("XtVx");class d{constructor(t,l,n){this.coreService=t,this.pathService=l,this.router=n,this.letters=[],this.showJumpList=!1,this.cummlativeLength=[],this.core=this.coreService.getCore(),this.subscription=this.core.coreParsed$.subscribe(t=>{this.ngOnInit()})}ngOnInit(){this.pathService.announcePage("Artists"),this.letters=this.core.sortedLetters,this.letters.forEach((t,l)=>{const n=this.getSize(t,l);this.cummlativeLength[l]=l>0?this.cummlativeLength[l-1]+n:n,t.sortArtistsBy("sortName","asc")})}ngOnDestroy(){this.subscription.unsubscribe()}navigateToArtist(t){this.router.navigate(["/letter",t.letter.escapedLetter,"artist",t.sortName])}getSize(t,l){return 90*t.artists.length+49}toggleJumpList(){this.showJumpList=!this.showJumpList}jumpToLetter(t){this.showJumpList=!1;const l=this.letters.indexOf(t);window.scrollTo(0,this.cummlativeLength[l>0?l-1:0])}}var g=e.mb({encapsulation:2,styles:[],data:{}});function b(t){return e.Jb(0,[(t()(),e.ob(0,0,null,null,8,"li",[],null,[[null,"click"]],function(t,l,n){var e=!0;return"click"===l&&(e=!1!==t.component.navigateToArtist(t.context.$implicit)&&e),e},null,null)),(t()(),e.ob(1,0,null,null,2,"div",[["class","image-wrapper"]],null,null,null,null,null)),(t()(),e.ob(2,0,null,null,1,"mdb-artist",[],null,null,null,a.b,a.a)),e.nb(3,49152,null,0,r.a,[u.k],{artist:[0,"artist"]},null),(t()(),e.ob(4,0,null,null,4,"div",[["class","text-wrapper"]],null,null,null,null,null)),(t()(),e.ob(5,0,null,null,1,"span",[["class","text"]],null,null,null,null,null)),(t()(),e.Hb(6,null,["",""])),(t()(),e.ob(7,0,null,null,1,"span",[["class","small muted color-type-secondary"]],null,null,null,null,null)),(t()(),e.Hb(8,null,["Albums: ",""]))],function(t,l){t(l,3,0,l.context.$implicit)},function(t,l){t(l,6,0,l.context.$implicit.albumArtist||l.context.$implicit.name),t(l,8,0,l.context.$implicit.albums.length)})}function p(t){return e.Jb(0,[(t()(),e.ob(0,0,null,null,7,"div",[["class","row"]],null,null,null,null,null)),(t()(),e.ob(1,0,null,null,6,"div",[["class","col"]],null,null,null,null,null)),(t()(),e.ob(2,0,null,null,2,"h4",[],null,null,null,null,null)),(t()(),e.ob(3,0,null,null,1,"a",[],[[8,"id",0]],[[null,"click"]],function(t,l,n){var e=!0;return"click"===l&&(e=!1!==t.component.toggleJumpList()&&e),e},null,null)),(t()(),e.Hb(4,null,["",""])),(t()(),e.ob(5,0,null,null,2,"ul",[],null,null,null,null,null)),(t()(),e.eb(16777216,null,null,1,null,b)),e.nb(7,278528,null,0,o.j,[e.M,e.J,e.q],{ngForOf:[0,"ngForOf"]},null)],function(t,l){t(l,7,0,l.context.$implicit.artists)},function(t,l){t(l,3,0,e.sb(1,"letter_",l.context.$implicit.letter,"")),t(l,4,0,l.context.$implicit.letter)})}function f(t){return e.Jb(0,[(t()(),e.ob(0,0,null,null,2,"div",[],null,null,null,null,null)),(t()(),e.eb(16777216,null,null,1,null,p)),e.nb(2,278528,null,0,o.j,[e.M,e.J,e.q],{ngForOf:[0,"ngForOf"]},null)],function(t,l){t(l,2,0,l.context.vsCollection)},null)}function v(t){return e.Jb(0,[(t()(),e.ob(0,0,null,null,2,"li",[],null,null,null,null,null)),(t()(),e.ob(1,0,null,null,1,"a",[],null,[[null,"click"]],function(t,l,n){var e=!0;return"click"===l&&(e=!1!==t.component.jumpToLetter(t.context.$implicit)&&e),e},null,null)),(t()(),e.Hb(2,null,["",""]))],null,function(t,l){t(l,2,0,l.context.$implicit.letter)})}function A(t){return e.Jb(0,[(t()(),e.ob(0,0,null,null,10,"div",[["class","animated-page"]],null,null,null,null,null)),(t()(),e.ob(1,0,null,null,2,"div",[["class","container container-longlist"],["imageLazyLoadArea",""]],null,null,null,null,null)),(t()(),e.eb(16777216,null,null,1,null,f)),e.nb(3,737280,null,0,c.a,[e.k,e.M,e.J,e.x],{vsSize:[0,"vsSize"],vsExcess:[1,"vsExcess"],vsScrollParent:[2,"vsScrollParent"],originalCollection:[3,"originalCollection"]},null),(t()(),e.ob(4,0,null,null,6,"div",[["class","jump-list"]],null,null,null,null,null)),e.Eb(512,null,o.u,o.v,[e.q,e.r,e.k,e.B]),e.nb(6,278528,null,0,o.i,[o.u],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),e.Cb(7,{visible:0}),(t()(),e.ob(8,0,null,null,2,"ol",[],null,null,null,null,null)),(t()(),e.eb(16777216,null,null,1,null,v)),e.nb(10,278528,null,0,o.j,[e.M,e.J,e.q],{ngForOf:[0,"ngForOf"]},null)],function(t,l){var n=l.component;t(l,3,0,n.getSize,2,"body",n.letters);var e=t(l,7,0,n.showJumpList);t(l,6,0,"jump-list",e),t(l,10,0,n.letters)},null)}function y(t){return e.Jb(0,[(t()(),e.ob(0,0,null,null,1,"app-artists",[],null,null,null,A,g)),e.nb(1,245760,null,0,d,[m.a,h.a,u.k],null,null)],function(t,l){t(l,1,0)},null)}var C=e.kb("app-artists",d,y,{},{},[]);class w{}var I=n("hDf6");n.d(l,"ArtistsModuleNgFactory",function(){return k});var k=e.lb(i,[],function(t){return e.xb([e.yb(512,e.j,e.X,[[8,[s.a,C]],[3,e.j],e.v]),e.yb(4608,o.m,o.l,[e.s,[2,o.z]]),e.yb(1073742336,o.b,o.b,[]),e.yb(1073742336,u.m,u.m,[[2,u.r],[2,u.k]]),e.yb(1073742336,w,w,[]),e.yb(1073742336,I.a,I.a,[]),e.yb(1073742336,i,i,[]),e.yb(256,e.s,"en-GB",[]),e.yb(1024,u.i,function(){return[[{path:"",component:d}]]},[])])})},xOws:function(t,l,n){"use strict";n.d(l,"a",function(){return s});var e=n("XWo6"),i=function(t,l,n,e){return new(n||(n=Promise))(function(i,s){function a(t){try{u(e.next(t))}catch(l){s(l)}}function r(t){try{u(e.throw(t))}catch(l){s(l)}}function u(t){t.done?i(t.value):new n(function(l){l(t.value)}).then(a,r)}u((e=e.apply(t,l||[])).next())})};class s{constructor(t){this.http=t,this.API_KEY="639fca5adcf955a19f9a04f8985e9ded",this.lastFMImageRetriever=new e.a(t)}getMediaArt(t){const l=this.extractInfo(t);return this.lastFMImageRetriever.getMediaArt(l.artist,l.album,l.type)}getMediaArtFromLastFm(t){const l=this.extractInfo(t);return this.lastFMImageRetriever.getMediaArt(l.artist,l.album,l.type)}returnImageUrlFromLastFMResponse(t){return i(this,void 0,void 0,function*(){if(t.album)return t.album.image[t.album.image.length-1]["#text"];if(t.artist){const l=t.artist.mbid;return l?this.getArtistURLArtFormFanart(l,t.artist):t.artist.image[t.artist.image.length-1]["#text"]}return t})}getArtistURLArtFormFanart(t,l){return i(this,void 0,void 0,function*(){const n=yield fetch(`https://webservice.fanart.tv/v3/music/${t}&?api_key=${this.API_KEY}&format=json`);if(200===n.status){const t=yield n.json();if(t.artistbackground)return t.artistbackground[0].url}return this.getArtistURLArtFromAudioDB(l)})}getArtistURLArtFromAudioDB(t){return i(this,void 0,void 0,function*(){const l=yield fetch(`https://www.theaudiodb.com/api/v1/json/1/search.php?s=${encodeURIComponent(t.name)}`);if(200===l.status){const t=yield l.json();if(t&&t.artists)return t.artists[0].strArtistFanart}return t.image[t.image.length-1]["#text"]})}extractInfo(t){let l="",n="",e="artist";return t.trackArtist&&t.album.artist.isCollection?l=t.trackArtist:t.artist?(l=t.artist.albumArtist||t.artist.name,n=t.name||t.album.name,e="album"):l=t.albumArtist||t.name,{artist:l,album:n,type:e}}}}}]);