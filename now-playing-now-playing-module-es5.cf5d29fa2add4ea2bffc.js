!function(){function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{YxDV:function(i,n,s){"use strict";s.r(n),s.d(n,"NowPlayingModule",(function(){return O}));var o=s("ofXK"),a=s("3Pt+"),r=s("hDf6"),c=s("tyNb"),u=s("z6cu"),l=(s("hR/0"),s("ufXC")),b=s("1gFc"),d=s("ktVm"),h=s("t083"),g=s("XtVx"),m=s("fXoL"),p=s("tk/3"),v=s("Oz9T"),f=s("cpgm");function y(t,e){1&t&&m.Jb(0,"canvas")}function k(t,e){if(1&t){var i=m.Mb();m.Lb(0,"div",34),m.nc(1,y,1,0,"canvas",35),m.Lb(2,"div",36),m.Rb("swipeleft",(function(){return m.kc(i),m.Vb(2).next()}))("swiperight",(function(){return m.kc(i),m.Vb(2).prev()})),m.Jb(3,"album-art",37),m.Kb(),m.Lb(4,"div",38),m.Rb("swipeleft",(function(){return m.kc(i),m.Vb(2).next()}))("swiperight",(function(){return m.kc(i),m.Vb(2).prev()})),m.Kb(),m.Kb()}if(2&t){var n=m.Vb(2);m.xb(1),m.bc("ngIf",n.showVisualisation),m.xb(2),m.bc("artist",n.track.trackArtist)("album",n.track.album.name)}}var L=function(t){return{width:t}},S=function(t){return{"margin-left":t}},w=function(t){return{dragging:t}};function I(t,e){if(1&t&&(m.Lb(0,"div",39),m.Jb(1,"div",40),m.Jb(2,"div",41),m.Jb(3,"div",42),m.Kb()),2&t){var i=m.Vb(2);m.xb(1),m.bc("ngStyle",m.ec(4,L,i.round(i.track.buffered.end/i.track.duration*100)+"%")),m.xb(1),m.bc("ngStyle",m.ec(6,L,i.track.position/i.track.duration*100+"%")),m.xb(1),m.bc("ngStyle",m.ec(8,S,i.track.position/i.track.duration*100+"%"))("ngClass",m.ec(10,w,i.isDragging))}}function x(t,e){1&t&&m.Jb(0,"div",43)}function V(t,e){if(1&t&&(m.Lb(0,"span",44),m.oc(1),m.Wb(2,"timeFormat"),m.Kb()),2&t){var i=m.Vb(2);m.xb(1),m.pc(m.Xb(2,1,i.track.position))}}function K(t,e){if(1&t&&(m.Lb(0,"span",45),m.oc(1),m.Wb(2,"timeFormat"),m.Kb()),2&t){var i=m.Vb(2);m.xb(1),m.pc(m.Xb(2,1,i.track.duration))}}function P(t,e){1&t&&m.Jb(0,"i",46)}function T(t,e){1&t&&m.Jb(0,"i",47)}var E=function(t){return{active:t}};function M(t,e){if(1&t){var i=m.Mb();m.Lb(0,"button",48),m.Rb("click",(function(){return m.kc(i),m.Vb(2).toggleLoved()})),m.Jb(1,"i",49),m.Kb()}if(2&t){var n=m.Vb(2);m.bc("ngClass",m.ec(1,E,n.track.isLoved))}}var C=function(t,e,i){return{slided:t,"small-art":e,"no-focus":i}},B=function(t,e){return{"glyph-volume":t,"glyph-mute":e}};function D(t,e){if(1&t){var i=m.Mb();m.Lb(0,"div",2),m.Lb(1,"div",3),m.nc(2,k,5,3,"div",4),m.Lb(3,"div",5),m.Lb(4,"div",6),m.nc(5,I,4,12,"div",7),m.nc(6,x,1,0,"div",8),m.nc(7,V,3,3,"span",9),m.nc(8,K,3,3,"span",10),m.Lb(9,"div",11),m.Lb(10,"h4"),m.oc(11),m.Kb(),m.Lb(12,"h5"),m.Lb(13,"a",12),m.Rb("click",(function(){return m.kc(i),m.Vb().navigateToArtist()})),m.oc(14),m.Kb(),m.Lb(15,"span",13),m.oc(16," \u2022 "),m.Lb(17,"a",12),m.Rb("click",(function(){return m.kc(i),m.Vb().navigateToAlbum()})),m.oc(18),m.Kb(),m.Kb(),m.Kb(),m.Kb(),m.Kb(),m.Lb(19,"div",14),m.Lb(20,"div",15),m.Lb(21,"button",16),m.Rb("click",(function(){return m.kc(i),m.Vb().prev()})),m.Jb(22,"i",17),m.Kb(),m.Lb(23,"button",16),m.Rb("click",(function(){return m.kc(i),m.Vb().togglePlayPause()})),m.nc(24,P,1,0,"i",18),m.nc(25,T,1,0,"i",19),m.Kb(),m.Lb(26,"button",16),m.Rb("click",(function(){return m.kc(i),m.Vb().next()})),m.Jb(27,"i",20),m.Kb(),m.nc(28,M,2,3,"button",21),m.Lb(29,"button",22),m.Rb("click",(function(t){return m.kc(i),m.Vb().toggleVolumeWindow(t)})),m.Jb(30,"span",23),m.Kb(),m.Lb(31,"button",24),m.Rb("click",(function(){return m.kc(i),m.Vb().toggleShuffle()})),m.Jb(32,"i",25),m.Kb(),m.Kb(),m.Lb(33,"div",26),m.Lb(34,"input",27),m.Rb("ngModelChange",(function(t){return m.kc(i),m.Vb().volume=t}))("input",(function(){return m.kc(i),m.Vb().setVolume()}))("change",(function(){return m.kc(i),m.Vb().setVolume()})),m.Kb(),m.Kb(),m.Lb(35,"div",15),m.Lb(36,"button",28),m.Rb("click",(function(){return m.kc(i),m.Vb().toggleSlide()})),m.Jb(37,"i",29),m.Kb(),m.Kb(),m.Kb(),m.Kb(),m.Kb(),m.Lb(38,"div",30),m.Lb(39,"div",31),m.Lb(40,"div",32),m.Lb(41,"div",15),m.Jb(42,"mdb-tracklist",33),m.Kb(),m.Kb(),m.Kb(),m.Kb(),m.Kb()}if(2&t){var n=m.Vb();m.bc("ngClass",m.gc(18,C,n.slided,n.smallArt,n.noFocus)),m.xb(2),m.bc("ngIf",!n.videoMode),m.xb(3),m.bc("ngIf",!n.videoMode),m.xb(1),m.bc("ngIf",!n.videoMode),m.xb(1),m.bc("ngIf",!n.videoMode),m.xb(1),m.bc("ngIf",!n.videoMode),m.xb(3),m.pc(n.track.title),m.xb(3),m.pc(n.track.trackArtist),m.xb(4),m.pc(n.track.album.name),m.xb(6),m.bc("ngIf",n.isPlaying),m.xb(1),m.bc("ngIf",n.isPaused),m.xb(3),m.bc("ngIf","mdb-skipped"!==n.lastfmusername),m.xb(1),m.bc("disabled",n.videoMode),m.xb(1),m.bc("ngClass",m.fc(22,B,n.volume>0,0==n.volume)),m.xb(1),m.bc("ngClass",m.ec(25,E,n.isShuffled)),m.xb(2),m.bc("hidden",!n.showVolumeWindow),m.xb(1),m.bc("ngModel",n.volume),m.xb(8),m.bc("playlist",n.playlist)}}function J(t,e){1&t&&(m.Lb(0,"div",50),m.Lb(1,"div",51),m.Lb(2,"div",31),m.Lb(3,"div",52),m.Lb(4,"div",15),m.Lb(5,"h3"),m.oc(6,"Nothing is playing"),m.Kb(),m.Lb(7,"p"),m.oc(8," This is where you'll see the song you're playing and songs that are coming up. "),m.Kb(),m.Lb(9,"p"),m.oc(10," Find an "),m.Lb(11,"a",53),m.Jb(12,"span",54),m.oc(13," artist"),m.Kb(),m.oc(14," or "),m.Lb(15,"a",55),m.Jb(16,"span",56),m.oc(17," album"),m.Kb(),m.oc(18," that you want to play; or setup a "),m.Lb(19,"a",57),m.Jb(20,"span",58),m.oc(21," playlist"),m.Kb(),m.Kb(),m.Kb(),m.Kb(),m.Kb(),m.Kb(),m.Kb())}var R,A,N,F=[{path:"",component:(R=function(){function i(e,n,s,o,a,r,c){var u=this;t(this,i),this.pathService=e,this.coreService=n,this.playerService=s,this.router=o,this.lastFMService=a,this.animationService=r,this.http=c,this.previousTrack={},this.slided=!1,this.isPlaying=!1,this.isPaused=!1,this.isShuffled=!1,this.isDragging=!1,this.c=this,this.lastfmusername="",this.showVolumeWindow=!1,this.volume=100,this.showVisualisation=this.booleanState("visualisation-state"),this.preferVideo=this.booleanState("preferVideo-state"),this.smallArt=this.booleanState("small-art"),this.videoMode=!1,this.isEventBound=!1,this.noFocus=!1,this.timeoutTimer=null,this.timeoutTime=5e3,this.startDrag=function(t){u.isDragging=!0},this.drag=function(t){if(u.isDragging){var e=((t.clientX||t.changedTouches[0].clientX)-60)/document.getElementById("progress-pusher").clientWidth;e>=0&&e<=1&&u.setIndicatorPosition(e)}},this.stopDrag=function(t){if(u.isDragging){u.isDragging=!1;var e=((t.clientX||t.changedTouches[0].clientX)-60)/document.getElementById("progress-pusher").clientWidth;u.playerService.setPosition(u.track.duration/1e3*e)}};var l=this.playerService.getCurrentPlaylist();l&&(this.playlist=l.playlist,this.trackIndex=l.startIndex,this.isPaused=l.isPaused,this.isPlaying=l.isPlaying,this.isShuffled=l.isShuffled,this.volume=this.playerService.getVolume(),this.setTrack()),this.subscription=this.playerService.playlistAnnounced$.subscribe((function(t){u.playlist=t.playlist,u.trackIndex=t.startIndex,u.isPaused=t.isPaused,u.isPlaying=t.isPlaying,u.isShuffled=t.isShuffled,u.setTrack()})),this.subscription2=this.playerService.volumeAnnounced.subscribe((function(t){u.volume=t})),this.subscription3=this.playerService.hideVolumeWindowAnnounced$.subscribe((function(){u.showVolumeWindow=!1})),this.pathService.announcePage("Now playing"),"ontouchstart"in document.documentElement?(document.getElementsByTagName("body")[0].addEventListener("touchmove",this.drag),document.getElementsByTagName("body")[0].addEventListener("touchend",this.stopDrag)):(document.getElementsByTagName("body")[0].addEventListener("mousemove",this.drag),document.getElementsByTagName("body")[0].addEventListener("mouseup",this.stopDrag)),this.timeoutTimer=setTimeout((function(){u.onTimeout()}),this.timeoutTime)}var n,s,o;return n=i,(s=[{key:"ngOnInit",value:function(){var t=this;setTimeout((function(){t.track&&("ontouchstart"in document.documentElement?document.getElementById("progress-pusher").addEventListener("touchstart",t.startDrag):document.getElementById("progress-pusher").addEventListener("mousedown",t.startDrag),t.isEventBound=!0)}),250),this.lastfmusername=localStorage.getItem("lastfm-username")||""}},{key:"setTrack",value:function(){var t=this;this.track=this.playlist.tracks[this.trackIndex],this.currentTrack!==this.track&&(this.currentTrack=this.track,this.animationService.requestAnimation("enter",document.querySelector(".controls-wrapper h4")),this.animationService.requestAnimation("enter",document.querySelector(".controls-wrapper h5"))),this.isEventBound||setTimeout((function(){try{"ontouchstart"in document.documentElement?document.getElementById("progress-pusher").addEventListener("touchstart",t.startDrag):document.getElementById("progress-pusher").addEventListener("mousedown",t.startDrag),t.isEventBound=!0}catch(e){console.error(e)}}),250)}},{key:"toggleSlide",value:function(){this.slided=!this.slided}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe(),this.subscription2.unsubscribe(),this.subscription3.unsubscribe(),"ontouchstart"in document.documentElement?(document.getElementsByTagName("body")[0].removeEventListener("touchmove",this.drag),document.getElementsByTagName("body")[0].removeEventListener("touchend",this.stopDrag)):(document.getElementsByTagName("body")[0].removeEventListener("mousemove",this.drag),document.getElementsByTagName("body")[0].removeEventListener("mouseup",this.stopDrag)),clearTimeout(this.timeoutTime)}},{key:"navigateToArtist",value:function(){this.router.navigate(["/letter",this.track.album.artist.letter.escapedLetter,"artist",this.track.album.artist.sortName])}},{key:"navigateToAlbum",value:function(){this.router.navigate(["/letter",this.track.album.artist.letter.escapedLetter,"artist",this.track.album.artist.sortName,"album",this.track.album.sortName])}},{key:"next",value:function(){var t=this;this.videoMode&&this.playerService.resume(),this.videoMode=!1,setTimeout((function(){var e=document.querySelector(".previous-album-art");e.style.backgroundImage=document.querySelector(".current-album-art").style.backgroundImage,e.classList.remove("slideRightOut"),e.classList.remove("slideLeftOut"),t.animationService.requestAnimation("slideLeftOut",e,!1),t.trackIndex<t.playlist.tracks.length-1?(t.trackIndex++,t.playerService.next()):t.playlist.isContinues?(t.trackIndex=0,"random"===t.playlist.type||"radio"===t.playlist.type?t.playerService.nextPlaylist(t.playlist.type):t.playerService.nextAlbum(t.track.album)):t.playerService.stop()}))}},{key:"prev",value:function(){var t=this;this.videoMode&&this.playerService.resume(),this.videoMode=!1,setTimeout((function(){var e=document.querySelector(".previous-album-art");e.style.backgroundImage=document.querySelector(".current-album-art").style.backgroundImage,e.classList.remove("slideRightOut"),e.classList.remove("slideLeftOut"),t.animationService.requestAnimation("slideRightOut",e,!1),t.trackIndex>0&&(t.trackIndex--,t.playerService.prev())}))}},{key:"togglePlayPause",value:function(){this.videoMode?this.isPlaying?(this.player.pauseVideo(),this.isPlaying=!1,this.isPaused=!0):(this.player.playVideo(),this.isPlaying=!0,this.isPaused=!1):this.playerService.togglePlayPause()}},{key:"toggleShuffle",value:function(){this.isShuffled=!this.isShuffled,this.playerService.shufflePlaylist(this.isShuffled)}},{key:"toggleLoved",value:function(){this.track.isLoved=!this.track.isLoved,this.lastFMService.toggleLoved(this.track).subscribe((function(t){console.info(t)}))}},{key:"setIndicatorPosition",value:function(t){document.getElementById("position-indicator").style.marginLeft=100*t+"%"}},{key:"toggleVolumeWindow",value:function(t){t.stopPropagation(),t.stopImmediatePropagation(),t.preventDefault(),this.showVolumeWindow=!this.showVolumeWindow}},{key:"setVolume",value:function(){this.playerService.setVolume(this.volume)}},{key:"round",value:function(t){return Math.floor(t)}},{key:"handleError",value:function(t){return Object(u.a)("no video")}},{key:"toggleVideo",value:function(){this.videoMode=!this.videoMode,this.videoMode?this.playerService.pause():this.playerService.togglePlayPause()}},{key:"savePlayer",value:function(t){this.player=t,this.player.playVideo(),this.isPlaying=!0,this.isPaused=!1}},{key:"onStateChange",value:function(t){0===t.data&&(this.videoMode=!1,this.next())}},{key:"onTimeout",value:function(){this.slided||this.videoMode||(this.noFocus=!0)}},{key:"onMove",value:function(t){var e=this;clearTimeout(this.timeoutTimer),this.noFocus=!1,this.timeoutTimer=setTimeout((function(){e.onTimeout()}),this.timeoutTime)}},{key:"booleanState",value:function(t){var e=localStorage.getItem(t);return!(!e||"true"!==e)}}])&&e(n.prototype,s),o&&e(n,o),i}(),R.\u0275fac=function(t){return new(t||R)(m.Ib(g.a),m.Ib(d.a),m.Ib(l.a),m.Ib(c.c),m.Ib(h.a),m.Ib(b.a),m.Ib(p.a))},R.\u0275cmp=m.Cb({type:R,selectors:[["ng-component"]],hostBindings:function(t,e){1&t&&m.Rb("mousemove",(function(t){return e.onMove(t)}))},decls:2,vars:2,consts:[["class","container-fluid animated-page","id","nowPlaying",3,"ngClass",4,"ngIf"],["class","animated-page",4,"ngIf"],["id","nowPlaying",1,"container-fluid","animated-page",3,"ngClass"],[1,"top"],["class","image-wrapper",4,"ngIf"],[1,"control-wrapper-wrapper"],[1,"row","controls-wrapper"],["class","progress",4,"ngIf"],["id","progress-pusher",4,"ngIf"],["class","time start",4,"ngIf"],["class","time stop",4,"ngIf"],[1,"track-info"],[3,"click"],[1,"hidden-xs","color-type-secondary"],[1,"row","icons"],[1,"col-12"],[1,"btn","btn-link",3,"click"],[1,"glyph","glyph-previous"],["class","glyph glyph-pause",4,"ngIf"],["class","glyph glyph-play",4,"ngIf"],[1,"glyph","glyph-next"],["class","btn btn-link btn-love",3,"ngClass","click",4,"ngIf"],[1,"btn","btn-link","btn-volume","d-none","d-md-inline",3,"disabled","click"],[1,"glyph",3,"ngClass"],[1,"btn","btn-link","d-none","d-md-inline","btn-shuffle",3,"ngClass","click"],[1,"glyph","glyph-shuffle"],[1,"volume-control",3,"hidden"],["type","range","min","0","max","100",3,"ngModel","ngModelChange","input","change"],[1,"btn","btn-link","btn-updown",3,"click"],["id","upordown",1,"glyph","glyph-chevron-up"],[1,"bottom"],[1,"container"],[1,"row"],[3,"playlist"],[1,"image-wrapper"],[4,"ngIf"],[1,"current-album-art","always-replace",3,"swipeleft","swiperight"],["objectFit","contain",3,"artist","album"],[1,"previous-album-art",3,"swipeleft","swiperight"],[1,"progress"],["role","progressbar",1,"progress-bar","buffered-bar",3,"ngStyle"],[1,"progress-bar",3,"ngStyle"],["id","position-indicator",3,"ngStyle","ngClass"],["id","progress-pusher"],[1,"time","start"],[1,"time","stop"],[1,"glyph","glyph-pause"],[1,"glyph","glyph-play"],[1,"btn","btn-link","btn-love",3,"ngClass","click"],[1,"glyph","glyph-star-outline"],[1,"animated-page"],[1,"jumbotron","theme-light"],[1,"row","albumdetail"],["routerLink","/artists"],[1,"glyph","glyph-people"],["routerLink","/albums"],[1,"glyph","glyph-music-album"],["routerLink","/playlists"],[1,"glyph","glyph-music-info"]],template:function(t,e){1&t&&(m.nc(0,D,43,27,"div",0),m.nc(1,J,22,0,"div",1)),2&t&&(m.bc("ngIf",e.track),m.xb(1),m.bc("ngIf",!e.track))},directives:[o.k,o.i,a.i,a.a,a.c,a.f,v.a,o.l,c.d],pipes:[f.a],encapsulation:2}),R)}],W=((N=function e(){t(this,e)}).\u0275mod=m.Gb({type:N}),N.\u0275inj=m.Fb({factory:function(t){return new(t||N)},imports:[[c.e.forChild(F)],c.e]}),N),O=((A=function e(){t(this,e)}).\u0275mod=m.Gb({type:A}),A.\u0275inj=m.Fb({factory:function(t){return new(t||A)},imports:[[o.b,W,r.a,a.b]]}),A)}}])}();