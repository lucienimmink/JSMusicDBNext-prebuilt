(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{BSpc:function(c,t,i){"use strict";i.r(t);var s=i("ofXK"),e=i("fXoL"),n=i("hDf6"),b=i("tyNb"),o=i("ztCj"),l=i("MDLy"),r=i("ktVm"),a=i("t083"),u=i("XtVx");const h=[1,"animated-page"],m=[1,"container"],g=[1,"row"],p=["class","col",4,"ngIf"],f=[1,"col"],d=[1,"small","muted","color-type-secondary"],S=[1,"float-right","d-none","d-sm-inline",3,"click"],v=[1,"list-items","list-tracks"],y=["class","list-items-row list-tracks-no-hover",4,"ngFor","ngForOf"],L=["class","btn btn-primary",3,"click",4,"ngIf"],T=[1,"list-items-row","list-tracks-no-hover"],k=[1,"col-4","col-sm-3"],R=[1,"col-4","col-sm-3","d-none","d-sm-block"],w=[1,"small","muted"],I=[1,"col-8","col-sm-3"],O=[1,"col-6","col-sm-2"],D=[1,"col-6","col-sm-1","text-right"],M=[1,"glyph","glyph-delete",3,"click"];function j(c,t){if(1&c){const c=e.Ub();e.Tb(0,"li",T),e.Tb(1,"div",g),e.Tb(2,"div",k),e.Gc(3),e.Rb(),e.Tb(4,"div",R),e.Tb(5,"span",w),e.Gc(6),e.Rb(),e.Rb(),e.Tb(7,"div",I),e.Gc(8),e.Rb(),e.Tb(9,"div",O),e.Tb(10,"span",w),e.Gc(11),e.fc(12,"date"),e.fc(13,"date"),e.Rb(),e.Rb(),e.Tb(14,"div",D),e.Tb(15,"a",M),e.Zb("click",function(i){e.vc(c);const s=t.$implicit;return e.ec(2).removeFromScrobbleList(s)}),e.Rb(),e.Rb(),e.Rb(),e.Rb()}if(2&c){const c=t.$implicit;e.yc(3),e.Ic(" ",c.artist," "),e.yc(6),e.Hc(c.album),e.yc(8),e.Ic(" ",c.track," "),e.yc(11),e.Jc("",e.hc(12,5,1e3*c.timestamp,"mediumDate")," ",e.hc(13,8,1e3*c.timestamp,"shortTime"),"")}}const G=[1,"btn","btn-primary",3,"click"];function F(c,t){if(1&c){const c=e.Ub();e.Tb(0,"button",G),e.Zb("click",function(t){return e.vc(c),e.ec(2).scrobbleNow()}),e.Gc(1,"Scrobble now"),e.Rb()}}function B(c,t){if(1&c){const c=e.Ub();e.Tb(0,"div",f),e.Tb(1,"h4"),e.Gc(2," Tracks in scrobble cache "),e.Tb(3,"span",d),e.Gc(4),e.Rb(),e.Tb(5,"a",S),e.Zb("click",function(t){return e.vc(c),e.ec().scrobbleNow()}),e.Gc(6,"Scrobble now"),e.Rb(),e.Rb(),e.Tb(7,"ol",v),e.Ec(8,j,16,11,"li",y),e.Rb(),e.Ec(9,F,2,0,"button",L),e.Rb()}if(2&c){const c=e.ec();e.yc(4),e.Ic("(",c.manualScrobblingList.length,")"),e.yc(8),e.kc("ngForOf",c.manualScrobblingList),e.yc(9),e.kc("ngIf",c.manualScrobblingList.length>0&&!c.isBusy)}}const C=[{path:"",component:(()=>{class c{constructor(c,t,i,s,e){this.pathService=c,this.coreService=t,this.lastFMService=i,this.collectionService=s,this.router=e,this.manualScrobbling=this.booleanState("manual-scrobble-state"),this.isReloading=!1,this.isBusy=!1,this.core=this.coreService.getCore(),this.subscription=this.core.coreParsed$.subscribe(c=>{this.ngOnInit()}),this.subscription2=this.lastFMService.manualScrobbleList$.subscribe(c=>{this.manualScrobblingList=c}),Object(o.b)("manual-scrobble-list").then(c=>{this.manualScrobblingList=c||[]})}ngOnInit(){this.pathService.announcePage("Scrobble cache"),Object(o.b)("manual-scrobble-list").then(c=>{this.manualScrobblingList=c||[]})}ngOnDestroy(){this.subscription.unsubscribe(),this.subscription2.unsubscribe()}scrobbleNow(){this.isBusy=!0,Object(o.b)("manual-scrobble-list").then(c=>{this.manualScrobblingList=c||[];const t=this.manualScrobblingList.pop();this.lastFMService.scrobbleCachedTrack(t).subscribe(c=>{Object(o.c)("manual-scrobble-list",this.manualScrobblingList),this.lastFMService.updateManualScrobbleList(),this.manualScrobblingList.length>0?this.scrobbleNow():this.isBusy=!1})})}removeFromScrobbleList(c){Object(o.b)("manual-scrobble-list").then(t=>{this.manualScrobblingList=t||[];let i=-1;this.manualScrobblingList.forEach((t,s)=>{Object.is(t,c)&&(i=s)}),this.manualScrobblingList.splice(i,1),Object(o.c)("manual-scrobble-list",this.manualScrobblingList)})}booleanState(c){const t=localStorage.getItem(c);return!(!t||"true"!==t)}}return c.ngComponentDef=e.Jb({type:c,selectors:[["app-scrobble-cache"]],factory:function(t){return new(t||c)(e.Pb(u.a),e.Pb(r.a),e.Pb(a.a),e.Pb(l.a),e.Pb(b.c))},consts:4,vars:1,template:function(c,t){1&c&&(e.Tb(0,"div",h),e.Tb(1,"div",m),e.Tb(2,"div",g),e.Ec(3,B,10,3,"div",p),e.Rb(),e.Rb(),e.Rb()),2&c&&(e.yc(3),e.kc("ngIf",t.manualScrobblingList&&t.manualScrobbling))},directives:[s.l,s.k],pipes:[s.e],encapsulation:2}),c})()}];let N=(()=>{class c{}return c.ngModuleDef=e.Nb({type:c}),c.ngInjectorDef=e.Mb({factory:function(t){return new(t||c)},imports:[[b.e.forChild(C)],b.e]}),c.ngLocaleIdDef="en-GB",c})();b.e.forChild(C),i.d(t,"ScrobbleCacheModule",function(){return P});let P=(()=>{class c{}return c.ngModuleDef=e.Nb({type:c}),c.ngInjectorDef=e.Mb({factory:function(t){return new(t||c)},imports:[[s.c,N,n.a]]}),c.ngLocaleIdDef="en-GB",c})()}}]);