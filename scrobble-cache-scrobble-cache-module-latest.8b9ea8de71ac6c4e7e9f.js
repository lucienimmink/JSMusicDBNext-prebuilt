(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{BSpc:function(c,t,i){"use strict";i.r(t);var s=i("ofXK"),e=i("fXoL"),n=i("hDf6"),b=i("tyNb"),o=i("ztCj"),l=i("MDLy"),r=i("ktVm"),a=i("t083"),u=i("XtVx");const m=[1,"animated-page"],h=[1,"container"],g=[1,"row"],p=["class","col",4,"ngIf"],d=[1,"col"],f=[1,"small","muted","color-type-secondary"],S=[1,"float-right","d-none","d-sm-inline",3,"click"],v=[1,"list-items","list-tracks"],L=["class","list-items-row list-tracks-no-hover",4,"ngFor","ngForOf"],T=["class","btn btn-primary",3,"click",4,"ngIf"],V=[1,"list-items-row","list-tracks-no-hover"],y=[1,"col-4","col-sm-3"],k=[1,"col-4","col-sm-3","d-none","d-sm-block"],w=[1,"small","muted"],O=[1,"col-8","col-sm-3"],j=[1,"col-6","col-sm-2"],D=[1,"col-6","col-sm-1","text-right"],I=[1,"glyph","glyph-delete",3,"click"];function J(c,t){if(1&c){const c=e.Wb();e.Vb(0,"li",V),e.Vb(1,"div",g),e.Vb(2,"div",y),e.Jc(3),e.Tb(),e.Vb(4,"div",k),e.Vb(5,"span",w),e.Jc(6),e.Tb(),e.Tb(),e.Vb(7,"div",O),e.Jc(8),e.Tb(),e.Vb(9,"div",j),e.Vb(10,"span",w),e.Jc(11),e.hc(12,"date"),e.hc(13,"date"),e.Tb(),e.Tb(),e.Vb(14,"div",D),e.Vb(15,"a",I),e.bc("click",(function(i){e.xc(c);const s=t.$implicit;return e.gc(2).removeFromScrobbleList(s)})),e.Tb(),e.Tb(),e.Tb(),e.Tb()}if(2&c){const c=t.$implicit;e.Ac(3),e.Lc(" ",c.artist," "),e.Ac(6),e.Kc(c.album),e.Ac(8),e.Lc(" ",c.track," "),e.Ac(11),e.Mc("",e.jc(12,5,1e3*c.timestamp,"mediumDate")," ",e.jc(13,8,1e3*c.timestamp,"shortTime"),"")}}const M=[1,"btn","btn-primary",3,"click"];function F(c,t){if(1&c){const c=e.Wb();e.Vb(0,"button",M),e.bc("click",(function(t){return e.xc(c),e.gc(2).scrobbleNow()})),e.Jc(1,"Scrobble now"),e.Tb()}}function A(c,t){if(1&c){const c=e.Wb();e.Vb(0,"div",d),e.Vb(1,"h4"),e.Jc(2," Tracks in scrobble cache "),e.Vb(3,"span",f),e.Jc(4),e.Tb(),e.Vb(5,"a",S),e.bc("click",(function(t){return e.xc(c),e.gc().scrobbleNow()})),e.Jc(6,"Scrobble now"),e.Tb(),e.Tb(),e.Vb(7,"ol",v),e.Hc(8,J,16,11,"li",L),e.Tb(),e.Hc(9,F,2,0,"button",T),e.Tb()}if(2&c){const c=e.gc();e.Ac(4),e.Lc("(",c.manualScrobblingList.length,")"),e.Ac(8),e.mc("ngForOf",c.manualScrobblingList),e.Ac(9),e.mc("ngIf",c.manualScrobblingList.length>0&&!c.isBusy)}}const B=[{path:"",component:(()=>{class c{constructor(c,t,i,s,e){this.pathService=c,this.coreService=t,this.lastFMService=i,this.collectionService=s,this.router=e,this.manualScrobbling=this.booleanState("manual-scrobble-state"),this.isReloading=!1,this.isBusy=!1,this.core=this.coreService.getCore(),this.subscription=this.core.coreParsed$.subscribe(c=>{this.ngOnInit()}),this.subscription2=this.lastFMService.manualScrobbleList$.subscribe(c=>{this.manualScrobblingList=c}),Object(o.c)("manual-scrobble-list").then(c=>{this.manualScrobblingList=c||[]})}ngOnInit(){this.pathService.announcePage("Scrobble cache"),Object(o.c)("manual-scrobble-list").then(c=>{this.manualScrobblingList=c||[]})}ngOnDestroy(){this.subscription.unsubscribe(),this.subscription2.unsubscribe()}scrobbleNow(){this.isBusy=!0,Object(o.c)("manual-scrobble-list").then(c=>{this.manualScrobblingList=c||[];const t=this.manualScrobblingList.pop();this.lastFMService.scrobbleCachedTrack(t).subscribe(c=>{Object(o.d)("manual-scrobble-list",this.manualScrobblingList),this.lastFMService.updateManualScrobbleList(),this.manualScrobblingList.length>0?this.scrobbleNow():this.isBusy=!1})})}removeFromScrobbleList(c){Object(o.c)("manual-scrobble-list").then(t=>{this.manualScrobblingList=t||[];let i=-1;this.manualScrobblingList.forEach((t,s)=>{Object.is(t,c)&&(i=s)}),this.manualScrobblingList.splice(i,1),Object(o.d)("manual-scrobble-list",this.manualScrobblingList)})}booleanState(c){const t=localStorage.getItem(c);return!(!t||"true"!==t)}}return c.ngComponentDef=e.Lb({type:c,selectors:[["app-scrobble-cache"]],factory:function(t){return new(t||c)(e.Rb(u.a),e.Rb(r.a),e.Rb(a.a),e.Rb(l.a),e.Rb(b.c))},consts:4,vars:1,template:function(c,t){1&c&&(e.Vb(0,"div",m),e.Vb(1,"div",h),e.Vb(2,"div",g),e.Hc(3,A,10,3,"div",p),e.Tb(),e.Tb(),e.Tb()),2&c&&(e.Ac(3),e.mc("ngIf",t.manualScrobblingList&&t.manualScrobbling))},directives:[s.l,s.k],pipes:[s.e],encapsulation:2}),c})()}];let C=(()=>{class c{}return c.ngModuleDef=e.Pb({type:c}),c.ngInjectorDef=e.Ob({factory:function(t){return new(t||c)},imports:[[b.e.forChild(B)],b.e]}),c.ngLocaleIdDef="en-GB",c})();b.e.forChild(B),i.d(t,"ScrobbleCacheModule",(function(){return R}));let R=(()=>{class c{}return c.ngModuleDef=e.Pb({type:c}),c.ngInjectorDef=e.Ob({factory:function(t){return new(t||c)},imports:[[s.c,C,n.a]]}),c.ngLocaleIdDef="en-GB",c})()}}]);