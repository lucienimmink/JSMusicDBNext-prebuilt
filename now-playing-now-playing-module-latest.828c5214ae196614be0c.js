function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{YxDV:function(e,t,i){"use strict";i.r(t);var n=i("ofXK"),s=i("fXoL"),a=i("3Pt+"),o=i("hDf6"),r=i("tyNb"),c=i("z6cu"),l=(i("hR/0"),i("ufXC")),u=i("1gFc"),d=i("ktVm"),g=i("t083"),h=i("XtVx"),m=i("tk/3"),b=i("Oz9T"),p=i("cpgm"),v=["class","container-fluid animated-page","id","nowPlaying",3,"ngClass",4,"ngIf"],f=["class","animated-page",4,"ngIf"],y=["id","nowPlaying",1,"container-fluid","animated-page",3,"ngClass"],k=[1,"top"],T=["class","image-wrapper",4,"ngIf"],S=[1,"control-wrapper-wrapper"],V=[1,"row","controls-wrapper"],w=["class","progress",4,"ngIf"],I=["id","progress-pusher",4,"ngIf"],P=["class","time start",4,"ngIf"],A=["class","time stop",4,"ngIf"],x=[1,"track-info"],E=[3,"click"],L=[1,"hidden-xs","color-type-secondary"],C=[1,"row","icons"],M=[1,"col-12"],D=[1,"btn","btn-link",3,"click"],B=[1,"glyph","glyph-previous"],J=["class","glyph glyph-pause",4,"ngIf"],N=["class","glyph glyph-play",4,"ngIf"],O=[1,"glyph","glyph-next"],W=["class","btn btn-link btn-love",3,"ngClass","click",4,"ngIf"],q=[1,"btn","btn-link","btn-volume","d-none","d-md-inline",3,"disabled","click"],F=[1,"glyph",3,"ngClass"],H=[1,"btn","btn-link","d-none","d-md-inline","btn-shuffle",3,"ngClass","click"],R=[1,"glyph","glyph-shuffle"],_=[1,"volume-control",3,"hidden"],X=["type","range","min","0","max","100",3,"ngModel","ngModelChange","input","change"],j=[1,"btn","btn-link","btn-updown",3,"click"],K=["id","upordown",1,"glyph","glyph-chevron-up"],z=[1,"bottom"],G=[1,"container"],$=[1,"row"],Y=[3,"playlist"],Q=[1,"image-wrapper"],U=[4,"ngIf"],Z=[1,"current-album-art","always-replace",3,"swipeleft","swiperight"],ee=["objectFit","contain",3,"artist","album"],te=[1,"previous-album-art",3,"swipeleft","swiperight"];function ie(e,t){1&e&&s.Sb(0,"canvas")}function ne(e,t){if(1&e){var i=s.Wb();s.Vb(0,"div",Q),s.Hc(1,ie,1,0,"canvas",U),s.Vb(2,"div",Z),s.bc("swipeleft",(function(e){return s.xc(i),s.gc(2).next()})),s.bc("swiperight",(function(e){return s.xc(i),s.gc(2).prev()})),s.Sb(3,"album-art",ee),s.Tb(),s.Vb(4,"div",te),s.bc("swipeleft",(function(e){return s.xc(i),s.gc(2).next()})),s.bc("swiperight",(function(e){return s.xc(i),s.gc(2).prev()})),s.Tb(),s.Tb()}if(2&e){var n=s.gc(2);s.Ac(1),s.mc("ngIf",n.showVisualisation),s.Ac(3),s.mc("artist",n.track.trackArtist)("album",n.track.album.name)}}var se=[1,"progress"],ae=["role","progressbar",1,"progress-bar","buffered-bar",3,"ngStyle"],oe=[1,"progress-bar",3,"ngStyle"],re=["id","position-indicator",3,"ngStyle","ngClass"],ce=function(e){return{width:e}},le=function(e){return{"margin-left":e}},ue=function(e){return{dragging:e}};function de(e,t){if(1&e&&(s.Vb(0,"div",se),s.Sb(1,"div",ae),s.Sb(2,"div",oe),s.Sb(3,"div",re),s.Tb()),2&e){var i=s.gc(2);s.Ac(1),s.mc("ngStyle",s.pc(4,ce,i.round(i.track.buffered.end/i.track.duration*100)+"%")),s.Ac(2),s.mc("ngStyle",s.pc(6,ce,i.track.position/i.track.duration*100+"%")),s.Ac(3),s.mc("ngStyle",s.pc(8,le,i.track.position/i.track.duration*100+"%"))("ngClass",s.pc(10,ue,i.isDragging))}}var ge=["id","progress-pusher"];function he(e,t){1&e&&s.Sb(0,"div",ge)}var me=[1,"time","start"];function be(e,t){if(1&e&&(s.Vb(0,"span",me),s.Jc(1),s.hc(2,"timeFormat"),s.Tb()),2&e){var i=s.gc(2);s.Ac(1),s.Kc(s.ic(2,1,i.track.position))}}var pe=[1,"time","stop"];function ve(e,t){if(1&e&&(s.Vb(0,"span",pe),s.Jc(1),s.hc(2,"timeFormat"),s.Tb()),2&e){var i=s.gc(2);s.Ac(1),s.Kc(s.ic(2,1,i.track.duration))}}var fe=[1,"glyph","glyph-pause"];function ye(e,t){1&e&&s.Sb(0,"i",fe)}var ke=[1,"glyph","glyph-play"];function Te(e,t){1&e&&s.Sb(0,"i",ke)}var Se=[1,"btn","btn-link","btn-love",3,"ngClass","click"],Ve=[1,"glyph","glyph-star-outline"],we=function(e){return{active:e}};function Ie(e,t){if(1&e){var i=s.Wb();s.Vb(0,"button",Se),s.bc("click",(function(e){return s.xc(i),s.gc(2).toggleLoved()})),s.Sb(1,"i",Ve),s.Tb()}if(2&e){var n=s.gc(2);s.mc("ngClass",s.pc(1,we,n.track.isLoved))}}var Pe=function(e,t,i){return{slided:e,"small-art":t,"no-focus":i}},Ae=function(e,t){return{"glyph-volume":e,"glyph-mute":t}};function xe(e,t){if(1&e){var i=s.Wb();s.Vb(0,"div",y),s.Vb(1,"div",k),s.Hc(2,ne,5,3,"div",T),s.Vb(3,"div",S),s.Vb(4,"div",V),s.Hc(5,de,4,12,"div",w),s.Hc(6,he,1,0,"div",I),s.Hc(7,be,3,3,"span",P),s.Hc(8,ve,3,3,"span",A),s.Vb(9,"div",x),s.Vb(10,"h4"),s.Jc(11),s.Tb(),s.Vb(12,"h5"),s.Vb(13,"a",E),s.bc("click",(function(e){return s.xc(i),s.gc().navigateToArtist()})),s.Jc(14),s.Tb(),s.Vb(15,"span",L),s.Jc(16," \u2022 "),s.Vb(17,"a",E),s.bc("click",(function(e){return s.xc(i),s.gc().navigateToAlbum()})),s.Jc(18),s.Tb(),s.Tb(),s.Tb(),s.Tb(),s.Tb(),s.Vb(19,"div",C),s.Vb(20,"div",M),s.Vb(21,"button",D),s.bc("click",(function(e){return s.xc(i),s.gc().prev()})),s.Sb(22,"i",B),s.Tb(),s.Vb(23,"button",D),s.bc("click",(function(e){return s.xc(i),s.gc().togglePlayPause()})),s.Hc(24,ye,1,0,"i",J),s.Hc(25,Te,1,0,"i",N),s.Tb(),s.Vb(26,"button",D),s.bc("click",(function(e){return s.xc(i),s.gc().next()})),s.Sb(27,"i",O),s.Tb(),s.Hc(28,Ie,2,3,"button",W),s.Vb(29,"button",q),s.bc("click",(function(e){return s.xc(i),s.gc().toggleVolumeWindow(e)})),s.Sb(30,"span",F),s.Tb(),s.Vb(31,"button",H),s.bc("click",(function(e){return s.xc(i),s.gc().toggleShuffle()})),s.Sb(32,"i",R),s.Tb(),s.Tb(),s.Vb(33,"div",_),s.Vb(34,"input",X),s.bc("ngModelChange",(function(e){return s.xc(i),s.gc().volume=e})),s.bc("input",(function(e){return s.xc(i),s.gc().setVolume()})),s.bc("change",(function(e){return s.xc(i),s.gc().setVolume()})),s.Tb(),s.Tb(),s.Vb(35,"div",M),s.Vb(36,"button",j),s.bc("click",(function(e){return s.xc(i),s.gc().toggleSlide()})),s.Sb(37,"i",K),s.Tb(),s.Tb(),s.Tb(),s.Tb(),s.Tb(),s.Vb(38,"div",z),s.Vb(39,"div",G),s.Vb(40,"div",$),s.Vb(41,"div",M),s.Sb(42,"mdb-tracklist",Y),s.Tb(),s.Tb(),s.Tb(),s.Tb(),s.Tb()}if(2&e){var n=s.gc();s.mc("ngClass",s.rc(18,Pe,n.slided,n.smallArt,n.noFocus)),s.Ac(2),s.mc("ngIf",!n.videoMode),s.Ac(5),s.mc("ngIf",!n.videoMode),s.Ac(6),s.mc("ngIf",!n.videoMode),s.Ac(7),s.mc("ngIf",!n.videoMode),s.Ac(8),s.mc("ngIf",!n.videoMode),s.Ac(11),s.Kc(n.track.title),s.Ac(14),s.Kc(n.track.trackArtist),s.Ac(18),s.Kc(n.track.album.name),s.Ac(24),s.mc("ngIf",n.isPlaying),s.Ac(25),s.mc("ngIf",n.isPaused),s.Ac(28),s.mc("ngIf","mdb-skipped"!==n.lastfmusername),s.Ac(29),s.mc("disabled",n.videoMode),s.Ac(30),s.mc("ngClass",s.qc(22,Ae,n.volume>0,0==n.volume)),s.Ac(31),s.mc("ngClass",s.pc(25,we,n.isShuffled)),s.Ac(33),s.mc("hidden",!n.showVolumeWindow),s.Ac(34),s.mc("ngModel",n.volume),s.Ac(42),s.mc("playlist",n.playlist)}}var Ee=[1,"animated-page"],Le=[1,"jumbotron","theme-light"],Ce=[1,"row","albumdetail"],Me=["routerLink","/artists"],De=[1,"glyph","glyph-people"],Be=["routerLink","/albums"],Je=[1,"glyph","glyph-music-album"],Ne=["routerLink","/playlists"],Oe=[1,"glyph","glyph-music-info"];function We(e,t){1&e&&(s.Vb(0,"div",Ee),s.Vb(1,"div",Le),s.Vb(2,"div",G),s.Vb(3,"div",Ce),s.Vb(4,"div",M),s.Vb(5,"h3"),s.Jc(6,"Nothing is playing"),s.Tb(),s.Vb(7,"p"),s.Jc(8," This is where you'll see the song you're playing and songs that are coming up. "),s.Tb(),s.Vb(9,"p"),s.Jc(10," Find an "),s.Vb(11,"a",Me),s.Sb(12,"span",De),s.Jc(13," artist"),s.Tb(),s.Jc(14," or "),s.Vb(15,"a",Be),s.Sb(16,"span",Je),s.Jc(17," album"),s.Tb(),s.Jc(18," that you want to play; or setup a "),s.Vb(19,"a",Ne),s.Sb(20,"span",Oe),s.Jc(21," playlist"),s.Tb(),s.Tb(),s.Tb(),s.Tb(),s.Tb(),s.Tb(),s.Tb())}var qe,Fe,He=[{path:"",component:(qe=function(){function e(t,i,n,s,a,o,r){var c=this;_classCallCheck(this,e),this.pathService=t,this.coreService=i,this.playerService=n,this.router=s,this.lastFMService=a,this.animationService=o,this.http=r,this.previousTrack={},this.slided=!1,this.isPlaying=!1,this.isPaused=!1,this.isShuffled=!1,this.isDragging=!1,this.c=this,this.lastfmusername="",this.showVolumeWindow=!1,this.volume=100,this.showVisualisation=this.booleanState("visualisation-state"),this.preferVideo=this.booleanState("preferVideo-state"),this.smallArt=this.booleanState("small-art"),this.videoMode=!1,this.isEventBound=!1,this.noFocus=!1,this.timeoutTimer=null,this.timeoutTime=5e3,this.startDrag=function(e){c.isDragging=!0},this.drag=function(e){if(c.isDragging){var t=((e.clientX||e.changedTouches[0].clientX)-60)/document.getElementById("progress-pusher").clientWidth;t>=0&&t<=1&&c.setIndicatorPosition(t)}},this.stopDrag=function(e){if(c.isDragging){c.isDragging=!1;var t=((e.clientX||e.changedTouches[0].clientX)-60)/document.getElementById("progress-pusher").clientWidth;c.playerService.setPosition(c.track.duration/1e3*t)}};var l=this.playerService.getCurrentPlaylist();l&&(this.playlist=l.playlist,this.trackIndex=l.startIndex,this.isPaused=l.isPaused,this.isPlaying=l.isPlaying,this.isShuffled=l.isShuffled,this.volume=this.playerService.getVolume(),this.setTrack()),this.subscription=this.playerService.playlistAnnounced$.subscribe((function(e){c.playlist=e.playlist,c.trackIndex=e.startIndex,c.isPaused=e.isPaused,c.isPlaying=e.isPlaying,c.isShuffled=e.isShuffled,c.setTrack()})),this.subscription2=this.playerService.volumeAnnounced.subscribe((function(e){c.volume=e})),this.subscription3=this.playerService.hideVolumeWindowAnnounced$.subscribe((function(){c.showVolumeWindow=!1})),this.pathService.announcePage("Now playing"),"ontouchstart"in document.documentElement?(document.getElementsByTagName("body")[0].addEventListener("touchmove",this.drag),document.getElementsByTagName("body")[0].addEventListener("touchend",this.stopDrag)):(document.getElementsByTagName("body")[0].addEventListener("mousemove",this.drag),document.getElementsByTagName("body")[0].addEventListener("mouseup",this.stopDrag)),this.timeoutTimer=setTimeout((function(){c.onTimeout()}),this.timeoutTime)}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;setTimeout((function(){e.track&&("ontouchstart"in document.documentElement?document.getElementById("progress-pusher").addEventListener("touchstart",e.startDrag):document.getElementById("progress-pusher").addEventListener("mousedown",e.startDrag),e.isEventBound=!0)}),250),this.lastfmusername=localStorage.getItem("lastfm-username")||""}},{key:"setTrack",value:function(){var e=this;this.track=this.playlist.tracks[this.trackIndex],this.currentTrack!==this.track&&(this.currentTrack=this.track,this.animationService.requestAnimation("enter",document.querySelector(".controls-wrapper h4")),this.animationService.requestAnimation("enter",document.querySelector(".controls-wrapper h5"))),this.isEventBound||setTimeout((function(){try{"ontouchstart"in document.documentElement?document.getElementById("progress-pusher").addEventListener("touchstart",e.startDrag):document.getElementById("progress-pusher").addEventListener("mousedown",e.startDrag),e.isEventBound=!0}catch(t){console.error(t)}}),250)}},{key:"toggleSlide",value:function(){this.slided=!this.slided}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe(),this.subscription2.unsubscribe(),this.subscription3.unsubscribe(),"ontouchstart"in document.documentElement?(document.getElementsByTagName("body")[0].removeEventListener("touchmove",this.drag),document.getElementsByTagName("body")[0].removeEventListener("touchend",this.stopDrag)):(document.getElementsByTagName("body")[0].removeEventListener("mousemove",this.drag),document.getElementsByTagName("body")[0].removeEventListener("mouseup",this.stopDrag)),clearTimeout(this.timeoutTime)}},{key:"navigateToArtist",value:function(){this.router.navigate(["/letter",this.track.album.artist.letter.escapedLetter,"artist",this.track.album.artist.sortName])}},{key:"navigateToAlbum",value:function(){this.router.navigate(["/letter",this.track.album.artist.letter.escapedLetter,"artist",this.track.album.artist.sortName,"album",this.track.album.sortName])}},{key:"next",value:function(){var e=this;this.videoMode&&this.playerService.resume(),this.videoMode=!1,setTimeout((function(){var t=document.querySelector(".previous-album-art");t.style.backgroundImage=document.querySelector(".current-album-art").style.backgroundImage,t.classList.remove("slideRightOut"),t.classList.remove("slideLeftOut"),e.animationService.requestAnimation("slideLeftOut",t,!1),e.trackIndex<e.playlist.tracks.length-1?(e.trackIndex++,e.playerService.next()):e.playlist.isContinues?(e.trackIndex=0,"random"===e.playlist.type||"radio"===e.playlist.type?e.playerService.nextPlaylist(e.playlist.type):e.playerService.nextAlbum(e.track.album)):e.playerService.stop()}))}},{key:"prev",value:function(){var e=this;this.videoMode&&this.playerService.resume(),this.videoMode=!1,setTimeout((function(){var t=document.querySelector(".previous-album-art");t.style.backgroundImage=document.querySelector(".current-album-art").style.backgroundImage,t.classList.remove("slideRightOut"),t.classList.remove("slideLeftOut"),e.animationService.requestAnimation("slideRightOut",t,!1),e.trackIndex>0&&(e.trackIndex--,e.playerService.prev())}))}},{key:"togglePlayPause",value:function(){this.videoMode?this.isPlaying?(this.player.pauseVideo(),this.isPlaying=!1,this.isPaused=!0):(this.player.playVideo(),this.isPlaying=!0,this.isPaused=!1):this.playerService.togglePlayPause()}},{key:"toggleShuffle",value:function(){this.isShuffled=!this.isShuffled,this.playerService.shufflePlaylist(this.isShuffled)}},{key:"toggleLoved",value:function(){this.track.isLoved=!this.track.isLoved,this.lastFMService.toggleLoved(this.track).subscribe((function(e){console.info(e)}))}},{key:"setIndicatorPosition",value:function(e){document.getElementById("position-indicator").style.marginLeft=100*e+"%"}},{key:"toggleVolumeWindow",value:function(e){e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault(),this.showVolumeWindow=!this.showVolumeWindow}},{key:"setVolume",value:function(){this.playerService.setVolume(this.volume)}},{key:"round",value:function(e){return Math.floor(e)}},{key:"handleError",value:function(e){return Object(c.a)("no video")}},{key:"toggleVideo",value:function(){this.videoMode=!this.videoMode,this.videoMode?this.playerService.pause():this.playerService.togglePlayPause()}},{key:"savePlayer",value:function(e){this.player=e,this.player.playVideo(),this.isPlaying=!0,this.isPaused=!1}},{key:"onStateChange",value:function(e){0===e.data&&(this.videoMode=!1,this.next())}},{key:"onTimeout",value:function(){this.slided||this.videoMode||(this.noFocus=!0)}},{key:"onMove",value:function(e){var t=this;clearTimeout(this.timeoutTimer),this.noFocus=!1,this.timeoutTimer=setTimeout((function(){t.onTimeout()}),this.timeoutTime)}},{key:"booleanState",value:function(e){var t=localStorage.getItem(e);return!(!t||"true"!==t)}}]),e}(),qe.ngComponentDef=s.Lb({type:qe,selectors:[["ng-component"]],factory:function(e){return new(e||qe)(s.Rb(h.a),s.Rb(d.a),s.Rb(l.a),s.Rb(r.c),s.Rb(g.a),s.Rb(u.a),s.Rb(m.a))},hostBindings:function(e,t,i){1&e&&s.bc("mousemove",(function(e){return t.onMove(e)}))},consts:2,vars:2,template:function(e,t){1&e&&(s.Hc(0,xe,43,27,"div",v),s.Hc(1,We,22,0,"div",f)),2&e&&(s.mc("ngIf",t.track),s.Ac(1),s.mc("ngIf",!t.track))},directives:[n.l,n.j,a.l,a.a,a.f,a.i,b.a,n.m,r.d],pipes:[p.a],encapsulation:2}),qe)}],Re=((Fe=function e(){_classCallCheck(this,e)}).ngModuleDef=s.Pb({type:Fe}),Fe.ngInjectorDef=s.Ob({factory:function(e){return new(e||Fe)},imports:[[r.e.forChild(He)],r.e]}),Fe.ngLocaleIdDef="en-GB",Fe);r.e.forChild(He),i.d(t,"NowPlayingModule",(function(){return Xe}));var _e,Xe=((_e=function e(){_classCallCheck(this,e)}).ngModuleDef=s.Pb({type:_e}),_e.ngInjectorDef=s.Ob({factory:function(e){return new(e||_e)},imports:[[n.c,Re,o.a,a.b]]}),_e.ngLocaleIdDef="en-GB",_e)}}]);