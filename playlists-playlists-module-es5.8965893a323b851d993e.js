function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,i){for(var a=0;a<i.length;a++){var s=i[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function _createClass(t,i,a){return i&&_defineProperties(t.prototype,i),a&&_defineProperties(t,a),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{kez3:function(t,i,a){"use strict";a.r(i);var s=a("ofXK"),r=a("3Pt+"),n=a("hDf6"),e=a("tyNb"),l=a("ufXC"),c=a("OgP6"),o=a("ktVm"),b=a("t083"),u=a("XtVx"),f=a("KI15"),p=a("Gcu2"),g=a("fXoL"),h=a("Oz9T");function y(t,i){if(1&t){var a=g.Pb();g.Ob(0,"li",6),g.Ob(1,"a",8),g.Wb("click",(function(t){return g.rc(a),g.ac().setPlaylist("current")})),g.zc(2,"Current playlist"),g.Nb(),g.Nb()}}function d(t,i){if(1&t){var a=g.Pb();g.Ob(0,"a",8),g.Wb("click",(function(t){return g.rc(a),g.ac().setPlaylist("last.fm")})),g.zc(1,"Loved tracks on last.fm"),g.Nb()}}function m(t,i){if(1&t){var a=g.Pb();g.Ob(0,"a",8),g.Wb("click",(function(t){return g.rc(a),g.ac().setPlaylist("radio")})),g.zc(1),g.Nb()}if(2&t){var s=g.ac();g.zb(1),g.Bc("",s.playlistService.numberOfTracksInAPlaylist," tracks by preference")}}function v(t,i){if(1&t){var a=g.Pb();g.Ob(0,"li",6),g.Ob(1,"a",11),g.Wb("click",(function(t){g.rc(a);var s=i.$implicit;return g.ac().setPlaylist(s)})),g.zc(2),g.Ob(3,"a",11),g.Wb("click",(function(t){g.rc(a);var s=i.$implicit;return g.ac().removePlaylist(s)})),g.Mb(4,"span",12),g.Nb(),g.Nb(),g.Nb()}if(2&t){var s=i.$implicit;g.zb(2),g.Bc("",s.name," ")}}function k(t,i){if(1&t&&(g.Ob(0,"p",17),g.zc(1),g.Nb()),2&t){var a=g.ac(2);g.zb(1),g.Bc("Tracks found: ",a.playlist.tracks.length,"")}}function O(t,i){if(1&t&&(g.Ob(0,"div",13),g.Mb(1,"br"),g.xc(2,k,2,1,"p",14),g.Ob(3,"div",15),g.Mb(4,"div",16),g.Mb(5,"div",16),g.Mb(6,"div",16),g.Mb(7,"div",16),g.Mb(8,"div",16),g.Nb(),g.Nb()),2&t){var a=g.ac();g.zb(2),g.gc("ngIf",a.playlist&&a.playlist.tracks&&a.playlist.tracks.length>0)}}function N(t,i){if(1&t){var a=g.Pb();g.Ob(0,"a",11),g.Wb("click",(function(t){g.rc(a);var i=g.ac(2);return i.updatePlaylist(i.playlist)})),g.Mb(1,"span",22),g.Nb()}}function z(t,i){if(1&t){var a=g.Pb();g.Ob(0,"a",11),g.Wb("click",(function(t){g.rc(a);var i=g.ac(2);return i.removePlaylist(i.playlist)})),g.Mb(1,"span",23),g.Nb()}}function P(t,i){if(1&t&&g.Mb(0,"mdb-tracklist",25),2&t){var a=g.ac(3);g.gc("playlist",a.playlist)}}function I(t,i){if(1&t&&(g.Ob(0,"div",0),g.xc(1,P,1,1,"mdb-tracklist",24),g.Nb()),2&t){var a=g.ac(2);g.zb(1),g.gc("ngIf",!a.loading)}}function S(t,i){1&t&&(g.Ob(0,"div",0),g.Ob(1,"div",2),g.Ob(2,"div",26),g.Ob(3,"p"),g.zc(4," Unfortunately this playlist is empty :( "),g.Mb(5,"br"),g.zc(6,"Find some tracks from an "),g.Ob(7,"a",27),g.Mb(8,"span",28),g.zc(9," artist"),g.Nb(),g.zc(10,", "),g.Ob(11,"a",29),g.Mb(12,"span",30),g.zc(13," album"),g.Nb(),g.zc(14," or a "),g.Ob(15,"a",31),g.Mb(16,"span",32),g.zc(17," year"),g.Nb(),g.Nb(),g.Nb(),g.Nb(),g.Nb())}function w(t,i){if(1&t&&(g.Ob(0,"div",13),g.Ob(1,"h4",18),g.zc(2),g.Ob(3,"span",19),g.zc(4),g.Nb(),g.zc(5," \xa0 "),g.xc(6,N,2,0,"a",20),g.zc(7," \xa0 "),g.xc(8,z,2,0,"a",20),g.Nb(),g.xc(9,I,2,1,"div",21),g.xc(10,S,18,0,"div",21),g.Nb()),2&t){var a=g.ac();g.zb(2),g.Bc(" ",a.playlist.name," "),g.zb(2),g.Bc("(",a.playlist.tracks.length,")"),g.zb(2),g.gc("ngIf",a.playlist.isOwn),g.zb(2),g.gc("ngIf",a.playlist.isOwn),g.zb(1),g.gc("ngIf",a.playlist&&a.playlist.tracks&&0!==a.playlist.tracks.length),g.zb(1),g.gc("ngIf",a.playlist&&a.playlist.tracks&&0===a.playlist.tracks.length)}}function x(t,i){if(1&t&&(g.Ob(0,"option"),g.zc(1),g.Nb()),2&t){var a=i.$implicit;g.zb(1),g.Ac(a.name)}}var A=function(t){return{"theme-alt":t}};function C(t,i){if(1&t){var a=g.Pb();g.Ob(0,"div",13),g.Ob(1,"h4",33),g.zc(2," Select an artist as starting point "),g.Nb(),g.Ob(3,"form",34,35),g.Ob(5,"div",36),g.Ob(6,"label",37),g.zc(7,"Select an artist"),g.Nb(),g.Ob(8,"div",38),g.Ob(9,"select",39,40),g.Wb("ngModelChange",(function(t){return g.rc(a),g.ac().startingArtistName=t}))("ngModelChange",(function(t){return g.rc(a),g.ac().onChange(t)})),g.xc(11,x,2,1,"option",41),g.Nb(),g.Nb(),g.Nb(),g.Nb(),g.Nb()}if(2&t){var s=g.ac();g.zb(3),g.gc("ngClass",g.jc(3,A,"dark"===s.theme)),g.zb(6),g.gc("ngModel",s.startingArtistName),g.zb(2),g.gc("ngForOf",s.artists)}}var M,L,T=[{path:"",component:(M=function(){function t(i,a,s,r,n,e,l){var c=this;_classCallCheck(this,t),this.pathService=i,this.coreService=a,this.router=s,this.playerService=r,this.lastfmservice=n,this.configService=e,this.playlistService=l,this.loading=!1,this.username=localStorage.getItem("lastfm-username"),this.showStartingArtist=!1,this.ownPlaylists=[],this.artists=[];var o=this.playerService.getCurrentPlaylist();o&&(this.currentPlaylist=o.playlist,this.trackIndex=o.startIndex,this.setTrack()),this.subscription=this.playerService.playlistAnnounced$.subscribe((function(t){c.currentPlaylist=t.playlist,c.trackIndex=t.startIndex,c.setTrack()})),this.core=this.coreService.getCore(),this.subscription2=this.core.coreParsed$.subscribe((function(t){c.ngOnInit()})),this.theme=e.mode,this.newPlaylist=new f.a}return _createClass(t,[{key:"setTrack",value:function(){this.track=this.currentPlaylist.tracks[this.trackIndex],this.track&&(this.track.position=0)}},{key:"ngOnInit",value:function(){var t=this;if(this.pathService.announcePage("Playlists"),this.artists=this.core.artistsList(),this.ownPlaylists=[],localStorage.getItem("customlisttest")){var i=JSON.parse(localStorage.getItem("customlisttest"));i&&i.forEach((function(i){var a=new f.a;a.name=i.name,a.isOwn=!0,i.tracks.forEach((function(i){var s=t.core.getTrackById(i);s&&s.title&&a.tracks.push(s)})),t.ownPlaylists.push(a)}))}}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe(),this.subscription2.unsubscribe()}},{key:"setPlaylist",value:function(t){var i=this;this.loading=!0,this.showStartingArtist=!1,"current"===t?(this.playlist=this.currentPlaylist,this.loading=!1):"last.fm"===t?this.lastfmservice.getLovedTracks(this.username).subscribe((function(t){i.playlist=i.playlistService.extractTracks(t.lovedtracks.track),i.loading=!1})):"random"===t?(this.playlist=this.playlistService.generateRandom(),this.playlist.isContinues=!0,this.playlist.type=t,this.loading=!1):"radio"===t?this.playlist=this.generateRadio():"artist"===t?this.askForStartingArtist():t instanceof f.a?(this.playlist=t,this.loading=!1):console.info("unknown playlist",t)}},{key:"generateRadio",value:function(){var t=this;this.lastfmservice.getTopArtists(this.username).subscribe((function(i){t.playlist=t.playlistService.extractArtists(i=i.topartists.artist),t.playlist.isContinues=!0,t.playlist.type="radio",t.loading=!1}))}},{key:"onChange",value:function(){var t=this.core.getArtistByName(this.startingArtistName),i=new f.a;i.name="Artist radio for ".concat(t.name),i.tracks=[this.playlistService.getRandomTrackFromList([t])],this.showStartingArtist=!1,this.playlist=i,this.getNextSimilairArtist(t,this.playlist)}},{key:"getNextSimilairArtist",value:function(t,i){var a=this;this.loading=!0,this.lastfmservice.getSimilairArtists(t).subscribe((function(t){t=t.similarartists.artist,a.loading=!1;var s=[];if(t.forEach((function(t){var i=a.core.getArtistByName(t.name);i&&s.push(i)})),s.length>0){var r=a.playlistService.getNextTrackForPlaylist(s,i);r&&i.tracks.length<a.playlistService.numberOfTracksInAPlaylist&&(i.tracks.push(r),a.getNextSimilairArtist(r.artist,i))}}))}},{key:"askForStartingArtist",value:function(){this.loading=!1,this.playlist=null,this.showStartingArtist=!0}}]),t}(),M.\u0275fac=function(t){return new(t||M)(g.Lb(u.a),g.Lb(o.a),g.Lb(e.c),g.Lb(l.a),g.Lb(b.a),g.Lb(c.a),g.Lb(p.a))},M.\u0275cmp=g.Fb({type:M,selectors:[["app-playlists"]],decls:22,vars:8,consts:[[1,"animated-page"],[1,"container"],[1,"row"],[1,"col-12","col-lg-3","playlists-lg-fixed"],[1,"nav","flex-column"],["class","nav-item",4,"ngIf"],[1,"nav-item"],["class","btn btn-link px-0",3,"click",4,"ngIf"],[1,"btn","btn-link","px-0",3,"click"],["class","nav-item",4,"ngFor","ngForOf"],["class","col-12 col-lg-9 offset-lg-3",4,"ngIf"],[3,"click"],[1,"glyph","glyph-delete"],[1,"col-12","col-lg-9","offset-lg-3"],["class","small muted",4,"ngIf"],[1,"progress-bar"],[1,"progress-circle"],[1,"small","muted"],[1,"playlists-header"],[1,"small","muted","color-type-secondary"],[3,"click",4,"ngIf"],["class","animated-page",4,"ngIf"],[1,"glyph","glyph-edit","small"],[1,"glyph","glyph-delete","small"],[3,"playlist",4,"ngIf"],[3,"playlist"],[1,"col"],["routerLink","/artists"],[1,"glyph","glyph-people"],["routerLink","/albums"],[1,"glyph","glyph-music-album"],["routerLink","/years"],[1,"glyph","glyph-calendar"],["sticky","",1,"header-seperator"],["role","form",3,"ngClass"],["sortForm","ngForm"],[1,"form-group","row"],["for","sort",1,"col-12","col-sm-3","col-form-label"],[1,"col","col-sm-9"],["name","sort","id","sort",1,"form-control",3,"ngModel","ngModelChange"],["name","ngModel"],[4,"ngFor","ngForOf"]],template:function(t,i){1&t&&(g.Ob(0,"div",0),g.Ob(1,"div",1),g.Ob(2,"div",2),g.Ob(3,"div",3),g.Ob(4,"h4"),g.zc(5,"Playlists"),g.Nb(),g.Ob(6,"ul",4),g.xc(7,y,3,0,"li",5),g.Ob(8,"li",6),g.xc(9,d,2,0,"a",7),g.Nb(),g.Ob(10,"li",6),g.Ob(11,"a",8),g.Wb("click",(function(t){return i.setPlaylist("random")})),g.zc(12),g.Nb(),g.Nb(),g.Ob(13,"li",6),g.xc(14,m,2,1,"a",7),g.Nb(),g.Ob(15,"li",6),g.Ob(16,"a",8),g.Wb("click",(function(t){return i.setPlaylist("artist")})),g.zc(17,"Artist radio"),g.Nb(),g.Nb(),g.xc(18,v,5,1,"li",9),g.Nb(),g.Nb(),g.xc(19,O,9,1,"div",10),g.xc(20,w,11,6,"div",10),g.xc(21,C,12,5,"div",10),g.Nb(),g.Nb(),g.Nb()),2&t&&(g.zb(7),g.gc("ngIf",i.currentPlaylist),g.zb(2),g.gc("ngIf",i.username&&"mdb-skipped"!==i.username),g.zb(3),g.Bc("",i.playlistService.numberOfTracksInAPlaylist," random tracks"),g.zb(2),g.gc("ngIf",i.username&&"mdb-skipped"!==i.username),g.zb(4),g.gc("ngForOf",i.ownPlaylists),g.zb(1),g.gc("ngIf",i.loading),g.zb(1),g.gc("ngIf",i.playlist&&!i.loading&&!i.showStartingArtist),g.zb(1),g.gc("ngIf",i.showStartingArtist&&!i.loading&&!i.playlist))},directives:[s.l,s.k,h.a,e.d,r.p,r.g,r.h,s.j,r.n,r.f,r.i,r.j,r.o],encapsulation:2}),M)}],F=((L=function t(){_classCallCheck(this,t)}).\u0275mod=g.Jb({type:L}),L.\u0275inj=g.Ib({factory:function(t){return new(t||L)},imports:[[e.e.forChild(T)],e.e]}),L);a.d(i,"PlaylistsModule",(function(){return B}));var W,B=((W=function t(){_classCallCheck(this,t)}).\u0275mod=g.Jb({type:W}),W.\u0275inj=g.Ib({factory:function(t){return new(t||W)},imports:[[s.c,F,n.a,r.b]]}),W)}}]);