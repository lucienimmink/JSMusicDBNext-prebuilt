function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,i){for(var s=0;s<i.length;s++){var a=i[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function _createClass(t,i,s){return i&&_defineProperties(t.prototype,i),s&&_defineProperties(t,s),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{kez3:function(t,i,s){"use strict";s.r(i),s.d(i,"PlaylistsModule",(function(){return N}));var a=s("ofXK"),e=s("3Pt+"),l=s("hDf6"),n=s("tyNb"),r=s("ufXC"),c=s("OgP6"),o=s("ktVm"),b=s("t083"),p=s("XtVx"),u=s("KI15"),f=s("Gcu2"),h=s("fXoL"),y=s("Oz9T");function g(t,i){if(1&t){var s=h.Mb();h.Lb(0,"li",6),h.Lb(1,"a",8),h.Sb("click",(function(){return h.lc(s),h.Wb().setPlaylist("current")})),h.pc(2,"Current playlist"),h.Kb(),h.Kb()}}function d(t,i){if(1&t){var s=h.Mb();h.Lb(0,"a",8),h.Sb("click",(function(){return h.lc(s),h.Wb().setPlaylist("last.fm")})),h.pc(1,"Loved tracks on last.fm"),h.Kb()}}function m(t,i){if(1&t){var s=h.Mb();h.Lb(0,"a",8),h.Sb("click",(function(){return h.lc(s),h.Wb().setPlaylist("radio")})),h.pc(1),h.Kb()}if(2&t){var a=h.Wb();h.xb(1),h.rc("",a.playlistService.numberOfTracksInAPlaylist," tracks by preference")}}function v(t,i){if(1&t){var s=h.Mb();h.Lb(0,"li",6),h.Lb(1,"a",11),h.Sb("click",(function(){h.lc(s);var t=i.$implicit;return h.Wb().setPlaylist(t)})),h.pc(2),h.Lb(3,"a",11),h.Sb("click",(function(){h.lc(s);var t=i.$implicit;return h.Wb().removePlaylist(t)})),h.Jb(4,"span",12),h.Kb(),h.Kb(),h.Kb()}if(2&t){var a=i.$implicit;h.xb(2),h.rc("",a.name," ")}}function k(t,i){if(1&t&&(h.Lb(0,"p",17),h.pc(1),h.Kb()),2&t){var s=h.Wb(2);h.xb(1),h.rc("Tracks found: ",s.playlist.tracks.length,"")}}function L(t,i){if(1&t&&(h.Lb(0,"div",13),h.Jb(1,"br"),h.oc(2,k,2,1,"p",14),h.Lb(3,"div",15),h.Jb(4,"div",16),h.Jb(5,"div",16),h.Jb(6,"div",16),h.Jb(7,"div",16),h.Jb(8,"div",16),h.Kb(),h.Kb()),2&t){var s=h.Wb();h.xb(2),h.cc("ngIf",s.playlist&&s.playlist.tracks&&s.playlist.tracks.length>0)}}function K(t,i){if(1&t){var s=h.Mb();h.Lb(0,"a",11),h.Sb("click",(function(){h.lc(s);var t=h.Wb(2);return t.updatePlaylist(t.playlist)})),h.Jb(1,"span",22),h.Kb()}}function S(t,i){if(1&t){var s=h.Mb();h.Lb(0,"a",11),h.Sb("click",(function(){h.lc(s);var t=h.Wb(2);return t.removePlaylist(t.playlist)})),h.Jb(1,"span",23),h.Kb()}}function I(t,i){if(1&t&&h.Jb(0,"mdb-tracklist",25),2&t){var s=h.Wb(3);h.cc("playlist",s.playlist)}}function x(t,i){if(1&t&&(h.Lb(0,"div",0),h.oc(1,I,1,1,"mdb-tracklist",24),h.Kb()),2&t){var s=h.Wb(2);h.xb(1),h.cc("ngIf",!s.loading)}}function P(t,i){1&t&&(h.Lb(0,"div",0),h.Lb(1,"div",2),h.Lb(2,"div",26),h.Lb(3,"p"),h.pc(4," Unfortunately this playlist is empty :( "),h.Jb(5,"br"),h.pc(6,"Find some tracks from an "),h.Lb(7,"a",27),h.Jb(8,"span",28),h.pc(9," artist"),h.Kb(),h.pc(10,", "),h.Lb(11,"a",29),h.Jb(12,"span",30),h.pc(13," album"),h.Kb(),h.pc(14," or a "),h.Lb(15,"a",31),h.Jb(16,"span",32),h.pc(17," year"),h.Kb(),h.Kb(),h.Kb(),h.Kb(),h.Kb())}function w(t,i){if(1&t&&(h.Lb(0,"div",13),h.Lb(1,"h4",18),h.pc(2),h.Lb(3,"span",19),h.pc(4),h.Kb(),h.pc(5," \xa0 "),h.oc(6,K,2,0,"a",20),h.pc(7," \xa0 "),h.oc(8,S,2,0,"a",20),h.Kb(),h.oc(9,x,2,1,"div",21),h.oc(10,P,18,0,"div",21),h.Kb()),2&t){var s=h.Wb();h.xb(2),h.rc(" ",s.playlist.name," "),h.xb(2),h.rc("(",s.playlist.tracks.length,")"),h.xb(2),h.cc("ngIf",s.playlist.isOwn),h.xb(2),h.cc("ngIf",s.playlist.isOwn),h.xb(1),h.cc("ngIf",s.playlist&&s.playlist.tracks&&0!==s.playlist.tracks.length),h.xb(1),h.cc("ngIf",s.playlist&&s.playlist.tracks&&0===s.playlist.tracks.length)}}function C(t,i){if(1&t&&(h.Lb(0,"option"),h.pc(1),h.Kb()),2&t){var s=i.$implicit;h.xb(1),h.qc(s.name)}}var A=function(t){return{"theme-alt":t}};function J(t,i){if(1&t){var s=h.Mb();h.Lb(0,"div",13),h.Lb(1,"h4",33),h.pc(2," Select an artist as starting point "),h.Kb(),h.Lb(3,"form",34,35),h.Lb(5,"div",36),h.Lb(6,"label",37),h.pc(7,"Select an artist"),h.Kb(),h.Lb(8,"div",38),h.Lb(9,"select",39,40),h.Sb("ngModelChange",(function(t){return h.lc(s),h.Wb().startingArtistName=t}))("ngModelChange",(function(t){return h.lc(s),h.Wb().onChange(t)})),h.oc(11,C,2,1,"option",41),h.Kb(),h.Kb(),h.Kb(),h.Kb(),h.Kb()}if(2&t){var a=h.Wb();h.xb(3),h.cc("ngClass",h.fc(3,A,"dark"===a.theme)),h.xb(6),h.cc("ngModel",a.startingArtistName),h.xb(2),h.cc("ngForOf",a.artists)}}var O,W,F,T=[{path:"",component:(O=function(){function t(i,s,a,e,l,n,r){var c=this;_classCallCheck(this,t),this.pathService=i,this.coreService=s,this.router=a,this.playerService=e,this.lastfmservice=l,this.configService=n,this.playlistService=r,this.loading=!1,this.username=localStorage.getItem("lastfm-username"),this.showStartingArtist=!1,this.ownPlaylists=[],this.artists=[];var o=this.playerService.getCurrentPlaylist();o&&(this.currentPlaylist=o.playlist,this.trackIndex=o.startIndex,this.setTrack()),this.subscription=this.playerService.playlistAnnounced$.subscribe((function(t){c.currentPlaylist=t.playlist,c.trackIndex=t.startIndex,c.setTrack()})),this.core=this.coreService.getCore(),this.subscription2=this.core.coreParsed$.subscribe((function(t){c.ngOnInit()})),this.theme=n.mode,this.newPlaylist=new u.a}return _createClass(t,[{key:"setTrack",value:function(){this.track=this.currentPlaylist.tracks[this.trackIndex],this.track&&(this.track.position=0)}},{key:"ngOnInit",value:function(){var t=this;if(this.pathService.announcePage("Playlists"),this.artists=this.core.artistsList(),this.ownPlaylists=[],localStorage.getItem("customlisttest")){var i=JSON.parse(localStorage.getItem("customlisttest"));i&&i.forEach((function(i){var s=new u.a;s.name=i.name,s.isOwn=!0,i.tracks.forEach((function(i){var a=t.core.getTrackById(i);a&&a.title&&s.tracks.push(a)})),t.ownPlaylists.push(s)}))}}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe(),this.subscription2.unsubscribe()}},{key:"setPlaylist",value:function(t){var i=this;this.loading=!0,this.showStartingArtist=!1,"current"===t?(this.playlist=this.currentPlaylist,this.loading=!1):"last.fm"===t?this.lastfmservice.getLovedTracks(this.username).subscribe((function(t){i.playlist=i.playlistService.extractTracks(t.lovedtracks.track),i.loading=!1})):"random"===t?(this.playlist=this.playlistService.generateRandom(),this.playlist.isContinues=!0,this.playlist.type=t,this.loading=!1):"radio"===t?this.playlist=this.generateRadio():"artist"===t?this.askForStartingArtist():t instanceof u.a?(this.playlist=t,this.loading=!1):console.info("unknown playlist",t)}},{key:"generateRadio",value:function(){var t=this;this.lastfmservice.getTopArtists(this.username).subscribe((function(i){t.playlist=t.playlistService.extractArtists(i=i.topartists.artist),t.playlist.isContinues=!0,t.playlist.type="radio",t.loading=!1}))}},{key:"onChange",value:function(){var t=this.core.getArtistByName(this.startingArtistName),i=new u.a;i.name="Artist radio for "+t.name,i.tracks=[this.playlistService.getRandomTrackFromList([t])],this.showStartingArtist=!1,this.playlist=i,this.getNextSimilairArtist(t,this.playlist)}},{key:"getNextSimilairArtist",value:function(t,i){var s=this;this.loading=!0,this.lastfmservice.getSimilairArtists(t).subscribe((function(t){t=t.similarartists.artist,s.loading=!1;var a=[];if(t.forEach((function(t){var i=s.core.getArtistByName(t.name);i&&a.push(i)})),a.length>0){var e=s.playlistService.getNextTrackForPlaylist(a,i);e&&i.tracks.length<s.playlistService.numberOfTracksInAPlaylist&&(i.tracks.push(e),s.getNextSimilairArtist(e.artist,i))}}))}},{key:"askForStartingArtist",value:function(){this.loading=!1,this.playlist=null,this.showStartingArtist=!0}}]),t}(),O.\u0275fac=function(t){return new(t||O)(h.Ib(p.a),h.Ib(o.a),h.Ib(n.c),h.Ib(r.a),h.Ib(b.a),h.Ib(c.a),h.Ib(f.a))},O.\u0275cmp=h.Cb({type:O,selectors:[["app-playlists"]],decls:22,vars:8,consts:[[1,"animated-page"],[1,"container"],[1,"row"],[1,"col-12","col-lg-3","playlists-lg-fixed"],[1,"nav","flex-column"],["class","nav-item",4,"ngIf"],[1,"nav-item"],["class","btn btn-link px-0",3,"click",4,"ngIf"],[1,"btn","btn-link","px-0",3,"click"],["class","nav-item",4,"ngFor","ngForOf"],["class","col-12 col-lg-9 offset-lg-3",4,"ngIf"],[3,"click"],[1,"glyph","glyph-delete"],[1,"col-12","col-lg-9","offset-lg-3"],["class","small muted",4,"ngIf"],[1,"progress-bar"],[1,"progress-circle"],[1,"small","muted"],[1,"playlists-header"],[1,"small","muted","color-type-secondary"],[3,"click",4,"ngIf"],["class","animated-page",4,"ngIf"],[1,"glyph","glyph-edit","small"],[1,"glyph","glyph-delete","small"],[3,"playlist",4,"ngIf"],[3,"playlist"],[1,"col"],["routerLink","/artists"],[1,"glyph","glyph-people"],["routerLink","/albums"],[1,"glyph","glyph-music-album"],["routerLink","/years"],[1,"glyph","glyph-calendar"],["sticky","",1,"header-seperator"],["role","form",3,"ngClass"],["sortForm","ngForm"],[1,"form-group","row"],["for","sort",1,"col-12","col-sm-3","col-form-label"],[1,"col","col-sm-9"],["name","sort","id","sort",1,"form-control",3,"ngModel","ngModelChange"],["name","ngModel"],[4,"ngFor","ngForOf"]],template:function(t,i){1&t&&(h.Lb(0,"div",0),h.Lb(1,"div",1),h.Lb(2,"div",2),h.Lb(3,"div",3),h.Lb(4,"h4"),h.pc(5,"Playlists"),h.Kb(),h.Lb(6,"ul",4),h.oc(7,g,3,0,"li",5),h.Lb(8,"li",6),h.oc(9,d,2,0,"a",7),h.Kb(),h.Lb(10,"li",6),h.Lb(11,"a",8),h.Sb("click",(function(){return i.setPlaylist("random")})),h.pc(12),h.Kb(),h.Kb(),h.Lb(13,"li",6),h.oc(14,m,2,1,"a",7),h.Kb(),h.Lb(15,"li",6),h.Lb(16,"a",8),h.Sb("click",(function(){return i.setPlaylist("artist")})),h.pc(17,"Artist radio"),h.Kb(),h.Kb(),h.oc(18,v,5,1,"li",9),h.Kb(),h.Kb(),h.oc(19,L,9,1,"div",10),h.oc(20,w,11,6,"div",10),h.oc(21,J,12,5,"div",10),h.Kb(),h.Kb(),h.Kb()),2&t&&(h.xb(7),h.cc("ngIf",i.currentPlaylist),h.xb(2),h.cc("ngIf",i.username&&"mdb-skipped"!==i.username),h.xb(3),h.rc("",i.playlistService.numberOfTracksInAPlaylist," random tracks"),h.xb(2),h.cc("ngIf",i.username&&"mdb-skipped"!==i.username),h.xb(4),h.cc("ngForOf",i.ownPlaylists),h.xb(1),h.cc("ngIf",i.loading),h.xb(1),h.cc("ngIf",i.playlist&&!i.loading&&!i.showStartingArtist),h.xb(1),h.cc("ngIf",i.showStartingArtist&&!i.loading&&!i.playlist))},directives:[a.k,a.j,y.a,n.d,e.m,e.d,e.e,a.i,e.k,e.c,e.f,e.g,e.l],encapsulation:2}),O)}],M=((F=function t(){_classCallCheck(this,t)}).\u0275mod=h.Gb({type:F}),F.\u0275inj=h.Fb({factory:function(t){return new(t||F)},imports:[[n.e.forChild(T)],n.e]}),F),N=((W=function t(){_classCallCheck(this,t)}).\u0275mod=h.Gb({type:W}),W.\u0275inj=h.Fb({factory:function(t){return new(t||W)},imports:[[a.b,M,l.a,e.b]]}),W)}}]);