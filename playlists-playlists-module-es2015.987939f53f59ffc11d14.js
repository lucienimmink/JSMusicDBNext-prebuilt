(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{kez3:function(t,i,s){"use strict";s.r(i),s.d(i,"PlaylistsModule",(function(){return J}));var a=s("ofXK"),n=s("3Pt+"),l=s("hDf6"),e=s("tyNb"),c=s("ufXC"),r=s("OgP6"),o=s("ktVm"),b=s("t083"),h=s("XtVx"),p=s("KI15"),g=s("Gcu2"),u=s("fXoL"),y=s("Oz9T"),f=s("cpgm");function d(t,i){if(1&t){const t=u.Mb();u.Lb(0,"li",6),u.Lb(1,"a",8),u.Rb("click",(function(){return u.kc(t),u.Vb().setPlaylist("current")})),u.oc(2,"Current playlist"),u.Kb(),u.Kb()}}function m(t,i){if(1&t){const t=u.Mb();u.Lb(0,"a",8),u.Rb("click",(function(){return u.kc(t),u.Vb().setPlaylist("last.fm")})),u.oc(1,"Loved tracks on last.fm"),u.Kb()}}function k(t,i){if(1&t){const t=u.Mb();u.Lb(0,"a",8),u.Rb("click",(function(){return u.kc(t),u.Vb().setPlaylist("radio")})),u.oc(1),u.Kb()}if(2&t){const t=u.Vb();u.xb(1),u.qc("",t.playlistService.numberOfTracksInAPlaylist," tracks by preference")}}function L(t,i){if(1&t){const t=u.Mb();u.Lb(0,"li",6),u.Lb(1,"a",11),u.Rb("click",(function(){u.kc(t);const s=i.$implicit;return u.Vb().setPlaylist(s)})),u.oc(2),u.Lb(3,"a",11),u.Rb("click",(function(){u.kc(t);const s=i.$implicit;return u.Vb().removePlaylist(s)})),u.Jb(4,"span",12),u.Kb(),u.Kb(),u.Kb()}if(2&t){const t=i.$implicit;u.xb(2),u.qc("",t.name," ")}}function v(t,i){if(1&t&&(u.Lb(0,"p",17),u.oc(1),u.Kb()),2&t){const t=u.Vb(2);u.xb(1),u.qc("Tracks found: ",t.playlist.tracks.length,"")}}function K(t,i){if(1&t&&(u.Lb(0,"div",13),u.Jb(1,"br"),u.nc(2,v,2,1,"p",14),u.Lb(3,"div",15),u.Jb(4,"div",16),u.Jb(5,"div",16),u.Jb(6,"div",16),u.Jb(7,"div",16),u.Jb(8,"div",16),u.Kb(),u.Kb()),2&t){const t=u.Vb();u.xb(2),u.bc("ngIf",t.playlist&&t.playlist.tracks&&t.playlist.tracks.length>0)}}function x(t,i){if(1&t&&u.Jb(0,"mdb-tracklist",22),2&t){const t=u.Vb(3);u.bc("playlist",t.playlist)}}function I(t,i){if(1&t&&(u.Lb(0,"div",0),u.nc(1,x,1,1,"mdb-tracklist",21),u.Kb()),2&t){const t=u.Vb(2);u.xb(1),u.bc("ngIf",!t.loading)}}function S(t,i){1&t&&(u.Lb(0,"div",0),u.Lb(1,"div",2),u.Lb(2,"div",23),u.Lb(3,"p"),u.oc(4," Unfortunately this playlist is empty :( "),u.Jb(5,"br"),u.oc(6,"Find some tracks from an "),u.Lb(7,"a",24),u.Jb(8,"span",25),u.oc(9," artist"),u.Kb(),u.oc(10,", "),u.Lb(11,"a",26),u.Jb(12,"span",27),u.oc(13," album"),u.Kb(),u.oc(14," or a "),u.Lb(15,"a",28),u.Jb(16,"span",29),u.oc(17," year"),u.Kb(),u.Kb(),u.Kb(),u.Kb(),u.Kb())}function P(t,i){if(1&t&&(u.Lb(0,"div",13),u.Lb(1,"h4",18),u.oc(2),u.Lb(3,"span",19),u.oc(4),u.Wb(5,"timeFormat"),u.Kb(),u.Kb(),u.nc(6,I,2,1,"div",20),u.nc(7,S,18,0,"div",20),u.Kb()),2&t){const t=u.Vb();u.xb(2),u.qc(" ",t.playlist.name," "),u.xb(2),u.rc("(",t.playlist.tracks.length," / ",u.Xb(5,5,t.playlistLength)," )"),u.xb(2),u.bc("ngIf",t.playlist&&t.playlist.tracks&&0!==t.playlist.tracks.length),u.xb(1),u.bc("ngIf",t.playlist&&t.playlist.tracks&&0===t.playlist.tracks.length)}}function A(t,i){if(1&t&&(u.Lb(0,"option"),u.oc(1),u.Kb()),2&t){const t=i.$implicit;u.xb(1),u.pc(t.name)}}const w=function(t){return{"theme-alt":t}};function F(t,i){if(1&t){const t=u.Mb();u.Lb(0,"div",13),u.Lb(1,"h4",30),u.oc(2," Select an artist as starting point "),u.Kb(),u.Lb(3,"form",31,32),u.Lb(5,"div",33),u.Lb(6,"label",34),u.oc(7,"Select an artist"),u.Kb(),u.Lb(8,"div",35),u.Lb(9,"select",36,37),u.Rb("ngModelChange",(function(i){return u.kc(t),u.Vb().startingArtistName=i}))("ngModelChange",(function(i){return u.kc(t),u.Vb().onChange(i)})),u.nc(11,A,2,1,"option",38),u.Kb(),u.Kb(),u.Kb(),u.Kb(),u.Kb()}if(2&t){const t=u.Vb();u.xb(3),u.bc("ngClass",u.ec(3,w,"dark"===t.theme)),u.xb(6),u.bc("ngModel",t.startingArtistName),u.xb(2),u.bc("ngForOf",t.artists)}}const V=[{path:"",component:(()=>{class t{constructor(t,i,s,a,n,l,e){this.pathService=t,this.coreService=i,this.router=s,this.playerService=a,this.lastfmservice=n,this.configService=l,this.playlistService=e,this.playlistLength=0,this.loading=!1,this.username=localStorage.getItem("lastfm-username"),this.showStartingArtist=!1,this.ownPlaylists=[],this.artists=[];const c=this.playerService.getCurrentPlaylist();c&&(this.currentPlaylist=c.playlist,this.trackIndex=c.startIndex,this.setTrack()),this.subscription=this.playerService.playlistAnnounced$.subscribe(t=>{this.currentPlaylist=t.playlist,this.trackIndex=t.startIndex,this.setTrack()}),this.core=this.coreService.getCore(),this.subscription2=this.core.coreParsed$.subscribe(t=>{this.ngOnInit()}),this.theme=l.mode,this.newPlaylist=new p.a}setTrack(){this.track=this.currentPlaylist.tracks[this.trackIndex],this.track&&(this.track.position=0)}ngOnInit(){this.pathService.announcePage("Playlists"),this.artists=this.core.artistsList(),this.ownPlaylists=[]}ngOnDestroy(){this.subscription.unsubscribe(),this.subscription2.unsubscribe()}setPlaylist(t){this.loading=!0,this.showStartingArtist=!1,"current"===t?(this.playlist=this.currentPlaylist,this.calculateLength(),this.loading=!1):"last.fm"===t?this.lastfmservice.getLovedTracks(this.username).subscribe(t=>{this.playlist=this.playlistService.extractTracks(t.lovedtracks.track),this.calculateLength(),this.loading=!1}):"random"===t?(this.playlist=this.playlistService.generateRandom(),this.playlist.isContinues=!0,this.playlist.type=t,this.calculateLength(),this.loading=!1):"radio"===t?this.playlist=this.generateRadio():"artist"===t?this.askForStartingArtist():t instanceof p.a?(this.playlist=t,this.calculateLength(),this.loading=!1):console.info("unknown playlist",t)}generateRadio(){this.lastfmservice.getTopArtists(this.username).subscribe(t=>{this.playlist=this.playlistService.extractArtists(t=t.topartists.artist),this.playlist.isContinues=!0,this.playlist.type="radio",this.calculateLength(),this.loading=!1})}onChange(){const t=this.core.getArtistByName(this.startingArtistName),i=new p.a;i.name="Artist radio for "+t.name,i.tracks=[this.playlistService.getRandomTrackFromList([t])],this.showStartingArtist=!1,this.playlist=i,this.getNextSimilairArtist(t,this.playlist)}getNextSimilairArtist(t,i){this.loading=!0,this.lastfmservice.getSimilairArtists(t).subscribe(t=>{t=t.similarartists.artist,this.loading=!1;const s=[];if(t.forEach(t=>{const i=this.core.getArtistByName(t.name);i&&s.push(i)}),s.length>0){const t=this.playlistService.getNextTrackForPlaylist(s,i);t&&i.tracks.length<this.playlistService.numberOfTracksInAPlaylist&&(i.tracks.push(t),this.getNextSimilairArtist(t.artist,i))}this.calculateLength()})}askForStartingArtist(){this.loading=!1,this.playlist=null,this.showStartingArtist=!0}calculateLength(){this.playlistLength=0,this.playlist.tracks.forEach(t=>{this.playlistLength+=t.duration})}}return t.\u0275fac=function(i){return new(i||t)(u.Ib(h.a),u.Ib(o.a),u.Ib(e.c),u.Ib(c.a),u.Ib(b.a),u.Ib(r.a),u.Ib(g.a))},t.\u0275cmp=u.Cb({type:t,selectors:[["app-playlists"]],decls:22,vars:8,consts:[[1,"animated-page"],[1,"container"],[1,"row"],[1,"col-12","col-lg-3","playlists-lg-fixed"],[1,"nav","flex-column"],["class","nav-item",4,"ngIf"],[1,"nav-item"],["class","btn btn-link px-0",3,"click",4,"ngIf"],[1,"btn","btn-link","px-0",3,"click"],["class","nav-item",4,"ngFor","ngForOf"],["class","col-12 col-lg-9 offset-lg-3",4,"ngIf"],[3,"click"],[1,"glyph","glyph-delete"],[1,"col-12","col-lg-9","offset-lg-3"],["class","small muted",4,"ngIf"],[1,"progress-bar"],[1,"progress-circle"],[1,"small","muted"],[1,"playlists-header"],[1,"small","muted","color-type-secondary"],["class","animated-page",4,"ngIf"],[3,"playlist",4,"ngIf"],[3,"playlist"],[1,"col"],["routerLink","/artists"],[1,"glyph","glyph-people"],["routerLink","/albums"],[1,"glyph","glyph-music-album"],["routerLink","/years"],[1,"glyph","glyph-calendar"],["sticky","",1,"header-seperator"],["role","form",3,"ngClass"],["sortForm","ngForm"],[1,"form-group","row"],["for","sort",1,"col-12","col-sm-3","col-form-label"],[1,"col","col-sm-9"],["name","sort","id","sort",1,"form-control",3,"ngModel","ngModelChange"],["name","ngModel"],[4,"ngFor","ngForOf"]],template:function(t,i){1&t&&(u.Lb(0,"div",0),u.Lb(1,"div",1),u.Lb(2,"div",2),u.Lb(3,"div",3),u.Lb(4,"h4"),u.oc(5,"Playlists"),u.Kb(),u.Lb(6,"ul",4),u.nc(7,d,3,0,"li",5),u.Lb(8,"li",6),u.nc(9,m,2,0,"a",7),u.Kb(),u.Lb(10,"li",6),u.Lb(11,"a",8),u.Rb("click",(function(){return i.setPlaylist("random")})),u.oc(12),u.Kb(),u.Kb(),u.Lb(13,"li",6),u.nc(14,k,2,1,"a",7),u.Kb(),u.Lb(15,"li",6),u.Lb(16,"a",8),u.Rb("click",(function(){return i.setPlaylist("artist")})),u.oc(17,"Artist radio"),u.Kb(),u.Kb(),u.nc(18,L,5,1,"li",9),u.Kb(),u.Kb(),u.nc(19,K,9,1,"div",10),u.nc(20,P,8,7,"div",10),u.nc(21,F,12,5,"div",10),u.Kb(),u.Kb(),u.Kb()),2&t&&(u.xb(7),u.bc("ngIf",i.currentPlaylist),u.xb(2),u.bc("ngIf",i.username&&"mdb-skipped"!==i.username),u.xb(3),u.qc("",i.playlistService.numberOfTracksInAPlaylist," random tracks"),u.xb(2),u.bc("ngIf",i.username&&"mdb-skipped"!==i.username),u.xb(4),u.bc("ngForOf",i.ownPlaylists),u.xb(1),u.bc("ngIf",i.loading),u.xb(1),u.bc("ngIf",i.playlist&&!i.loading&&!i.showStartingArtist),u.xb(1),u.bc("ngIf",i.showStartingArtist&&!i.loading&&!i.playlist))},directives:[a.k,a.j,y.a,e.d,n.m,n.d,n.e,a.i,n.k,n.c,n.f,n.g,n.l],pipes:[f.a],encapsulation:2}),t})()}];let C=(()=>{class t{}return t.\u0275mod=u.Gb({type:t}),t.\u0275inj=u.Fb({factory:function(i){return new(i||t)},imports:[[e.e.forChild(V)],e.e]}),t})(),J=(()=>{class t{}return t.\u0275mod=u.Gb({type:t}),t.\u0275inj=u.Fb({factory:function(i){return new(i||t)},imports:[[a.b,C,l.a,n.b]]}),t})()}}]);