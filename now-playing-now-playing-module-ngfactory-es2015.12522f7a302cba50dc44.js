(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"0/mZ":function(l,n,t){"use strict";t.d(n,"a",function(){return i});var e=t("ztCj"),u=(t("xOws"),function(l,n,t,e){return new(t||(t=Promise))(function(u,i){function s(l){try{o(e.next(l))}catch(n){i(n)}}function a(l){try{o(e.throw(l))}catch(n){i(n)}}function o(l){l.done?u(l.value):new t(function(n){n(l.value)}).then(s,a)}o((e=e.apply(l,n||[])).next())})});class i{constructor(l,n){this.backgroundArtService=n,this.NOIMAGE="global/images/no-cover.png",this.loading=!1,this.loaded=!1,this.error=!1,this.loadingClass="loading",this.loadedClass="loaded",this.errorClass="error",this.el=l.nativeElement,setTimeout(()=>{this.loadImage()},100)}loadImage(){if(!this.loaded&&!this.loading||this.hasClassName("always-replace")){this.loading=!0,this.addClassName(this.loadingClass);let l=`art-${this.media.name}`;this.media.artist&&!this.media.trackArtist?l=`art-${this.media.artist.name}-${this.media.name}`:this.media.trackArtist&&(l=`art-${this.media.trackArtist}-${this.media.album.name}`),Object(e.c)(l).then(l=>{l?this.setImage(l):this.backgroundArtService.getMediaArt(this.media).subscribe(l=>this.setImage(l),l=>{this.el.style.backgroundImage=`url(${this.NOIMAGE})`,this.error=!0,this.loading=!1,this.removeClassName(this.loadingClass),this.addClassName(this.errorClass)})})}}setImage(l){return u(this,void 0,void 0,function*(){let n=localStorage.getItem("dsm");if(n&&(n+="/data/image-proxy?url="),!this.loaded||this.hasClassName("always-replace")){if(l!==this.NOIMAGE&&""!==l&&l){this.el.style.backgroundImage=(l=yield this.backgroundArtService.returnImageUrlFromLastFMResponse(l))?`url(${l})`:`url(${this.NOIMAGE})`;const n={_id:`art-${this.media.name}`,url:l||this.NOIMAGE};this.media.artist&&(n._id=`art-${this.media.artist.name}-${this.media.name}`),Object(e.d)(n._id,n.url)}else this.backgroundArtService.getMediaArtFromLastFm(this.media).subscribe(l=>u(this,void 0,void 0,function*(){(l=yield this.backgroundArtService.returnImageUrlFromLastFMResponse(l))&&l!==this.NOIMAGE?this.el.style.backgroundImage=`url(${n}${encodeURIComponent(l)})`:(l||(l=this.NOIMAGE),this.el.style.backgroundImage=`url(${l})`);const t={_id:`art-${this.media.name}`,url:l||this.NOIMAGE};this.media.artist&&(t._id=`art-${this.media.artist.name}-${this.media.name}`),Object(e.d)(t._id,t.url)}),l=>this.el.style.backgroundImage=`url(${this.NOIMAGE})`);this.loading=!1,this.toggleLoaded(!0)}})}getPosition(){const l=this.el.getBoundingClientRect(),n=l.top+(window.pageYOffset-document.documentElement.clientTop);return{top:n,left:l.left+(window.pageXOffset-document.documentElement.clientLeft),bottom:n+this.el.clientHeight}}getLoadingContainer(){return this.el}hasClassName(l){return new RegExp("(?:^|\\s+)"+l+"(?:\\s+|$)").test(this.getLoadingContainer().className)}addClassName(l){if(!this.hasClassName(l)){const n=this.getLoadingContainer();n.className=n.className?[n.className,l].join(" "):l}}removeClassName(l){if(this.hasClassName(l)){const n=this.getLoadingContainer();n.className=n.className.replace(new RegExp("(?:^|\\s+)"+l+"(?:\\s+|$)","g"),"")}}toggleLoaded(l){this.loaded=l,l?(this.removeClassName(this.loadingClass),this.addClassName(this.loadedClass)):this.removeClassName(this.loadedClass)}}},wPTJ:function(l,n,t){"use strict";t.r(n);var e=t("8Y7J");class u{}var i=t("pMnS"),s=t("SVse"),a=t("xOws"),o=t("IheW"),r=t("0/mZ"),c=t("s7LF"),d=t("Z3YK"),h=t("Oz9T"),m=t("ufXC"),g=t("iInd"),b=t("cpgm"),p=t("z6cu"),v=t("1gFc"),y=t("ktVm"),f=t("t083"),k=t("XtVx");class I{constructor(l,n,t,e,u,i,s){this.pathService=l,this.coreService=n,this.playerService=t,this.router=e,this.lastFMService=u,this.animationService=i,this.http=s,this.previousTrack={},this.slided=!1,this.isPlaying=!1,this.isPaused=!1,this.isShuffled=!1,this.isDragging=!1,this.c=this,this.lastfmusername="",this.showVolumeWindow=!1,this.volume=100,this.showVisualisation=this.booleanState("visualisation-state"),this.preferVideo=this.booleanState("preferVideo-state"),this.smallArt=this.booleanState("small-art"),this.videoMode=!1,this.isEventBound=!1,this.noFocus=!1,this.timeoutTimer=null,this.timeoutTime=5e3,this.startDrag=l=>{this.isDragging=!0},this.drag=l=>{if(this.isDragging){const n=((l.clientX||l.changedTouches[0].clientX)-60)/document.getElementById("progress-pusher").clientWidth;n>=0&&n<=1&&this.setIndicatorPosition(n)}},this.stopDrag=l=>{if(this.isDragging){this.isDragging=!1;const n=((l.clientX||l.changedTouches[0].clientX)-60)/document.getElementById("progress-pusher").clientWidth;this.playerService.setPosition(this.track.duration/1e3*n)}};const a=this.playerService.getCurrentPlaylist();a&&(this.playlist=a.playlist,this.trackIndex=a.startIndex,this.isPaused=a.isPaused,this.isPlaying=a.isPlaying,this.isShuffled=a.isShuffled,this.volume=this.playerService.getVolume(),this.setTrack()),this.subscription=this.playerService.playlistAnnounced$.subscribe(l=>{this.playlist=l.playlist,this.trackIndex=l.startIndex,this.isPaused=l.isPaused,this.isPlaying=l.isPlaying,this.isShuffled=l.isShuffled,this.setTrack()}),this.subscription2=this.playerService.volumeAnnounced.subscribe(l=>{this.volume=l}),this.subscription3=this.playerService.hideVolumeWindowAnnounced$.subscribe(()=>{this.showVolumeWindow=!1}),this.pathService.announcePage("Now playing"),"ontouchstart"in document.documentElement?(document.getElementsByTagName("body")[0].addEventListener("touchmove",this.drag),document.getElementsByTagName("body")[0].addEventListener("touchend",this.stopDrag)):(document.getElementsByTagName("body")[0].addEventListener("mousemove",this.drag),document.getElementsByTagName("body")[0].addEventListener("mouseup",this.stopDrag)),this.timeoutTimer=setTimeout(()=>{this.onTimeout()},this.timeoutTime)}ngOnInit(){setTimeout(()=>{this.track&&("ontouchstart"in document.documentElement?document.getElementById("progress-pusher").addEventListener("touchstart",this.startDrag):document.getElementById("progress-pusher").addEventListener("mousedown",this.startDrag),this.isEventBound=!0)},250),this.lastfmusername=localStorage.getItem("lastfm-username")||""}setTrack(){setTimeout(()=>{this.albumart&&this.albumart.loadImage()}),this.track=this.playlist.tracks[this.trackIndex],this.currentTrack!==this.track&&(this.currentTrack=this.track,this.animationService.requestAnimation("enter",document.querySelector(".controls-wrapper h4")),this.animationService.requestAnimation("enter",document.querySelector(".controls-wrapper h5"))),this.isEventBound||setTimeout(()=>{try{"ontouchstart"in document.documentElement?document.getElementById("progress-pusher").addEventListener("touchstart",this.startDrag):document.getElementById("progress-pusher").addEventListener("mousedown",this.startDrag),this.isEventBound=!0}catch(l){console.error(l)}},250)}toggleSlide(){this.slided=!this.slided}ngOnDestroy(){this.subscription.unsubscribe(),this.subscription2.unsubscribe(),this.subscription3.unsubscribe(),"ontouchstart"in document.documentElement?(document.getElementsByTagName("body")[0].removeEventListener("touchmove",this.drag),document.getElementsByTagName("body")[0].removeEventListener("touchend",this.stopDrag)):(document.getElementsByTagName("body")[0].removeEventListener("mousemove",this.drag),document.getElementsByTagName("body")[0].removeEventListener("mouseup",this.stopDrag)),clearTimeout(this.timeoutTime)}navigateToArtist(){this.router.navigate(["/letter",this.track.album.artist.letter.escapedLetter,"artist",this.track.album.artist.sortName])}navigateToAlbum(){this.router.navigate(["/letter",this.track.album.artist.letter.escapedLetter,"artist",this.track.album.artist.sortName,"album",this.track.album.sortName])}next(){this.videoMode&&this.playerService.resume(),this.videoMode=!1,setTimeout(()=>{const l=document.querySelector(".previous-album-art");l.style.backgroundImage=document.querySelector(".current-album-art").style.backgroundImage,l.classList.remove("slideRightOut"),l.classList.remove("slideLeftOut"),this.animationService.requestAnimation("slideLeftOut",l,!1),this.trackIndex<this.playlist.tracks.length-1?(this.trackIndex++,this.playerService.next()):this.playlist.isContinues?(this.trackIndex=0,"random"===this.playlist.type||"radio"===this.playlist.type?this.playerService.nextPlaylist(this.playlist.type):this.playerService.nextAlbum(this.track.album)):this.playerService.stop()})}prev(){this.videoMode&&this.playerService.resume(),this.videoMode=!1,setTimeout(()=>{const l=document.querySelector(".previous-album-art");l.style.backgroundImage=document.querySelector(".current-album-art").style.backgroundImage,l.classList.remove("slideRightOut"),l.classList.remove("slideLeftOut"),this.animationService.requestAnimation("slideRightOut",l,!1),this.trackIndex>0&&(this.trackIndex--,this.playerService.prev())})}togglePlayPause(){this.videoMode?this.isPlaying?(this.player.pauseVideo(),this.isPlaying=!1,this.isPaused=!0):(this.player.playVideo(),this.isPlaying=!0,this.isPaused=!1):this.playerService.togglePlayPause()}toggleShuffle(){this.isShuffled=!this.isShuffled,this.playerService.shufflePlaylist(this.isShuffled)}toggleLoved(){this.track.isLoved=!this.track.isLoved,this.lastFMService.toggleLoved(this.track).subscribe(l=>{console.info(l)})}setIndicatorPosition(l){document.getElementById("position-indicator").style.marginLeft=100*l+"%"}toggleVolumeWindow(l){l.stopPropagation(),l.stopImmediatePropagation(),l.preventDefault(),this.showVolumeWindow=!this.showVolumeWindow}setVolume(){this.playerService.setVolume(this.volume)}round(l){return Math.floor(l)}handleError(l){return Object(p.a)("no video")}toggleVideo(){this.videoMode=!this.videoMode,this.videoMode?this.playerService.pause():this.playerService.togglePlayPause()}savePlayer(l){this.player=l,this.player.playVideo(),this.isPlaying=!0,this.isPaused=!1}onStateChange(l){0===l.data&&(this.videoMode=!1,this.next())}onTimeout(){this.slided||this.videoMode||(this.noFocus=!0)}onMove(l){clearTimeout(this.timeoutTimer),this.noFocus=!1,this.timeoutTimer=setTimeout(()=>{this.onTimeout()},this.timeoutTime)}booleanState(l){const n=localStorage.getItem(l);return!(!n||"true"!==n)}}var A=e.mb({encapsulation:2,styles:[],data:{}});function w(l){return e.Jb(0,[(l()(),e.ob(0,0,null,null,0,"canvas",[],null,null,null,null,null))],null,null)}function S(l){return e.Jb(0,[(l()(),e.ob(0,0,null,null,6,"div",[["class","image-wrapper"]],null,null,null,null,null)),(l()(),e.eb(16777216,null,null,1,null,w)),e.nb(2,16384,null,0,s.k,[e.M,e.J],{ngIf:[0,"ngIf"]},null),(l()(),e.ob(3,0,null,null,2,"div",[["class","current-album-art always-replace"]],null,[[null,"swipeleft"],[null,"swiperight"]],function(l,n,t){var e=!0,u=l.component;return"swipeleft"===n&&(e=!1!==u.next()&&e),"swiperight"===n&&(e=!1!==u.prev()&&e),e},null,null)),e.Eb(512,null,a.a,a.a,[o.c]),e.nb(5,16384,[[1,4]],0,r.a,[e.k,a.a],{media:[0,"media"]},null),(l()(),e.ob(6,0,null,null,0,"div",[["class","previous-album-art"]],null,[[null,"swipeleft"],[null,"swiperight"]],function(l,n,t){var e=!0,u=l.component;return"swipeleft"===n&&(e=!1!==u.next()&&e),"swiperight"===n&&(e=!1!==u.prev()&&e),e},null,null))],function(l,n){var t=n.component;l(n,2,0,t.showVisualisation),l(n,5,0,t.track)},null)}function C(l){return e.Jb(0,[(l()(),e.ob(0,0,null,null,15,"div",[["class","progress"]],null,null,null,null,null)),(l()(),e.ob(1,0,null,null,3,"div",[["class","progress-bar buffered-bar"],["role","progressbar"]],null,null,null,null,null)),e.Eb(512,null,s.w,s.x,[e.k,e.r,e.B]),e.nb(3,278528,null,0,s.n,[s.w],{ngStyle:[0,"ngStyle"]},null),e.Cb(4,{width:0}),(l()(),e.ob(5,0,null,null,3,"div",[["class","progress-bar"]],null,null,null,null,null)),e.Eb(512,null,s.w,s.x,[e.k,e.r,e.B]),e.nb(7,278528,null,0,s.n,[s.w],{ngStyle:[0,"ngStyle"]},null),e.Cb(8,{width:0}),(l()(),e.ob(9,0,null,null,6,"div",[["id","position-indicator"]],null,null,null,null,null)),e.Eb(512,null,s.u,s.v,[e.q,e.r,e.k,e.B]),e.nb(11,278528,null,0,s.i,[s.u],{ngClass:[0,"ngClass"]},null),e.Cb(12,{dragging:0}),e.Eb(512,null,s.w,s.x,[e.k,e.r,e.B]),e.nb(14,278528,null,0,s.n,[s.w],{ngStyle:[0,"ngStyle"]},null),e.Cb(15,{"margin-left":0})],function(l,n){var t=n.component,e=l(n,4,0,t.round(t.track.buffered.end/t.track.duration*100)+"%");l(n,3,0,e);var u=l(n,8,0,t.track.position/t.track.duration*100+"%");l(n,7,0,u);var i=l(n,12,0,t.isDragging);l(n,11,0,i);var s=l(n,15,0,t.track.position/t.track.duration*100+"%");l(n,14,0,s)},null)}function E(l){return e.Jb(0,[(l()(),e.ob(0,0,null,null,0,"div",[["id","progress-pusher"]],null,null,null,null,null))],null,null)}function M(l){return e.Jb(0,[(l()(),e.ob(0,0,null,null,2,"span",[["class","time start"]],null,null,null,null,null)),(l()(),e.Hb(1,null,["",""])),e.Db(2,1)],null,function(l,n){var t=n.component,u=e.Ib(n,1,0,l(n,2,0,e.Ab(n.parent.parent,0),t.track.position));l(n,1,0,u)})}function L(l){return e.Jb(0,[(l()(),e.ob(0,0,null,null,2,"span",[["class","time stop"]],null,null,null,null,null)),(l()(),e.Hb(1,null,["",""])),e.Db(2,1)],null,function(l,n){var t=n.component,u=e.Ib(n,1,0,l(n,2,0,e.Ab(n.parent.parent,0),t.track.duration));l(n,1,0,u)})}function T(l){return e.Jb(0,[(l()(),e.ob(0,0,null,null,0,"i",[["class","glyph glyph-pause"]],null,null,null,null,null))],null,null)}function P(l){return e.Jb(0,[(l()(),e.ob(0,0,null,null,0,"i",[["class","glyph glyph-play"]],null,null,null,null,null))],null,null)}function N(l){return e.Jb(0,[(l()(),e.ob(0,0,null,null,4,"button",[["class","btn btn-link btn-love"]],null,[[null,"click"]],function(l,n,t){var e=!0;return"click"===n&&(e=!1!==l.component.toggleLoved()&&e),e},null,null)),e.Eb(512,null,s.u,s.v,[e.q,e.r,e.k,e.B]),e.nb(2,278528,null,0,s.i,[s.u],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),e.Cb(3,{active:0}),(l()(),e.ob(4,0,null,null,0,"i",[["class","glyph glyph-star-outline"]],null,null,null,null,null))],function(l,n){var t=l(n,3,0,n.component.track.isLoved);l(n,2,0,"btn btn-link btn-love",t)},null)}function x(l){return e.Jb(0,[(l()(),e.ob(0,0,null,null,66,"div",[["class","container-fluid animated-page"],["id","nowPlaying"]],null,null,null,null,null)),e.Eb(512,null,s.u,s.v,[e.q,e.r,e.k,e.B]),e.nb(2,278528,null,0,s.i,[s.u],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),e.Cb(3,{slided:0,"small-art":1,"no-focus":2}),(l()(),e.ob(4,0,null,null,56,"div",[["class","top"]],null,null,null,null,null)),(l()(),e.eb(16777216,null,null,1,null,S)),e.nb(6,16384,null,0,s.k,[e.M,e.J],{ngIf:[0,"ngIf"]},null),(l()(),e.ob(7,0,null,null,53,"div",[["class","control-wrapper-wrapper"]],null,null,null,null,null)),(l()(),e.ob(8,0,null,null,18,"div",[["class","row controls-wrapper"]],null,null,null,null,null)),(l()(),e.eb(16777216,null,null,1,null,C)),e.nb(10,16384,null,0,s.k,[e.M,e.J],{ngIf:[0,"ngIf"]},null),(l()(),e.eb(16777216,null,null,1,null,E)),e.nb(12,16384,null,0,s.k,[e.M,e.J],{ngIf:[0,"ngIf"]},null),(l()(),e.eb(16777216,null,null,1,null,M)),e.nb(14,16384,null,0,s.k,[e.M,e.J],{ngIf:[0,"ngIf"]},null),(l()(),e.eb(16777216,null,null,1,null,L)),e.nb(16,16384,null,0,s.k,[e.M,e.J],{ngIf:[0,"ngIf"]},null),(l()(),e.ob(17,0,null,null,9,"div",[["class","track-info"]],null,null,null,null,null)),(l()(),e.ob(18,0,null,null,1,"h4",[],null,null,null,null,null)),(l()(),e.Hb(19,null,["",""])),(l()(),e.ob(20,0,null,null,6,"h5",[],null,null,null,null,null)),(l()(),e.ob(21,0,null,null,1,"a",[],null,[[null,"click"]],function(l,n,t){var e=!0;return"click"===n&&(e=!1!==l.component.navigateToArtist()&&e),e},null,null)),(l()(),e.Hb(22,null,["",""])),(l()(),e.ob(23,0,null,null,3,"span",[["class","hidden-xs color-type-secondary"]],null,null,null,null,null)),(l()(),e.Hb(-1,null,[" \u2022 "])),(l()(),e.ob(25,0,null,null,1,"a",[],null,[[null,"click"]],function(l,n,t){var e=!0;return"click"===n&&(e=!1!==l.component.navigateToAlbum()&&e),e},null,null)),(l()(),e.Hb(26,null,["",""])),(l()(),e.ob(27,0,null,null,33,"div",[["class","row icons"]],null,null,null,null,null)),(l()(),e.ob(28,0,null,null,21,"div",[["class","col-12"]],null,null,null,null,null)),(l()(),e.ob(29,0,null,null,1,"button",[["class","btn btn-link"]],null,[[null,"click"]],function(l,n,t){var e=!0;return"click"===n&&(e=!1!==l.component.prev()&&e),e},null,null)),(l()(),e.ob(30,0,null,null,0,"i",[["class","glyph glyph-previous"]],null,null,null,null,null)),(l()(),e.ob(31,0,null,null,4,"button",[["class","btn btn-link"]],null,[[null,"click"]],function(l,n,t){var e=!0;return"click"===n&&(e=!1!==l.component.togglePlayPause()&&e),e},null,null)),(l()(),e.eb(16777216,null,null,1,null,T)),e.nb(33,16384,null,0,s.k,[e.M,e.J],{ngIf:[0,"ngIf"]},null),(l()(),e.eb(16777216,null,null,1,null,P)),e.nb(35,16384,null,0,s.k,[e.M,e.J],{ngIf:[0,"ngIf"]},null),(l()(),e.ob(36,0,null,null,1,"button",[["class","btn btn-link"]],null,[[null,"click"]],function(l,n,t){var e=!0;return"click"===n&&(e=!1!==l.component.next()&&e),e},null,null)),(l()(),e.ob(37,0,null,null,0,"i",[["class","glyph glyph-next"]],null,null,null,null,null)),(l()(),e.eb(16777216,null,null,1,null,N)),e.nb(39,16384,null,0,s.k,[e.M,e.J],{ngIf:[0,"ngIf"]},null),(l()(),e.ob(40,0,null,null,4,"button",[["class","btn btn-link btn-volume d-none d-md-inline"]],[[8,"disabled",0]],[[null,"click"]],function(l,n,t){var e=!0;return"click"===n&&(e=!1!==l.component.toggleVolumeWindow(t)&&e),e},null,null)),(l()(),e.ob(41,0,null,null,3,"span",[["class","glyph"]],null,null,null,null,null)),e.Eb(512,null,s.u,s.v,[e.q,e.r,e.k,e.B]),e.nb(43,278528,null,0,s.i,[s.u],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),e.Cb(44,{"glyph-volume":0,"glyph-mute":1}),(l()(),e.ob(45,0,null,null,4,"button",[["class","btn btn-link d-none d-md-inline btn-shuffle"]],null,[[null,"click"]],function(l,n,t){var e=!0;return"click"===n&&(e=!1!==l.component.toggleShuffle()&&e),e},null,null)),e.Eb(512,null,s.u,s.v,[e.q,e.r,e.k,e.B]),e.nb(47,278528,null,0,s.i,[s.u],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),e.Cb(48,{active:0}),(l()(),e.ob(49,0,null,null,0,"i",[["class","glyph glyph-shuffle"]],null,null,null,null,null)),(l()(),e.ob(50,0,null,null,7,"div",[["class","volume-control"]],[[8,"hidden",0]],null,null,null,null)),(l()(),e.ob(51,0,null,null,6,"input",[["max","100"],["min","0"],["type","range"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"change"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],function(l,n,t){var u=!0,i=l.component;return"input"===n&&(u=!1!==e.Ab(l,52)._handleInput(t.target.value)&&u),"blur"===n&&(u=!1!==e.Ab(l,52).onTouched()&&u),"compositionstart"===n&&(u=!1!==e.Ab(l,52)._compositionStart()&&u),"compositionend"===n&&(u=!1!==e.Ab(l,52)._compositionEnd(t.target.value)&&u),"change"===n&&(u=!1!==e.Ab(l,53).onChange(t.target.value)&&u),"input"===n&&(u=!1!==e.Ab(l,53).onChange(t.target.value)&&u),"blur"===n&&(u=!1!==e.Ab(l,53).onTouched()&&u),"ngModelChange"===n&&(u=!1!==(i.volume=t)&&u),"input"===n&&(u=!1!==i.setVolume()&&u),"change"===n&&(u=!1!==i.setVolume()&&u),u},null,null)),e.nb(52,16384,null,0,c.c,[e.B,e.k,[2,c.a]],null,null),e.nb(53,16384,null,0,c.n,[e.B,e.k],null,null),e.Eb(1024,null,c.f,function(l,n){return[l,n]},[c.c,c.n]),e.nb(55,671744,null,0,c.k,[[8,null],[8,null],[8,null],[6,c.f]],{model:[0,"model"]},{update:"ngModelChange"}),e.Eb(2048,null,c.g,null,[c.k]),e.nb(57,16384,null,0,c.h,[[4,c.g]],null,null),(l()(),e.ob(58,0,null,null,2,"div",[["class","col-12"]],null,null,null,null,null)),(l()(),e.ob(59,0,null,null,1,"button",[["class","btn btn-link btn-updown"]],null,[[null,"click"]],function(l,n,t){var e=!0;return"click"===n&&(e=!1!==l.component.toggleSlide()&&e),e},null,null)),(l()(),e.ob(60,0,null,null,0,"i",[["class","glyph glyph-chevron-up"],["id","upordown"]],null,null,null,null,null)),(l()(),e.ob(61,0,null,null,5,"div",[["class","bottom "]],null,null,null,null,null)),(l()(),e.ob(62,0,null,null,4,"div",[["class","container"]],null,null,null,null,null)),(l()(),e.ob(63,0,null,null,3,"div",[["class","row"]],null,null,null,null,null)),(l()(),e.ob(64,0,null,null,2,"div",[["class","col-12"]],null,null,null,null,null)),(l()(),e.ob(65,0,null,null,1,"mdb-tracklist",[],null,null,null,d.b,d.a)),e.nb(66,49152,null,0,h.a,[m.a],{playlist:[0,"playlist"]},null)],function(l,n){var t=n.component,e=l(n,3,0,t.slided,t.smallArt,t.noFocus);l(n,2,0,"container-fluid animated-page",e),l(n,6,0,!t.videoMode),l(n,10,0,!t.videoMode),l(n,12,0,!t.videoMode),l(n,14,0,!t.videoMode),l(n,16,0,!t.videoMode),l(n,33,0,t.isPlaying),l(n,35,0,t.isPaused),l(n,39,0,"mdb-skipped"!==t.lastfmusername);var u=l(n,44,0,t.volume>0,0==t.volume);l(n,43,0,"glyph",u);var i=l(n,48,0,t.isShuffled);l(n,47,0,"btn btn-link d-none d-md-inline btn-shuffle",i),l(n,55,0,t.volume),l(n,66,0,t.playlist)},function(l,n){var t=n.component;l(n,19,0,t.track.title),l(n,22,0,t.track.trackArtist),l(n,26,0,t.track.album.name),l(n,40,0,t.videoMode),l(n,50,0,!t.showVolumeWindow),l(n,51,0,e.Ab(n,57).ngClassUntouched,e.Ab(n,57).ngClassTouched,e.Ab(n,57).ngClassPristine,e.Ab(n,57).ngClassDirty,e.Ab(n,57).ngClassValid,e.Ab(n,57).ngClassInvalid,e.Ab(n,57).ngClassPending)})}function B(l){return e.Jb(0,[(l()(),e.ob(0,0,null,null,24,"div",[["class","animated-page"]],null,null,null,null,null)),(l()(),e.ob(1,0,null,null,23,"div",[["class","jumbotron theme-light"]],null,null,null,null,null)),(l()(),e.ob(2,0,null,null,22,"div",[["class","container"]],null,null,null,null,null)),(l()(),e.ob(3,0,null,null,21,"div",[["class","row albumdetail"]],null,null,null,null,null)),(l()(),e.ob(4,0,null,null,20,"div",[["class","col-12"]],null,null,null,null,null)),(l()(),e.ob(5,0,null,null,1,"h3",[],null,null,null,null,null)),(l()(),e.Hb(-1,null,["Nothing is playing"])),(l()(),e.ob(7,0,null,null,1,"p",[],null,null,null,null,null)),(l()(),e.Hb(-1,null,[" This is where you'll see the song you're playing and songs that are coming up. "])),(l()(),e.ob(9,0,null,null,15,"p",[],null,null,null,null,null)),(l()(),e.Hb(-1,null,[" Find an "])),(l()(),e.ob(11,0,null,null,3,"a",[["routerLink","/artists"]],[[1,"target",0],[8,"href",4]],[[null,"click"]],function(l,n,t){var u=!0;return"click"===n&&(u=!1!==e.Ab(l,12).onClick(t.button,t.ctrlKey,t.metaKey,t.shiftKey)&&u),u},null,null)),e.nb(12,671744,null,0,g.l,[g.k,g.a,s.h],{routerLink:[0,"routerLink"]},null),(l()(),e.ob(13,0,null,null,0,"span",[["class","glyph glyph-people"]],null,null,null,null,null)),(l()(),e.Hb(-1,null,[" artist"])),(l()(),e.Hb(-1,null,[" or "])),(l()(),e.ob(16,0,null,null,3,"a",[["routerLink","/albums"]],[[1,"target",0],[8,"href",4]],[[null,"click"]],function(l,n,t){var u=!0;return"click"===n&&(u=!1!==e.Ab(l,17).onClick(t.button,t.ctrlKey,t.metaKey,t.shiftKey)&&u),u},null,null)),e.nb(17,671744,null,0,g.l,[g.k,g.a,s.h],{routerLink:[0,"routerLink"]},null),(l()(),e.ob(18,0,null,null,0,"span",[["class","glyph glyph-music-album"]],null,null,null,null,null)),(l()(),e.Hb(-1,null,[" album"])),(l()(),e.Hb(-1,null,[" that you want to play; or setup a "])),(l()(),e.ob(21,0,null,null,3,"a",[["routerLink","/playlists"]],[[1,"target",0],[8,"href",4]],[[null,"click"]],function(l,n,t){var u=!0;return"click"===n&&(u=!1!==e.Ab(l,22).onClick(t.button,t.ctrlKey,t.metaKey,t.shiftKey)&&u),u},null,null)),e.nb(22,671744,null,0,g.l,[g.k,g.a,s.h],{routerLink:[0,"routerLink"]},null),(l()(),e.ob(23,0,null,null,0,"span",[["class","glyph glyph-music-info"]],null,null,null,null,null)),(l()(),e.Hb(-1,null,[" playlist"]))],function(l,n){l(n,12,0,"/artists"),l(n,17,0,"/albums"),l(n,22,0,"/playlists")},function(l,n){l(n,11,0,e.Ab(n,12).target,e.Ab(n,12).href),l(n,16,0,e.Ab(n,17).target,e.Ab(n,17).href),l(n,21,0,e.Ab(n,22).target,e.Ab(n,22).href)})}function F(l){return e.Jb(0,[e.Bb(0,b.a,[]),e.Fb(671088640,1,{albumart:0}),(l()(),e.eb(16777216,null,null,1,null,x)),e.nb(3,16384,null,0,s.k,[e.M,e.J],{ngIf:[0,"ngIf"]},null),(l()(),e.eb(16777216,null,null,1,null,B)),e.nb(5,16384,null,0,s.k,[e.M,e.J],{ngIf:[0,"ngIf"]},null)],function(l,n){var t=n.component;l(n,3,0,t.track),l(n,5,0,!t.track)},null)}function J(l){return e.Jb(0,[(l()(),e.ob(0,0,null,null,1,"ng-component",[],null,[[null,"mousemove"]],function(l,n,t){var u=!0;return"mousemove"===n&&(u=!1!==e.Ab(l,1).onMove(t)&&u),u},F,A)),e.nb(1,245760,null,0,I,[k.a,y.a,m.a,g.k,f.a,v.a,o.c],null,null)],function(l,n){l(n,1,0)},null)}var O=e.kb("ng-component",I,J,{},{},[]);class V{}var $=t("hDf6");t.d(n,"NowPlayingModuleNgFactory",function(){return D});var D=e.lb(u,[],function(l){return e.xb([e.yb(512,e.j,e.X,[[8,[i.a,O]],[3,e.j],e.v]),e.yb(4608,s.m,s.l,[e.s,[2,s.z]]),e.yb(4608,c.r,c.r,[]),e.yb(1073742336,s.b,s.b,[]),e.yb(1073742336,g.m,g.m,[[2,g.r],[2,g.k]]),e.yb(1073742336,V,V,[]),e.yb(1073742336,$.a,$.a,[]),e.yb(1073742336,c.q,c.q,[]),e.yb(1073742336,c.d,c.d,[]),e.yb(1073742336,u,u,[]),e.yb(256,e.s,"en-GB",[]),e.yb(1024,g.i,function(){return[[{path:"",component:I}]]},[])])})},xOws:function(l,n,t){"use strict";t.d(n,"a",function(){return i});var e=t("XWo6"),u=function(l,n,t,e){return new(t||(t=Promise))(function(u,i){function s(l){try{o(e.next(l))}catch(n){i(n)}}function a(l){try{o(e.throw(l))}catch(n){i(n)}}function o(l){l.done?u(l.value):new t(function(n){n(l.value)}).then(s,a)}o((e=e.apply(l,n||[])).next())})};class i{constructor(l){this.http=l,this.API_KEY="639fca5adcf955a19f9a04f8985e9ded",this.lastFMImageRetriever=new e.a(l)}getMediaArt(l){const n=this.extractInfo(l);return this.lastFMImageRetriever.getMediaArt(n.artist,n.album,n.type)}getMediaArtFromLastFm(l){const n=this.extractInfo(l);return this.lastFMImageRetriever.getMediaArt(n.artist,n.album,n.type)}returnImageUrlFromLastFMResponse(l){return u(this,void 0,void 0,function*(){if(l.album)return l.album.image[l.album.image.length-1]["#text"];if(l.artist){const n=l.artist.mbid;return n?this.getArtistURLArtFormFanart(n,l.artist):l.artist.image[l.artist.image.length-1]["#text"]}return l})}getArtistURLArtFormFanart(l,n){return u(this,void 0,void 0,function*(){const t=yield fetch(`https://webservice.fanart.tv/v3/music/${l}&?api_key=${this.API_KEY}&format=json`);if(200===t.status){const l=yield t.json();if(l.artistbackground)return l.artistbackground[0].url}return this.getArtistURLArtFromAudioDB(n)})}getArtistURLArtFromAudioDB(l){return u(this,void 0,void 0,function*(){const n=yield fetch(`https://www.theaudiodb.com/api/v1/json/1/search.php?s=${encodeURIComponent(l.name)}`);if(200===n.status){const l=yield n.json();if(l&&l.artists)return l.artists[0].strArtistFanart}return l.image[l.image.length-1]["#text"]})}extractInfo(l){let n="",t="",e="artist";return l.trackArtist&&l.album.artist.isCollection?n=l.trackArtist:l.artist?(n=l.artist.albumArtist||l.artist.name,t=l.name||l.album.name,e="album"):n=l.albumArtist||l.name,{artist:n,album:t,type:e}}}}}]);