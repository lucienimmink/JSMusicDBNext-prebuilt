(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{YxDV:function(t,e,i){"use strict";i.r(e);var s=i("ofXK"),n=i("fXoL"),o=i("3Pt+"),c=i("hDf6"),r=i("tyNb"),a=i("z6cu"),l=(i("hR/0"),i("ufXC")),u=i("1gFc"),d=i("ktVm"),h=i("t083"),g=i("XtVx"),m=i("tk/3"),b=i("Oz9T"),p=i("cpgm");const v=["class","container-fluid animated-page","id","nowPlaying",3,"ngClass",4,"ngIf"],y=["class","animated-page",4,"ngIf"],f=["id","nowPlaying",1,"container-fluid","animated-page",3,"ngClass"],k=[1,"top"],T=["class","image-wrapper",4,"ngIf"],S=[1,"control-wrapper-wrapper"],V=[1,"row","controls-wrapper"],w=["class","progress",4,"ngIf"],I=["id","progress-pusher",4,"ngIf"],P=["class","time start",4,"ngIf"],A=["class","time stop",4,"ngIf"],x=[1,"track-info"],E=[3,"click"],L=[1,"hidden-xs","color-type-secondary"],M=[1,"row","icons"],D=[1,"col-12"],B=[1,"btn","btn-link",3,"click"],C=[1,"glyph","glyph-previous"],J=["class","glyph glyph-pause",4,"ngIf"],N=["class","glyph glyph-play",4,"ngIf"],W=[1,"glyph","glyph-next"],O=["class","btn btn-link btn-love",3,"ngClass","click",4,"ngIf"],q=[1,"btn","btn-link","btn-volume","d-none","d-md-inline",3,"disabled","click"],F=[1,"glyph",3,"ngClass"],H=[1,"btn","btn-link","d-none","d-md-inline","btn-shuffle",3,"ngClass","click"],R=[1,"glyph","glyph-shuffle"],X=[1,"volume-control",3,"hidden"],j=["type","range","min","0","max","100",3,"ngModel","ngModelChange","input","change"],K=[1,"btn","btn-link","btn-updown",3,"click"],z=["id","upordown",1,"glyph","glyph-chevron-up"],G=[1,"bottom"],$=[1,"container"],Y=[1,"row"],Q=[3,"playlist"],U=[1,"image-wrapper"],Z=[4,"ngIf"],_=[1,"current-album-art","always-replace",3,"swipeleft","swiperight"],tt=["objectFit","contain",3,"artist","album"],et=[1,"previous-album-art",3,"swipeleft","swiperight"];function it(t,e){1&t&&n.Sb(0,"canvas")}function st(t,e){if(1&t){const t=n.Wb();n.Vb(0,"div",U),n.Hc(1,it,1,0,"canvas",Z),n.Vb(2,"div",_),n.bc("swipeleft",(function(e){return n.xc(t),n.gc(2).next()})),n.bc("swiperight",(function(e){return n.xc(t),n.gc(2).prev()})),n.Sb(3,"album-art",tt),n.Tb(),n.Vb(4,"div",et),n.bc("swipeleft",(function(e){return n.xc(t),n.gc(2).next()})),n.bc("swiperight",(function(e){return n.xc(t),n.gc(2).prev()})),n.Tb(),n.Tb()}if(2&t){const t=n.gc(2);n.Ac(1),n.mc("ngIf",t.showVisualisation),n.Ac(3),n.mc("artist",t.track.trackArtist)("album",t.track.album.name)}}const nt=[1,"progress"],ot=["role","progressbar",1,"progress-bar","buffered-bar",3,"ngStyle"],ct=[1,"progress-bar",3,"ngStyle"],rt=["id","position-indicator",3,"ngStyle","ngClass"],at=function(t){return{width:t}},lt=function(t){return{"margin-left":t}},ut=function(t){return{dragging:t}};function dt(t,e){if(1&t&&(n.Vb(0,"div",nt),n.Sb(1,"div",ot),n.Sb(2,"div",ct),n.Sb(3,"div",rt),n.Tb()),2&t){const t=n.gc(2);n.Ac(1),n.mc("ngStyle",n.pc(4,at,t.round(t.track.buffered.end/t.track.duration*100)+"%")),n.Ac(2),n.mc("ngStyle",n.pc(6,at,t.track.position/t.track.duration*100+"%")),n.Ac(3),n.mc("ngStyle",n.pc(8,lt,t.track.position/t.track.duration*100+"%"))("ngClass",n.pc(10,ut,t.isDragging))}}const ht=["id","progress-pusher"];function gt(t,e){1&t&&n.Sb(0,"div",ht)}const mt=[1,"time","start"];function bt(t,e){if(1&t&&(n.Vb(0,"span",mt),n.Jc(1),n.hc(2,"timeFormat"),n.Tb()),2&t){const t=n.gc(2);n.Ac(1),n.Kc(n.ic(2,1,t.track.position))}}const pt=[1,"time","stop"];function vt(t,e){if(1&t&&(n.Vb(0,"span",pt),n.Jc(1),n.hc(2,"timeFormat"),n.Tb()),2&t){const t=n.gc(2);n.Ac(1),n.Kc(n.ic(2,1,t.track.duration))}}const yt=[1,"glyph","glyph-pause"];function ft(t,e){1&t&&n.Sb(0,"i",yt)}const kt=[1,"glyph","glyph-play"];function Tt(t,e){1&t&&n.Sb(0,"i",kt)}const St=[1,"btn","btn-link","btn-love",3,"ngClass","click"],Vt=[1,"glyph","glyph-star-outline"],wt=function(t){return{active:t}};function It(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",St),n.bc("click",(function(e){return n.xc(t),n.gc(2).toggleLoved()})),n.Sb(1,"i",Vt),n.Tb()}if(2&t){const t=n.gc(2);n.mc("ngClass",n.pc(1,wt,t.track.isLoved))}}const Pt=function(t,e,i){return{slided:t,"small-art":e,"no-focus":i}},At=function(t,e){return{"glyph-volume":t,"glyph-mute":e}};function xt(t,e){if(1&t){const t=n.Wb();n.Vb(0,"div",f),n.Vb(1,"div",k),n.Hc(2,st,5,3,"div",T),n.Vb(3,"div",S),n.Vb(4,"div",V),n.Hc(5,dt,4,12,"div",w),n.Hc(6,gt,1,0,"div",I),n.Hc(7,bt,3,3,"span",P),n.Hc(8,vt,3,3,"span",A),n.Vb(9,"div",x),n.Vb(10,"h4"),n.Jc(11),n.Tb(),n.Vb(12,"h5"),n.Vb(13,"a",E),n.bc("click",(function(e){return n.xc(t),n.gc().navigateToArtist()})),n.Jc(14),n.Tb(),n.Vb(15,"span",L),n.Jc(16," \u2022 "),n.Vb(17,"a",E),n.bc("click",(function(e){return n.xc(t),n.gc().navigateToAlbum()})),n.Jc(18),n.Tb(),n.Tb(),n.Tb(),n.Tb(),n.Tb(),n.Vb(19,"div",M),n.Vb(20,"div",D),n.Vb(21,"button",B),n.bc("click",(function(e){return n.xc(t),n.gc().prev()})),n.Sb(22,"i",C),n.Tb(),n.Vb(23,"button",B),n.bc("click",(function(e){return n.xc(t),n.gc().togglePlayPause()})),n.Hc(24,ft,1,0,"i",J),n.Hc(25,Tt,1,0,"i",N),n.Tb(),n.Vb(26,"button",B),n.bc("click",(function(e){return n.xc(t),n.gc().next()})),n.Sb(27,"i",W),n.Tb(),n.Hc(28,It,2,3,"button",O),n.Vb(29,"button",q),n.bc("click",(function(e){return n.xc(t),n.gc().toggleVolumeWindow(e)})),n.Sb(30,"span",F),n.Tb(),n.Vb(31,"button",H),n.bc("click",(function(e){return n.xc(t),n.gc().toggleShuffle()})),n.Sb(32,"i",R),n.Tb(),n.Tb(),n.Vb(33,"div",X),n.Vb(34,"input",j),n.bc("ngModelChange",(function(e){return n.xc(t),n.gc().volume=e})),n.bc("input",(function(e){return n.xc(t),n.gc().setVolume()})),n.bc("change",(function(e){return n.xc(t),n.gc().setVolume()})),n.Tb(),n.Tb(),n.Vb(35,"div",D),n.Vb(36,"button",K),n.bc("click",(function(e){return n.xc(t),n.gc().toggleSlide()})),n.Sb(37,"i",z),n.Tb(),n.Tb(),n.Tb(),n.Tb(),n.Tb(),n.Vb(38,"div",G),n.Vb(39,"div",$),n.Vb(40,"div",Y),n.Vb(41,"div",D),n.Sb(42,"mdb-tracklist",Q),n.Tb(),n.Tb(),n.Tb(),n.Tb(),n.Tb()}if(2&t){const t=n.gc();n.mc("ngClass",n.rc(18,Pt,t.slided,t.smallArt,t.noFocus)),n.Ac(2),n.mc("ngIf",!t.videoMode),n.Ac(5),n.mc("ngIf",!t.videoMode),n.Ac(6),n.mc("ngIf",!t.videoMode),n.Ac(7),n.mc("ngIf",!t.videoMode),n.Ac(8),n.mc("ngIf",!t.videoMode),n.Ac(11),n.Kc(t.track.title),n.Ac(14),n.Kc(t.track.trackArtist),n.Ac(18),n.Kc(t.track.album.name),n.Ac(24),n.mc("ngIf",t.isPlaying),n.Ac(25),n.mc("ngIf",t.isPaused),n.Ac(28),n.mc("ngIf","mdb-skipped"!==t.lastfmusername),n.Ac(29),n.mc("disabled",t.videoMode),n.Ac(30),n.mc("ngClass",n.qc(22,At,t.volume>0,0==t.volume)),n.Ac(31),n.mc("ngClass",n.pc(25,wt,t.isShuffled)),n.Ac(33),n.mc("hidden",!t.showVolumeWindow),n.Ac(34),n.mc("ngModel",t.volume),n.Ac(42),n.mc("playlist",t.playlist)}}const Et=[1,"animated-page"],Lt=[1,"jumbotron","theme-light"],Mt=[1,"row","albumdetail"],Dt=["routerLink","/artists"],Bt=[1,"glyph","glyph-people"],Ct=["routerLink","/albums"],Jt=[1,"glyph","glyph-music-album"],Nt=["routerLink","/playlists"],Wt=[1,"glyph","glyph-music-info"];function Ot(t,e){1&t&&(n.Vb(0,"div",Et),n.Vb(1,"div",Lt),n.Vb(2,"div",$),n.Vb(3,"div",Mt),n.Vb(4,"div",D),n.Vb(5,"h3"),n.Jc(6,"Nothing is playing"),n.Tb(),n.Vb(7,"p"),n.Jc(8," This is where you'll see the song you're playing and songs that are coming up. "),n.Tb(),n.Vb(9,"p"),n.Jc(10," Find an "),n.Vb(11,"a",Dt),n.Sb(12,"span",Bt),n.Jc(13," artist"),n.Tb(),n.Jc(14," or "),n.Vb(15,"a",Ct),n.Sb(16,"span",Jt),n.Jc(17," album"),n.Tb(),n.Jc(18," that you want to play; or setup a "),n.Vb(19,"a",Nt),n.Sb(20,"span",Wt),n.Jc(21," playlist"),n.Tb(),n.Tb(),n.Tb(),n.Tb(),n.Tb(),n.Tb(),n.Tb())}const qt=[{path:"",component:(()=>{class t{constructor(t,e,i,s,n,o,c){this.pathService=t,this.coreService=e,this.playerService=i,this.router=s,this.lastFMService=n,this.animationService=o,this.http=c,this.previousTrack={},this.slided=!1,this.isPlaying=!1,this.isPaused=!1,this.isShuffled=!1,this.isDragging=!1,this.c=this,this.lastfmusername="",this.showVolumeWindow=!1,this.volume=100,this.showVisualisation=this.booleanState("visualisation-state"),this.preferVideo=this.booleanState("preferVideo-state"),this.smallArt=this.booleanState("small-art"),this.videoMode=!1,this.isEventBound=!1,this.noFocus=!1,this.timeoutTimer=null,this.timeoutTime=5e3,this.startDrag=t=>{this.isDragging=!0},this.drag=t=>{if(this.isDragging){const e=((t.clientX||t.changedTouches[0].clientX)-60)/document.getElementById("progress-pusher").clientWidth;e>=0&&e<=1&&this.setIndicatorPosition(e)}},this.stopDrag=t=>{if(this.isDragging){this.isDragging=!1;const e=((t.clientX||t.changedTouches[0].clientX)-60)/document.getElementById("progress-pusher").clientWidth;this.playerService.setPosition(this.track.duration/1e3*e)}};const r=this.playerService.getCurrentPlaylist();r&&(this.playlist=r.playlist,this.trackIndex=r.startIndex,this.isPaused=r.isPaused,this.isPlaying=r.isPlaying,this.isShuffled=r.isShuffled,this.volume=this.playerService.getVolume(),this.setTrack()),this.subscription=this.playerService.playlistAnnounced$.subscribe(t=>{this.playlist=t.playlist,this.trackIndex=t.startIndex,this.isPaused=t.isPaused,this.isPlaying=t.isPlaying,this.isShuffled=t.isShuffled,this.setTrack()}),this.subscription2=this.playerService.volumeAnnounced.subscribe(t=>{this.volume=t}),this.subscription3=this.playerService.hideVolumeWindowAnnounced$.subscribe(()=>{this.showVolumeWindow=!1}),this.pathService.announcePage("Now playing"),"ontouchstart"in document.documentElement?(document.getElementsByTagName("body")[0].addEventListener("touchmove",this.drag),document.getElementsByTagName("body")[0].addEventListener("touchend",this.stopDrag)):(document.getElementsByTagName("body")[0].addEventListener("mousemove",this.drag),document.getElementsByTagName("body")[0].addEventListener("mouseup",this.stopDrag)),this.timeoutTimer=setTimeout(()=>{this.onTimeout()},this.timeoutTime)}ngOnInit(){setTimeout(()=>{this.track&&("ontouchstart"in document.documentElement?document.getElementById("progress-pusher").addEventListener("touchstart",this.startDrag):document.getElementById("progress-pusher").addEventListener("mousedown",this.startDrag),this.isEventBound=!0)},250),this.lastfmusername=localStorage.getItem("lastfm-username")||""}setTrack(){this.track=this.playlist.tracks[this.trackIndex],this.currentTrack!==this.track&&(this.currentTrack=this.track,this.animationService.requestAnimation("enter",document.querySelector(".controls-wrapper h4")),this.animationService.requestAnimation("enter",document.querySelector(".controls-wrapper h5"))),this.isEventBound||setTimeout(()=>{try{"ontouchstart"in document.documentElement?document.getElementById("progress-pusher").addEventListener("touchstart",this.startDrag):document.getElementById("progress-pusher").addEventListener("mousedown",this.startDrag),this.isEventBound=!0}catch(t){console.error(t)}},250)}toggleSlide(){this.slided=!this.slided}ngOnDestroy(){this.subscription.unsubscribe(),this.subscription2.unsubscribe(),this.subscription3.unsubscribe(),"ontouchstart"in document.documentElement?(document.getElementsByTagName("body")[0].removeEventListener("touchmove",this.drag),document.getElementsByTagName("body")[0].removeEventListener("touchend",this.stopDrag)):(document.getElementsByTagName("body")[0].removeEventListener("mousemove",this.drag),document.getElementsByTagName("body")[0].removeEventListener("mouseup",this.stopDrag)),clearTimeout(this.timeoutTime)}navigateToArtist(){this.router.navigate(["/letter",this.track.album.artist.letter.escapedLetter,"artist",this.track.album.artist.sortName])}navigateToAlbum(){this.router.navigate(["/letter",this.track.album.artist.letter.escapedLetter,"artist",this.track.album.artist.sortName,"album",this.track.album.sortName])}next(){this.videoMode&&this.playerService.resume(),this.videoMode=!1,setTimeout(()=>{const t=document.querySelector(".previous-album-art");t.style.backgroundImage=document.querySelector(".current-album-art").style.backgroundImage,t.classList.remove("slideRightOut"),t.classList.remove("slideLeftOut"),this.animationService.requestAnimation("slideLeftOut",t,!1),this.trackIndex<this.playlist.tracks.length-1?(this.trackIndex++,this.playerService.next()):this.playlist.isContinues?(this.trackIndex=0,"random"===this.playlist.type||"radio"===this.playlist.type?this.playerService.nextPlaylist(this.playlist.type):this.playerService.nextAlbum(this.track.album)):this.playerService.stop()})}prev(){this.videoMode&&this.playerService.resume(),this.videoMode=!1,setTimeout(()=>{const t=document.querySelector(".previous-album-art");t.style.backgroundImage=document.querySelector(".current-album-art").style.backgroundImage,t.classList.remove("slideRightOut"),t.classList.remove("slideLeftOut"),this.animationService.requestAnimation("slideRightOut",t,!1),this.trackIndex>0&&(this.trackIndex--,this.playerService.prev())})}togglePlayPause(){this.videoMode?this.isPlaying?(this.player.pauseVideo(),this.isPlaying=!1,this.isPaused=!0):(this.player.playVideo(),this.isPlaying=!0,this.isPaused=!1):this.playerService.togglePlayPause()}toggleShuffle(){this.isShuffled=!this.isShuffled,this.playerService.shufflePlaylist(this.isShuffled)}toggleLoved(){this.track.isLoved=!this.track.isLoved,this.lastFMService.toggleLoved(this.track).subscribe(t=>{console.info(t)})}setIndicatorPosition(t){document.getElementById("position-indicator").style.marginLeft=100*t+"%"}toggleVolumeWindow(t){t.stopPropagation(),t.stopImmediatePropagation(),t.preventDefault(),this.showVolumeWindow=!this.showVolumeWindow}setVolume(){this.playerService.setVolume(this.volume)}round(t){return Math.floor(t)}handleError(t){return Object(a.a)("no video")}toggleVideo(){this.videoMode=!this.videoMode,this.videoMode?this.playerService.pause():this.playerService.togglePlayPause()}savePlayer(t){this.player=t,this.player.playVideo(),this.isPlaying=!0,this.isPaused=!1}onStateChange(t){0===t.data&&(this.videoMode=!1,this.next())}onTimeout(){this.slided||this.videoMode||(this.noFocus=!0)}onMove(t){clearTimeout(this.timeoutTimer),this.noFocus=!1,this.timeoutTimer=setTimeout(()=>{this.onTimeout()},this.timeoutTime)}booleanState(t){const e=localStorage.getItem(t);return!(!e||"true"!==e)}}return t.ngComponentDef=n.Lb({type:t,selectors:[["ng-component"]],factory:function(e){return new(e||t)(n.Rb(g.a),n.Rb(d.a),n.Rb(l.a),n.Rb(r.c),n.Rb(h.a),n.Rb(u.a),n.Rb(m.a))},hostBindings:function(t,e,i){1&t&&n.bc("mousemove",(function(t){return e.onMove(t)}))},consts:2,vars:2,template:function(t,e){1&t&&(n.Hc(0,xt,43,27,"div",v),n.Hc(1,Ot,22,0,"div",y)),2&t&&(n.mc("ngIf",e.track),n.Ac(1),n.mc("ngIf",!e.track))},directives:[s.l,s.j,o.l,o.a,o.f,o.i,b.a,s.m,r.d],pipes:[p.a],encapsulation:2}),t})()}];let Ft=(()=>{class t{}return t.ngModuleDef=n.Pb({type:t}),t.ngInjectorDef=n.Ob({factory:function(e){return new(e||t)},imports:[[r.e.forChild(qt)],r.e]}),t.ngLocaleIdDef="en-GB",t})();r.e.forChild(qt),i.d(e,"NowPlayingModule",(function(){return Ht}));let Ht=(()=>{class t{}return t.ngModuleDef=n.Pb({type:t}),t.ngInjectorDef=n.Ob({factory:function(e){return new(e||t)},imports:[[s.c,Ft,c.a,o.b]]}),t.ngLocaleIdDef="en-GB",t})()}}]);