function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,i){for(var a=0;a<i.length;a++){var s=i[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function _createClass(t,i,a){return i&&_defineProperties(t.prototype,i),a&&_defineProperties(t,a),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{kez3:function(t,i,a){"use strict";a.r(i);var s=a("ofXK"),e=a("fXoL"),c=a("3Pt+"),n=a("hDf6"),r=a("tyNb"),l=a("ufXC"),o=a("OgP6"),b=a("ktVm"),f=a("t083"),u=a("XtVx"),g=a("KI15"),p=a("Gcu2"),h=a("Oz9T"),y=[1,"animated-page"],m=[1,"container"],v=[1,"row"],d=[1,"col-12","col-lg-3","playlists-lg-fixed"],k=[1,"nav","flex-column"],T=["class","nav-item",4,"ngIf"],S=[1,"nav-item"],A=["class","btn btn-link px-0",3,"click",4,"ngIf"],V=[1,"btn","btn-link","px-0",3,"click"],I=["class","nav-item",4,"ngFor","ngForOf"],P=["class","col-12 col-lg-9 offset-lg-3",4,"ngIf"];function w(t,i){if(1&t){var a=e.Wb();e.Vb(0,"li",S),e.Vb(1,"a",V),e.bc("click",(function(t){return e.xc(a),e.gc().setPlaylist("current")})),e.Jc(2,"Current playlist"),e.Tb(),e.Tb()}}function C(t,i){if(1&t){var a=e.Wb();e.Vb(0,"a",V),e.bc("click",(function(t){return e.xc(a),e.gc().setPlaylist("last.fm")})),e.Jc(1,"Loved tracks on last.fm"),e.Tb()}}function x(t,i){if(1&t){var a=e.Wb();e.Vb(0,"a",V),e.bc("click",(function(t){return e.xc(a),e.gc().setPlaylist("radio")})),e.Jc(1),e.Tb()}if(2&t){var s=e.gc();e.Ac(1),e.Lc("",s.playlistService.numberOfTracksInAPlaylist," tracks by preference")}}var J=[3,"click"],O=[1,"glyph","glyph-delete"];function L(t,i){if(1&t){var a=e.Wb();e.Vb(0,"li",S),e.Vb(1,"a",J),e.bc("click",(function(t){e.xc(a);var s=i.$implicit;return e.gc().setPlaylist(s)})),e.Jc(2),e.Vb(3,"a",J),e.bc("click",(function(t){e.xc(a);var s=i.$implicit;return e.gc().removePlaylist(s)})),e.Sb(4,"span",O),e.Tb(),e.Tb(),e.Tb()}if(2&t){var s=i.$implicit;e.Ac(2),e.Lc("",s.name," ")}}var H=[1,"col-12","col-lg-9","offset-lg-3"],F=["class","small muted",4,"ngIf"],N=[1,"progress-bar"],R=[1,"progress-circle"],D=[1,"small","muted"];function M(t,i){if(1&t&&(e.Vb(0,"p",D),e.Jc(1),e.Tb()),2&t){var a=e.gc(2);e.Ac(1),e.Lc("Tracks found: ",a.playlist.tracks.length,"")}}function _(t,i){if(1&t&&(e.Vb(0,"div",H),e.Sb(1,"br"),e.Hc(2,M,2,1,"p",F),e.Vb(3,"div",N),e.Sb(4,"div",R),e.Sb(5,"div",R),e.Sb(6,"div",R),e.Sb(7,"div",R),e.Sb(8,"div",R),e.Tb(),e.Tb()),2&t){var a=e.gc();e.Ac(2),e.mc("ngIf",a.playlist&&a.playlist.tracks&&a.playlist.tracks.length>0)}}var W=[1,"playlists-header"],$=[1,"small","muted","color-type-secondary"],j=[3,"click",4,"ngIf"],B=["class","animated-page",4,"ngIf"],E=[1,"glyph","glyph-edit","small"];function X(t,i){if(1&t){var a=e.Wb();e.Vb(0,"a",J),e.bc("click",(function(t){e.xc(a);var i=e.gc(2);return i.updatePlaylist(i.playlist)})),e.Sb(1,"span",E),e.Tb()}}var G=[1,"glyph","glyph-delete","small"];function K(t,i){if(1&t){var a=e.Wb();e.Vb(0,"a",J),e.bc("click",(function(t){e.xc(a);var i=e.gc(2);return i.removePlaylist(i.playlist)})),e.Sb(1,"span",G),e.Tb()}}var z=[3,"playlist",4,"ngIf"],U=[3,"playlist"];function q(t,i){if(1&t&&e.Sb(0,"mdb-tracklist",U),2&t){var a=e.gc(3);e.mc("playlist",a.playlist)}}function Q(t,i){if(1&t&&(e.Vb(0,"div",y),e.Hc(1,q,1,1,"mdb-tracklist",z),e.Tb()),2&t){var a=e.gc(2);e.Ac(1),e.mc("ngIf",!a.loading)}}var Y=[1,"col"],Z=["routerLink","/artists"],tt=[1,"glyph","glyph-people"],it=["routerLink","/albums"],at=[1,"glyph","glyph-music-album"],st=["routerLink","/years"],et=[1,"glyph","glyph-calendar"];function ct(t,i){1&t&&(e.Vb(0,"div",y),e.Vb(1,"div",v),e.Vb(2,"div",Y),e.Vb(3,"p"),e.Jc(4," Unfortunately this playlist is empty :( "),e.Sb(5,"br"),e.Jc(6,"Find some tracks from an "),e.Vb(7,"a",Z),e.Sb(8,"span",tt),e.Jc(9," artist"),e.Tb(),e.Jc(10,", "),e.Vb(11,"a",it),e.Sb(12,"span",at),e.Jc(13," album"),e.Tb(),e.Jc(14," or a "),e.Vb(15,"a",st),e.Sb(16,"span",et),e.Jc(17," year"),e.Tb(),e.Tb(),e.Tb(),e.Tb(),e.Tb())}function nt(t,i){if(1&t&&(e.Vb(0,"div",H),e.Vb(1,"h4",W),e.Jc(2),e.Vb(3,"span",$),e.Jc(4),e.Tb(),e.Jc(5," \xa0 "),e.Hc(6,X,2,0,"a",j),e.Jc(7," \xa0 "),e.Hc(8,K,2,0,"a",j),e.Tb(),e.Hc(9,Q,2,1,"div",B),e.Hc(10,ct,18,0,"div",B),e.Tb()),2&t){var a=e.gc();e.Ac(2),e.Lc(" ",a.playlist.name," "),e.Ac(4),e.Lc("(",a.playlist.tracks.length,")"),e.Ac(6),e.mc("ngIf",a.playlist.isOwn),e.Ac(8),e.mc("ngIf",a.playlist.isOwn),e.Ac(9),e.mc("ngIf",a.playlist&&a.playlist.tracks&&0!==a.playlist.tracks.length),e.Ac(10),e.mc("ngIf",a.playlist&&a.playlist.tracks&&0===a.playlist.tracks.length)}}var rt=["sticky","",1,"header-seperator"],lt=["role","form",3,"ngClass"],ot=["sortForm","ngForm"],bt=[1,"form-group","row"],ft=["for","sort",1,"col-12","col-sm-3","col-form-label"],ut=[1,"col","col-sm-9"],gt=["name","sort","id","sort",1,"form-control",3,"ngModel","ngModelChange"],pt=["name","ngModel"],ht=[4,"ngFor","ngForOf"];function yt(t,i){if(1&t&&(e.Vb(0,"option"),e.Jc(1),e.Tb()),2&t){var a=i.$implicit;e.Ac(1),e.Kc(a.name)}}var mt=function(t){return{"theme-alt":t}};function vt(t,i){if(1&t){var a=e.Wb();e.Vb(0,"div",H),e.Vb(1,"h4",rt),e.Jc(2," Select an artist as starting point "),e.Tb(),e.Vb(3,"form",lt,ot),e.Vb(5,"div",bt),e.Vb(6,"label",ft),e.Jc(7,"Select an artist"),e.Tb(),e.Vb(8,"div",ut),e.Vb(9,"select",gt,pt),e.bc("ngModelChange",(function(t){return e.xc(a),e.gc().startingArtistName=t})),e.bc("ngModelChange",(function(t){return e.xc(a),e.gc().onChange(t)})),e.Hc(11,yt,2,1,"option",ht),e.Tb(),e.Tb(),e.Tb(),e.Tb(),e.Tb()}if(2&t){var s=e.gc();e.Ac(3),e.mc("ngClass",e.pc(3,mt,"dark"===s.theme)),e.Ac(9),e.mc("ngModel",s.startingArtistName),e.Ac(11),e.mc("ngForOf",s.artists)}}var dt,kt,Tt=[{path:"",component:(dt=function(){function t(i,a,s,e,c,n,r){var l=this;_classCallCheck(this,t),this.pathService=i,this.coreService=a,this.router=s,this.playerService=e,this.lastfmservice=c,this.configService=n,this.playlistService=r,this.loading=!1,this.username=localStorage.getItem("lastfm-username"),this.showStartingArtist=!1,this.ownPlaylists=[],this.artists=[];var o=this.playerService.getCurrentPlaylist();o&&(this.currentPlaylist=o.playlist,this.trackIndex=o.startIndex,this.setTrack()),this.subscription=this.playerService.playlistAnnounced$.subscribe((function(t){l.currentPlaylist=t.playlist,l.trackIndex=t.startIndex,l.setTrack()})),this.core=this.coreService.getCore(),this.subscription2=this.core.coreParsed$.subscribe((function(t){l.ngOnInit()})),this.theme=n.mode,this.newPlaylist=new g.a}return _createClass(t,[{key:"setTrack",value:function(){this.track=this.currentPlaylist.tracks[this.trackIndex],this.track&&(this.track.position=0)}},{key:"ngOnInit",value:function(){var t=this;if(this.pathService.announcePage("Playlists"),this.artists=this.core.artistsList(),this.ownPlaylists=[],localStorage.getItem("customlisttest")){var i=JSON.parse(localStorage.getItem("customlisttest"));i&&i.forEach((function(i){var a=new g.a;a.name=i.name,a.isOwn=!0,i.tracks.forEach((function(i){var s=t.core.getTrackById(i);s&&s.title&&a.tracks.push(s)})),t.ownPlaylists.push(a)}))}}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe(),this.subscription2.unsubscribe()}},{key:"setPlaylist",value:function(t){var i=this;this.loading=!0,this.showStartingArtist=!1,"current"===t?(this.playlist=this.currentPlaylist,this.loading=!1):"last.fm"===t?this.lastfmservice.getLovedTracks(this.username).subscribe((function(t){i.playlist=i.playlistService.extractTracks(t.lovedtracks.track),i.loading=!1})):"random"===t?(this.playlist=this.playlistService.generateRandom(),this.playlist.isContinues=!0,this.playlist.type=t,this.loading=!1):"radio"===t?this.playlist=this.generateRadio():"artist"===t?this.askForStartingArtist():t instanceof g.a?(this.playlist=t,this.loading=!1):console.info("unknown playlist",t)}},{key:"generateRadio",value:function(){var t=this;this.lastfmservice.getTopArtists(this.username).subscribe((function(i){t.playlist=t.playlistService.extractArtists(i=i.topartists.artist),t.playlist.isContinues=!0,t.playlist.type="radio",t.loading=!1}))}},{key:"onChange",value:function(){var t=this.core.getArtistByName(this.startingArtistName),i=new g.a;i.name="Artist radio for ".concat(t.name),i.tracks=[this.playlistService.getRandomTrackFromList([t])],this.showStartingArtist=!1,this.playlist=i,this.getNextSimilairArtist(t,this.playlist)}},{key:"getNextSimilairArtist",value:function(t,i){var a=this;this.loading=!0,this.lastfmservice.getSimilairArtists(t).subscribe((function(t){t=t.similarartists.artist,a.loading=!1;var s=[];if(t.forEach((function(t){var i=a.core.getArtistByName(t.name);i&&s.push(i)})),s.length>0){var e=a.playlistService.getNextTrackForPlaylist(s,i);e&&i.tracks.length<a.playlistService.numberOfTracksInAPlaylist&&(i.tracks.push(e),a.getNextSimilairArtist(e.artist,i))}}))}},{key:"askForStartingArtist",value:function(){this.loading=!1,this.playlist=null,this.showStartingArtist=!0}}]),t}(),dt.ngComponentDef=e.Lb({type:dt,selectors:[["app-playlists"]],factory:function(t){return new(t||dt)(e.Rb(u.a),e.Rb(b.a),e.Rb(r.c),e.Rb(l.a),e.Rb(f.a),e.Rb(o.a),e.Rb(p.a))},consts:22,vars:8,template:function(t,i){1&t&&(e.Vb(0,"div",y),e.Vb(1,"div",m),e.Vb(2,"div",v),e.Vb(3,"div",d),e.Vb(4,"h4"),e.Jc(5,"Playlists"),e.Tb(),e.Vb(6,"ul",k),e.Hc(7,w,3,0,"li",T),e.Vb(8,"li",S),e.Hc(9,C,2,0,"a",A),e.Tb(),e.Vb(10,"li",S),e.Vb(11,"a",V),e.bc("click",(function(t){return i.setPlaylist("random")})),e.Jc(12),e.Tb(),e.Tb(),e.Vb(13,"li",S),e.Hc(14,x,2,1,"a",A),e.Tb(),e.Vb(15,"li",S),e.Vb(16,"a",V),e.bc("click",(function(t){return i.setPlaylist("artist")})),e.Jc(17,"Artist radio"),e.Tb(),e.Tb(),e.Hc(18,L,5,1,"li",I),e.Tb(),e.Tb(),e.Hc(19,_,9,1,"div",P),e.Hc(20,nt,11,6,"div",P),e.Hc(21,vt,12,5,"div",P),e.Tb(),e.Tb(),e.Tb()),2&t&&(e.Ac(7),e.mc("ngIf",i.currentPlaylist),e.Ac(9),e.mc("ngIf",i.username&&"mdb-skipped"!==i.username),e.Ac(12),e.Lc("",i.playlistService.numberOfTracksInAPlaylist," random tracks"),e.Ac(14),e.mc("ngIf",i.username&&"mdb-skipped"!==i.username),e.Ac(18),e.mc("ngForOf",i.ownPlaylists),e.Ac(19),e.mc("ngIf",i.loading),e.Ac(20),e.mc("ngIf",i.playlist&&!i.loading&&!i.showStartingArtist),e.Ac(21),e.mc("ngIf",i.showStartingArtist&&!i.loading&&!i.playlist))},directives:[s.l,s.k,h.a,r.d,c.p,c.g,c.h,s.j,c.n,c.f,c.i,c.j,c.o],encapsulation:2}),dt)}],St=((kt=function t(){_classCallCheck(this,t)}).ngModuleDef=e.Pb({type:kt}),kt.ngInjectorDef=e.Ob({factory:function(t){return new(t||kt)},imports:[[r.e.forChild(Tt)],r.e]}),kt.ngLocaleIdDef="en-GB",kt);r.e.forChild(Tt),a.d(i,"PlaylistsModule",(function(){return Vt}));var At,Vt=((At=function t(){_classCallCheck(this,t)}).ngModuleDef=e.Pb({type:At}),At.ngInjectorDef=e.Ob({factory:function(t){return new(t||At)},imports:[[s.c,St,n.a,c.b]]}),At.ngLocaleIdDef="en-GB",At)}}]);