function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,i){for(var s=0;s<i.length;s++){var a=i[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function _createClass(t,i,s){return i&&_defineProperties(t.prototype,i),s&&_defineProperties(t,s),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{kez3:function(t,i,s){"use strict";s.r(i);var a=s("ofXK"),r=s("3Pt+"),e=s("hDf6"),n=s("tyNb"),l=s("ufXC"),c=s("OgP6"),o=s("ktVm"),b=s("t083"),f=s("XtVx"),u=s("KI15"),p=s("Gcu2"),h=s("fXoL"),y=s("Oz9T");function g(t,i){if(1&t){var s=h.Ob();h.Nb(0,"li",6),h.Nb(1,"a",8),h.Vb("click",(function(){return h.oc(s),h.Zb().setPlaylist("current")})),h.sc(2,"Current playlist"),h.Mb(),h.Mb()}}function d(t,i){if(1&t){var s=h.Ob();h.Nb(0,"a",8),h.Vb("click",(function(){return h.oc(s),h.Zb().setPlaylist("last.fm")})),h.sc(1,"Loved tracks on last.fm"),h.Mb()}}function m(t,i){if(1&t){var s=h.Ob();h.Nb(0,"a",8),h.Vb("click",(function(){return h.oc(s),h.Zb().setPlaylist("radio")})),h.sc(1),h.Mb()}if(2&t){var a=h.Zb();h.zb(1),h.uc("",a.playlistService.numberOfTracksInAPlaylist," tracks by preference")}}function v(t,i){if(1&t){var s=h.Ob();h.Nb(0,"li",6),h.Nb(1,"a",11),h.Vb("click",(function(){h.oc(s);var t=i.$implicit;return h.Zb().setPlaylist(t)})),h.sc(2),h.Nb(3,"a",11),h.Vb("click",(function(){h.oc(s);var t=i.$implicit;return h.Zb().removePlaylist(t)})),h.Lb(4,"span",12),h.Mb(),h.Mb(),h.Mb()}if(2&t){var a=i.$implicit;h.zb(2),h.uc("",a.name," ")}}function k(t,i){if(1&t&&(h.Nb(0,"p",17),h.sc(1),h.Mb()),2&t){var s=h.Zb(2);h.zb(1),h.uc("Tracks found: ",s.playlist.tracks.length,"")}}function N(t,i){if(1&t&&(h.Nb(0,"div",13),h.Lb(1,"br"),h.rc(2,k,2,1,"p",14),h.Nb(3,"div",15),h.Lb(4,"div",16),h.Lb(5,"div",16),h.Lb(6,"div",16),h.Lb(7,"div",16),h.Lb(8,"div",16),h.Mb(),h.Mb()),2&t){var s=h.Zb();h.zb(2),h.fc("ngIf",s.playlist&&s.playlist.tracks&&s.playlist.tracks.length>0)}}function M(t,i){if(1&t){var s=h.Ob();h.Nb(0,"a",11),h.Vb("click",(function(){h.oc(s);var t=h.Zb(2);return t.updatePlaylist(t.playlist)})),h.Lb(1,"span",22),h.Mb()}}function I(t,i){if(1&t){var s=h.Ob();h.Nb(0,"a",11),h.Vb("click",(function(){h.oc(s);var t=h.Zb(2);return t.removePlaylist(t.playlist)})),h.Lb(1,"span",23),h.Mb()}}function P(t,i){if(1&t&&h.Lb(0,"mdb-tracklist",25),2&t){var s=h.Zb(3);h.fc("playlist",s.playlist)}}function S(t,i){if(1&t&&(h.Nb(0,"div",0),h.rc(1,P,1,1,"mdb-tracklist",24),h.Mb()),2&t){var s=h.Zb(2);h.zb(1),h.fc("ngIf",!s.loading)}}function w(t,i){1&t&&(h.Nb(0,"div",0),h.Nb(1,"div",2),h.Nb(2,"div",26),h.Nb(3,"p"),h.sc(4," Unfortunately this playlist is empty :( "),h.Lb(5,"br"),h.sc(6,"Find some tracks from an "),h.Nb(7,"a",27),h.Lb(8,"span",28),h.sc(9," artist"),h.Mb(),h.sc(10,", "),h.Nb(11,"a",29),h.Lb(12,"span",30),h.sc(13," album"),h.Mb(),h.sc(14," or a "),h.Nb(15,"a",31),h.Lb(16,"span",32),h.sc(17," year"),h.Mb(),h.Mb(),h.Mb(),h.Mb(),h.Mb())}function z(t,i){if(1&t&&(h.Nb(0,"div",13),h.Nb(1,"h4",18),h.sc(2),h.Nb(3,"span",19),h.sc(4),h.Mb(),h.sc(5," \xa0 "),h.rc(6,M,2,0,"a",20),h.sc(7," \xa0 "),h.rc(8,I,2,0,"a",20),h.Mb(),h.rc(9,S,2,1,"div",21),h.rc(10,w,18,0,"div",21),h.Mb()),2&t){var s=h.Zb();h.zb(2),h.uc(" ",s.playlist.name," "),h.zb(2),h.uc("(",s.playlist.tracks.length,")"),h.zb(2),h.fc("ngIf",s.playlist.isOwn),h.zb(2),h.fc("ngIf",s.playlist.isOwn),h.zb(1),h.fc("ngIf",s.playlist&&s.playlist.tracks&&0!==s.playlist.tracks.length),h.zb(1),h.fc("ngIf",s.playlist&&s.playlist.tracks&&0===s.playlist.tracks.length)}}function A(t,i){if(1&t&&(h.Nb(0,"option"),h.sc(1),h.Mb()),2&t){var s=i.$implicit;h.zb(1),h.tc(s.name)}}var C=function(t){return{"theme-alt":t}};function O(t,i){if(1&t){var s=h.Ob();h.Nb(0,"div",13),h.Nb(1,"h4",33),h.sc(2," Select an artist as starting point "),h.Mb(),h.Nb(3,"form",34,35),h.Nb(5,"div",36),h.Nb(6,"label",37),h.sc(7,"Select an artist"),h.Mb(),h.Nb(8,"div",38),h.Nb(9,"select",39,40),h.Vb("ngModelChange",(function(t){return h.oc(s),h.Zb().startingArtistName=t}))("ngModelChange",(function(t){return h.oc(s),h.Zb().onChange(t)})),h.rc(11,A,2,1,"option",41),h.Mb(),h.Mb(),h.Mb(),h.Mb(),h.Mb()}if(2&t){var a=h.Zb();h.zb(3),h.fc("ngClass",h.ic(3,C,"dark"===a.theme)),h.zb(6),h.fc("ngModel",a.startingArtistName),h.zb(2),h.fc("ngForOf",a.artists)}}var L,x,Z=[{path:"",component:(L=function(){function t(i,s,a,r,e,n,l){var c=this;_classCallCheck(this,t),this.pathService=i,this.coreService=s,this.router=a,this.playerService=r,this.lastfmservice=e,this.configService=n,this.playlistService=l,this.loading=!1,this.username=localStorage.getItem("lastfm-username"),this.showStartingArtist=!1,this.ownPlaylists=[],this.artists=[];var o=this.playerService.getCurrentPlaylist();o&&(this.currentPlaylist=o.playlist,this.trackIndex=o.startIndex,this.setTrack()),this.subscription=this.playerService.playlistAnnounced$.subscribe((function(t){c.currentPlaylist=t.playlist,c.trackIndex=t.startIndex,c.setTrack()})),this.core=this.coreService.getCore(),this.subscription2=this.core.coreParsed$.subscribe((function(t){c.ngOnInit()})),this.theme=n.mode,this.newPlaylist=new u.a}return _createClass(t,[{key:"setTrack",value:function(){this.track=this.currentPlaylist.tracks[this.trackIndex],this.track&&(this.track.position=0)}},{key:"ngOnInit",value:function(){var t=this;if(this.pathService.announcePage("Playlists"),this.artists=this.core.artistsList(),this.ownPlaylists=[],localStorage.getItem("customlisttest")){var i=JSON.parse(localStorage.getItem("customlisttest"));i&&i.forEach((function(i){var s=new u.a;s.name=i.name,s.isOwn=!0,i.tracks.forEach((function(i){var a=t.core.getTrackById(i);a&&a.title&&s.tracks.push(a)})),t.ownPlaylists.push(s)}))}}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe(),this.subscription2.unsubscribe()}},{key:"setPlaylist",value:function(t){var i=this;this.loading=!0,this.showStartingArtist=!1,"current"===t?(this.playlist=this.currentPlaylist,this.loading=!1):"last.fm"===t?this.lastfmservice.getLovedTracks(this.username).subscribe((function(t){i.playlist=i.playlistService.extractTracks(t.lovedtracks.track),i.loading=!1})):"random"===t?(this.playlist=this.playlistService.generateRandom(),this.playlist.isContinues=!0,this.playlist.type=t,this.loading=!1):"radio"===t?this.playlist=this.generateRadio():"artist"===t?this.askForStartingArtist():t instanceof u.a?(this.playlist=t,this.loading=!1):console.info("unknown playlist",t)}},{key:"generateRadio",value:function(){var t=this;this.lastfmservice.getTopArtists(this.username).subscribe((function(i){t.playlist=t.playlistService.extractArtists(i=i.topartists.artist),t.playlist.isContinues=!0,t.playlist.type="radio",t.loading=!1}))}},{key:"onChange",value:function(){var t=this.core.getArtistByName(this.startingArtistName),i=new u.a;i.name="Artist radio for ".concat(t.name),i.tracks=[this.playlistService.getRandomTrackFromList([t])],this.showStartingArtist=!1,this.playlist=i,this.getNextSimilairArtist(t,this.playlist)}},{key:"getNextSimilairArtist",value:function(t,i){var s=this;this.loading=!0,this.lastfmservice.getSimilairArtists(t).subscribe((function(t){t=t.similarartists.artist,s.loading=!1;var a=[];if(t.forEach((function(t){var i=s.core.getArtistByName(t.name);i&&a.push(i)})),a.length>0){var r=s.playlistService.getNextTrackForPlaylist(a,i);r&&i.tracks.length<s.playlistService.numberOfTracksInAPlaylist&&(i.tracks.push(r),s.getNextSimilairArtist(r.artist,i))}}))}},{key:"askForStartingArtist",value:function(){this.loading=!1,this.playlist=null,this.showStartingArtist=!0}}]),t}(),L.\u0275fac=function(t){return new(t||L)(h.Kb(f.a),h.Kb(o.a),h.Kb(n.c),h.Kb(l.a),h.Kb(b.a),h.Kb(c.a),h.Kb(p.a))},L.\u0275cmp=h.Eb({type:L,selectors:[["app-playlists"]],decls:22,vars:8,consts:[[1,"animated-page"],[1,"container"],[1,"row"],[1,"col-12","col-lg-3","playlists-lg-fixed"],[1,"nav","flex-column"],["class","nav-item",4,"ngIf"],[1,"nav-item"],["class","btn btn-link px-0",3,"click",4,"ngIf"],[1,"btn","btn-link","px-0",3,"click"],["class","nav-item",4,"ngFor","ngForOf"],["class","col-12 col-lg-9 offset-lg-3",4,"ngIf"],[3,"click"],[1,"glyph","glyph-delete"],[1,"col-12","col-lg-9","offset-lg-3"],["class","small muted",4,"ngIf"],[1,"progress-bar"],[1,"progress-circle"],[1,"small","muted"],[1,"playlists-header"],[1,"small","muted","color-type-secondary"],[3,"click",4,"ngIf"],["class","animated-page",4,"ngIf"],[1,"glyph","glyph-edit","small"],[1,"glyph","glyph-delete","small"],[3,"playlist",4,"ngIf"],[3,"playlist"],[1,"col"],["routerLink","/artists"],[1,"glyph","glyph-people"],["routerLink","/albums"],[1,"glyph","glyph-music-album"],["routerLink","/years"],[1,"glyph","glyph-calendar"],["sticky","",1,"header-seperator"],["role","form",3,"ngClass"],["sortForm","ngForm"],[1,"form-group","row"],["for","sort",1,"col-12","col-sm-3","col-form-label"],[1,"col","col-sm-9"],["name","sort","id","sort",1,"form-control",3,"ngModel","ngModelChange"],["name","ngModel"],[4,"ngFor","ngForOf"]],template:function(t,i){1&t&&(h.Nb(0,"div",0),h.Nb(1,"div",1),h.Nb(2,"div",2),h.Nb(3,"div",3),h.Nb(4,"h4"),h.sc(5,"Playlists"),h.Mb(),h.Nb(6,"ul",4),h.rc(7,g,3,0,"li",5),h.Nb(8,"li",6),h.rc(9,d,2,0,"a",7),h.Mb(),h.Nb(10,"li",6),h.Nb(11,"a",8),h.Vb("click",(function(){return i.setPlaylist("random")})),h.sc(12),h.Mb(),h.Mb(),h.Nb(13,"li",6),h.rc(14,m,2,1,"a",7),h.Mb(),h.Nb(15,"li",6),h.Nb(16,"a",8),h.Vb("click",(function(){return i.setPlaylist("artist")})),h.sc(17,"Artist radio"),h.Mb(),h.Mb(),h.rc(18,v,5,1,"li",9),h.Mb(),h.Mb(),h.rc(19,N,9,1,"div",10),h.rc(20,z,11,6,"div",10),h.rc(21,O,12,5,"div",10),h.Mb(),h.Mb(),h.Mb()),2&t&&(h.zb(7),h.fc("ngIf",i.currentPlaylist),h.zb(2),h.fc("ngIf",i.username&&"mdb-skipped"!==i.username),h.zb(3),h.uc("",i.playlistService.numberOfTracksInAPlaylist," random tracks"),h.zb(2),h.fc("ngIf",i.username&&"mdb-skipped"!==i.username),h.zb(4),h.fc("ngForOf",i.ownPlaylists),h.zb(1),h.fc("ngIf",i.loading),h.zb(1),h.fc("ngIf",i.playlist&&!i.loading&&!i.showStartingArtist),h.zb(1),h.fc("ngIf",i.showStartingArtist&&!i.loading&&!i.playlist))},directives:[a.k,a.j,y.a,n.d,r.m,r.d,r.e,a.i,r.k,r.c,r.f,r.g,r.l],encapsulation:2}),L)}],T=((x=function t(){_classCallCheck(this,t)}).\u0275mod=h.Ib({type:x}),x.\u0275inj=h.Hb({factory:function(t){return new(t||x)},imports:[[n.e.forChild(Z)],n.e]}),x);s.d(i,"PlaylistsModule",(function(){return V}));var F,V=((F=function t(){_classCallCheck(this,t)}).\u0275mod=h.Ib({type:F}),F.\u0275inj=h.Hb({factory:function(t){return new(t||F)},imports:[[a.b,T,e.a,r.b]]}),F)}}]);