(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{YxDV:function(t,e,i){"use strict";i.r(e);var s=i("ofXK"),n=i("fXoL"),o=i("3Pt+"),r=i("hDf6"),c=i("tyNb"),a=i("z6cu"),l=i("ufXC"),u=i("1gFc"),d=i("0/mZ"),h=i("ktVm"),g=i("t083"),b=i("XtVx"),m=i("tk/3"),p=i("Oz9T"),y=i("cpgm");const v=["class","container-fluid animated-page","id","nowPlaying",3,"ngClass",4,"ngIf"],f=["class","animated-page",4,"ngIf"],k=["id","nowPlaying",1,"container-fluid","animated-page",3,"ngClass"],T=[1,"top"],S=["class","image-wrapper",4,"ngIf"],w=[1,"control-wrapper-wrapper"],I=[1,"row","controls-wrapper"],P=["class","progress",4,"ngIf"],E=["id","progress-pusher",4,"ngIf"],R=["class","time start",4,"ngIf"],L=["class","time stop",4,"ngIf"],M=[1,"track-info"],D=[3,"click"],B=[1,"hidden-xs","color-type-secondary"],V=[1,"row","icons"],x=[1,"col-12"],C=[1,"btn","btn-link",3,"click"],Q=[1,"glyph","glyph-previous"],Z=["class","glyph glyph-pause",4,"ngIf"],A=["class","glyph glyph-play",4,"ngIf"],N=[1,"glyph","glyph-next"],G=["class","btn btn-link btn-love",3,"ngClass","click",4,"ngIf"],q=[1,"btn","btn-link","btn-volume","d-none","d-md-inline",3,"disabled","click"],F=[1,"glyph",3,"ngClass"],O=[1,"btn","btn-link","d-none","d-md-inline","btn-shuffle",3,"ngClass","click"],W=[1,"glyph","glyph-shuffle"],X=[1,"volume-control",3,"hidden"],j=["type","range","min","0","max","100",3,"ngModel","ngModelChange","input","change"],H=[1,"btn","btn-link","btn-updown",3,"click"],J=["id","upordown",1,"glyph","glyph-chevron-up"],U=[1,"bottom"],z=[1,"container"],K=[1,"row"],$=[3,"playlist"],Y=[1,"image-wrapper"],_=[4,"ngIf"],tt=[1,"current-album-art","always-replace",3,"mdb-BackgroundArt","swipeleft","swiperight"],et=[1,"previous-album-art",3,"swipeleft","swiperight"];function it(t,e){1&t&&n.Qb(0,"canvas")}function st(t,e){if(1&t){const t=n.Ub();n.Tb(0,"div",Y),n.Ec(1,it,1,0,"canvas",_),n.Tb(2,"div",tt),n.Zb("swipeleft",function(e){return n.vc(t),n.ec(2).next()}),n.Zb("swiperight",function(e){return n.vc(t),n.ec(2).prev()}),n.Rb(),n.Tb(3,"div",et),n.Zb("swipeleft",function(e){return n.vc(t),n.ec(2).next()}),n.Zb("swiperight",function(e){return n.vc(t),n.ec(2).prev()}),n.Rb(),n.Rb()}if(2&t){const t=n.ec(2);n.yc(1),n.kc("ngIf",t.showVisualisation),n.yc(2),n.kc("mdb-BackgroundArt",t.track)}}const nt=[1,"progress"],ot=["role","progressbar",1,"progress-bar","buffered-bar",3,"ngStyle"],rt=[1,"progress-bar",3,"ngStyle"],ct=["id","position-indicator",3,"ngStyle","ngClass"],at=function(t){return{width:t}},lt=function(t){return{"margin-left":t}},ut=function(t){return{dragging:t}};function dt(t,e){if(1&t&&(n.Tb(0,"div",nt),n.Qb(1,"div",ot),n.Qb(2,"div",rt),n.Qb(3,"div",ct),n.Rb()),2&t){const t=n.ec(2);n.yc(1),n.kc("ngStyle",n.nc(4,at,t.round(t.track.buffered.end/t.track.duration*100)+"%")),n.yc(2),n.kc("ngStyle",n.nc(6,at,t.track.position/t.track.duration*100+"%")),n.yc(3),n.kc("ngStyle",n.nc(8,lt,t.track.position/t.track.duration*100+"%"))("ngClass",n.nc(10,ut,t.isDragging))}}const ht=["id","progress-pusher"];function gt(t,e){1&t&&n.Qb(0,"div",ht)}const bt=[1,"time","start"];function mt(t,e){if(1&t&&(n.Tb(0,"span",bt),n.Gc(1),n.fc(2,"timeFormat"),n.Rb()),2&t){const t=n.ec(2);n.yc(1),n.Hc(n.gc(2,1,t.track.position))}}const pt=[1,"time","stop"];function yt(t,e){if(1&t&&(n.Tb(0,"span",pt),n.Gc(1),n.fc(2,"timeFormat"),n.Rb()),2&t){const t=n.ec(2);n.yc(1),n.Hc(n.gc(2,1,t.track.duration))}}const vt=[1,"glyph","glyph-pause"];function ft(t,e){1&t&&n.Qb(0,"i",vt)}const kt=[1,"glyph","glyph-play"];function Tt(t,e){1&t&&n.Qb(0,"i",kt)}const St=[1,"btn","btn-link","btn-love",3,"ngClass","click"],wt=[1,"glyph","glyph-star-outline"],It=function(t){return{active:t}};function Pt(t,e){if(1&t){const t=n.Ub();n.Tb(0,"button",St),n.Zb("click",function(e){return n.vc(t),n.ec(2).toggleLoved()}),n.Qb(1,"i",wt),n.Rb()}if(2&t){const t=n.ec(2);n.kc("ngClass",n.nc(1,It,t.track.isLoved))}}const Et=function(t,e,i){return{slided:t,"small-art":e,"no-focus":i}},Rt=function(t,e){return{"glyph-volume":t,"glyph-mute":e}};function Lt(t,e){if(1&t){const t=n.Ub();n.Tb(0,"div",k),n.Tb(1,"div",T),n.Ec(2,st,4,2,"div",S),n.Tb(3,"div",w),n.Tb(4,"div",I),n.Ec(5,dt,4,12,"div",P),n.Ec(6,gt,1,0,"div",E),n.Ec(7,mt,3,3,"span",R),n.Ec(8,yt,3,3,"span",L),n.Tb(9,"div",M),n.Tb(10,"h4"),n.Gc(11),n.Rb(),n.Tb(12,"h5"),n.Tb(13,"a",D),n.Zb("click",function(e){return n.vc(t),n.ec().navigateToArtist()}),n.Gc(14),n.Rb(),n.Tb(15,"span",B),n.Gc(16," \u2022 "),n.Tb(17,"a",D),n.Zb("click",function(e){return n.vc(t),n.ec().navigateToAlbum()}),n.Gc(18),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Tb(19,"div",V),n.Tb(20,"div",x),n.Tb(21,"button",C),n.Zb("click",function(e){return n.vc(t),n.ec().prev()}),n.Qb(22,"i",Q),n.Rb(),n.Tb(23,"button",C),n.Zb("click",function(e){return n.vc(t),n.ec().togglePlayPause()}),n.Ec(24,ft,1,0,"i",Z),n.Ec(25,Tt,1,0,"i",A),n.Rb(),n.Tb(26,"button",C),n.Zb("click",function(e){return n.vc(t),n.ec().next()}),n.Qb(27,"i",N),n.Rb(),n.Ec(28,Pt,2,3,"button",G),n.Tb(29,"button",q),n.Zb("click",function(e){return n.vc(t),n.ec().toggleVolumeWindow(e)}),n.Qb(30,"span",F),n.Rb(),n.Tb(31,"button",O),n.Zb("click",function(e){return n.vc(t),n.ec().toggleShuffle()}),n.Qb(32,"i",W),n.Rb(),n.Rb(),n.Tb(33,"div",X),n.Tb(34,"input",j),n.Zb("ngModelChange",function(e){return n.vc(t),n.ec().volume=e}),n.Zb("input",function(e){return n.vc(t),n.ec().setVolume()}),n.Zb("change",function(e){return n.vc(t),n.ec().setVolume()}),n.Rb(),n.Rb(),n.Tb(35,"div",x),n.Tb(36,"button",H),n.Zb("click",function(e){return n.vc(t),n.ec().toggleSlide()}),n.Qb(37,"i",J),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Tb(38,"div",U),n.Tb(39,"div",z),n.Tb(40,"div",K),n.Tb(41,"div",x),n.Qb(42,"mdb-tracklist",$),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Rb()}if(2&t){const t=n.ec();n.kc("ngClass",n.pc(18,Et,t.slided,t.smallArt,t.noFocus)),n.yc(2),n.kc("ngIf",!t.videoMode),n.yc(5),n.kc("ngIf",!t.videoMode),n.yc(6),n.kc("ngIf",!t.videoMode),n.yc(7),n.kc("ngIf",!t.videoMode),n.yc(8),n.kc("ngIf",!t.videoMode),n.yc(11),n.Hc(t.track.title),n.yc(14),n.Hc(t.track.trackArtist),n.yc(18),n.Hc(t.track.album.name),n.yc(24),n.kc("ngIf",t.isPlaying),n.yc(25),n.kc("ngIf",t.isPaused),n.yc(28),n.kc("ngIf","mdb-skipped"!==t.lastfmusername),n.yc(29),n.kc("disabled",t.videoMode),n.yc(30),n.kc("ngClass",n.oc(22,Rt,t.volume>0,0==t.volume)),n.yc(31),n.kc("ngClass",n.nc(25,It,t.isShuffled)),n.yc(33),n.kc("hidden",!t.showVolumeWindow),n.yc(34),n.kc("ngModel",t.volume),n.yc(42),n.kc("playlist",t.playlist)}}const Mt=[1,"animated-page"],Dt=[1,"jumbotron","theme-light"],Bt=[1,"row","albumdetail"],Vt=["routerLink","/artists"],xt=[1,"glyph","glyph-people"],Ct=["routerLink","/albums"],Qt=[1,"glyph","glyph-music-album"],Zt=["routerLink","/playlists"],At=[1,"glyph","glyph-music-info"];function Nt(t,e){1&t&&(n.Tb(0,"div",Mt),n.Tb(1,"div",Dt),n.Tb(2,"div",z),n.Tb(3,"div",Bt),n.Tb(4,"div",x),n.Tb(5,"h3"),n.Gc(6,"Nothing is playing"),n.Rb(),n.Tb(7,"p"),n.Gc(8," This is where you'll see the song you're playing and songs that are coming up. "),n.Rb(),n.Tb(9,"p"),n.Gc(10," Find an "),n.Tb(11,"a",Vt),n.Qb(12,"span",xt),n.Gc(13," artist"),n.Rb(),n.Gc(14," or "),n.Tb(15,"a",Ct),n.Qb(16,"span",Qt),n.Gc(17," album"),n.Rb(),n.Gc(18," that you want to play; or setup a "),n.Tb(19,"a",Zt),n.Qb(20,"span",At),n.Gc(21," playlist"),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Rb())}const Gt=[{path:"",component:(()=>{class t{constructor(t,e,i,s,n,o,r){this.pathService=t,this.coreService=e,this.playerService=i,this.router=s,this.lastFMService=n,this.animationService=o,this.http=r,this.previousTrack={},this.slided=!1,this.isPlaying=!1,this.isPaused=!1,this.isShuffled=!1,this.isDragging=!1,this.c=this,this.lastfmusername="",this.showVolumeWindow=!1,this.volume=100,this.showVisualisation=this.booleanState("visualisation-state"),this.preferVideo=this.booleanState("preferVideo-state"),this.smallArt=this.booleanState("small-art"),this.videoMode=!1,this.isEventBound=!1,this.noFocus=!1,this.timeoutTimer=null,this.timeoutTime=5e3,this.startDrag=t=>{this.isDragging=!0},this.drag=t=>{if(this.isDragging){const e=((t.clientX||t.changedTouches[0].clientX)-60)/document.getElementById("progress-pusher").clientWidth;e>=0&&e<=1&&this.setIndicatorPosition(e)}},this.stopDrag=t=>{if(this.isDragging){this.isDragging=!1;const e=((t.clientX||t.changedTouches[0].clientX)-60)/document.getElementById("progress-pusher").clientWidth;this.playerService.setPosition(this.track.duration/1e3*e)}};const c=this.playerService.getCurrentPlaylist();c&&(this.playlist=c.playlist,this.trackIndex=c.startIndex,this.isPaused=c.isPaused,this.isPlaying=c.isPlaying,this.isShuffled=c.isShuffled,this.volume=this.playerService.getVolume(),this.setTrack()),this.subscription=this.playerService.playlistAnnounced$.subscribe(t=>{this.playlist=t.playlist,this.trackIndex=t.startIndex,this.isPaused=t.isPaused,this.isPlaying=t.isPlaying,this.isShuffled=t.isShuffled,this.setTrack()}),this.subscription2=this.playerService.volumeAnnounced.subscribe(t=>{this.volume=t}),this.subscription3=this.playerService.hideVolumeWindowAnnounced$.subscribe(()=>{this.showVolumeWindow=!1}),this.pathService.announcePage("Now playing"),"ontouchstart"in document.documentElement?(document.getElementsByTagName("body")[0].addEventListener("touchmove",this.drag),document.getElementsByTagName("body")[0].addEventListener("touchend",this.stopDrag)):(document.getElementsByTagName("body")[0].addEventListener("mousemove",this.drag),document.getElementsByTagName("body")[0].addEventListener("mouseup",this.stopDrag)),this.timeoutTimer=setTimeout(()=>{this.onTimeout()},this.timeoutTime)}ngOnInit(){setTimeout(()=>{this.track&&("ontouchstart"in document.documentElement?document.getElementById("progress-pusher").addEventListener("touchstart",this.startDrag):document.getElementById("progress-pusher").addEventListener("mousedown",this.startDrag),this.isEventBound=!0)},250),this.lastfmusername=localStorage.getItem("lastfm-username")||""}setTrack(){setTimeout(()=>{this.albumart&&this.albumart.loadImage()}),this.track=this.playlist.tracks[this.trackIndex],this.currentTrack!==this.track&&(this.currentTrack=this.track,this.animationService.requestAnimation("enter",document.querySelector(".controls-wrapper h4")),this.animationService.requestAnimation("enter",document.querySelector(".controls-wrapper h5"))),this.isEventBound||setTimeout(()=>{try{"ontouchstart"in document.documentElement?document.getElementById("progress-pusher").addEventListener("touchstart",this.startDrag):document.getElementById("progress-pusher").addEventListener("mousedown",this.startDrag),this.isEventBound=!0}catch(t){console.error(t)}},250)}toggleSlide(){this.slided=!this.slided}ngOnDestroy(){this.subscription.unsubscribe(),this.subscription2.unsubscribe(),this.subscription3.unsubscribe(),"ontouchstart"in document.documentElement?(document.getElementsByTagName("body")[0].removeEventListener("touchmove",this.drag),document.getElementsByTagName("body")[0].removeEventListener("touchend",this.stopDrag)):(document.getElementsByTagName("body")[0].removeEventListener("mousemove",this.drag),document.getElementsByTagName("body")[0].removeEventListener("mouseup",this.stopDrag)),clearTimeout(this.timeoutTime)}navigateToArtist(){this.router.navigate(["/letter",this.track.album.artist.letter.escapedLetter,"artist",this.track.album.artist.sortName])}navigateToAlbum(){this.router.navigate(["/letter",this.track.album.artist.letter.escapedLetter,"artist",this.track.album.artist.sortName,"album",this.track.album.sortName])}next(){this.videoMode&&this.playerService.resume(),this.videoMode=!1,setTimeout(()=>{const t=document.querySelector(".previous-album-art");t.style.backgroundImage=document.querySelector(".current-album-art").style.backgroundImage,t.classList.remove("slideRightOut"),t.classList.remove("slideLeftOut"),this.animationService.requestAnimation("slideLeftOut",t,!1),this.trackIndex<this.playlist.tracks.length-1?(this.trackIndex++,this.playerService.next()):this.playlist.isContinues?(this.trackIndex=0,"random"===this.playlist.type||"radio"===this.playlist.type?this.playerService.nextPlaylist(this.playlist.type):this.playerService.nextAlbum(this.track.album)):this.playerService.stop()})}prev(){this.videoMode&&this.playerService.resume(),this.videoMode=!1,setTimeout(()=>{const t=document.querySelector(".previous-album-art");t.style.backgroundImage=document.querySelector(".current-album-art").style.backgroundImage,t.classList.remove("slideRightOut"),t.classList.remove("slideLeftOut"),this.animationService.requestAnimation("slideRightOut",t,!1),this.trackIndex>0&&(this.trackIndex--,this.playerService.prev())})}togglePlayPause(){this.videoMode?this.isPlaying?(this.player.pauseVideo(),this.isPlaying=!1,this.isPaused=!0):(this.player.playVideo(),this.isPlaying=!0,this.isPaused=!1):this.playerService.togglePlayPause()}toggleShuffle(){this.isShuffled=!this.isShuffled,this.playerService.shufflePlaylist(this.isShuffled)}toggleLoved(){this.track.isLoved=!this.track.isLoved,this.lastFMService.toggleLoved(this.track).subscribe(t=>{console.info(t)})}setIndicatorPosition(t){document.getElementById("position-indicator").style.marginLeft=100*t+"%"}toggleVolumeWindow(t){t.stopPropagation(),t.stopImmediatePropagation(),t.preventDefault(),this.showVolumeWindow=!this.showVolumeWindow}setVolume(){this.playerService.setVolume(this.volume)}round(t){return Math.floor(t)}handleError(t){return Object(a.a)("no video")}toggleVideo(){this.videoMode=!this.videoMode,this.videoMode?this.playerService.pause():this.playerService.togglePlayPause()}savePlayer(t){this.player=t,this.player.playVideo(),this.isPlaying=!0,this.isPaused=!1}onStateChange(t){0===t.data&&(this.videoMode=!1,this.next())}onTimeout(){this.slided||this.videoMode||(this.noFocus=!0)}onMove(t){clearTimeout(this.timeoutTimer),this.noFocus=!1,this.timeoutTimer=setTimeout(()=>{this.onTimeout()},this.timeoutTime)}booleanState(t){const e=localStorage.getItem(t);return!(!e||"true"!==e)}}return t.ngComponentDef=n.Jb({type:t,selectors:[["ng-component"]],factory:function(e){return new(e||t)(n.Pb(b.a),n.Pb(h.a),n.Pb(l.a),n.Pb(c.c),n.Pb(g.a),n.Pb(u.a),n.Pb(m.a))},viewQuery:function(t,e){var i;1&t&&n.Kc(d.a,!0,null),2&t&&n.sc(i=n.bc())&&(e.albumart=i.first)},hostBindings:function(t,e,i){1&t&&n.Zb("mousemove",function(t){return e.onMove(t)})},consts:2,vars:2,template:function(t,e){1&t&&(n.Ec(0,Lt,43,27,"div",v),n.Ec(1,Nt,22,0,"div",f)),2&t&&(n.kc("ngIf",e.track),n.yc(1),n.kc("ngIf",!e.track))},directives:[s.l,s.j,o.l,o.a,o.f,o.i,p.a,d.a,s.m,c.d],pipes:[y.a],encapsulation:2}),t})()}];let qt=(()=>{class t{}return t.ngModuleDef=n.Nb({type:t}),t.ngInjectorDef=n.Mb({factory:function(e){return new(e||t)},imports:[[c.e.forChild(Gt)],c.e]}),t.ngLocaleIdDef="en-GB",t})();c.e.forChild(Gt),i.d(e,"NowPlayingModule",function(){return Ft});let Ft=(()=>{class t{}return t.ngModuleDef=n.Nb({type:t}),t.ngInjectorDef=n.Mb({factory:function(e){return new(e||t)},imports:[[s.c,qt,r.a,o.b]]}),t.ngLocaleIdDef="en-GB",t})()}}]);