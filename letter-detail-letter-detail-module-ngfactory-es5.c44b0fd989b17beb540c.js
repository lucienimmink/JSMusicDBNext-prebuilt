(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"0/mZ":function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n("ztCj"),a=(n("xOws"),function(t,e,n,r){return new(n||(n=Promise))(function(a,i){function s(t){try{l(r.next(t))}catch(e){i(e)}}function o(t){try{l(r.throw(t))}catch(e){i(e)}}function l(t){t.done?a(t.value):new n(function(e){e(t.value)}).then(s,o)}l((r=r.apply(t,e||[])).next())})}),i=function(t,e){var n,r,a,i,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(i){return function(o){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){s.label=i[1];break}if(6===i[0]&&s.label<a[1]){s.label=a[1],a=i;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(i);break}a[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(o){i=[6,o],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,o])}}},s=function(){function t(t,e){var n=this;this.backgroundArtService=e,this.NOIMAGE="global/images/no-cover.png",this.loading=!1,this.loaded=!1,this.error=!1,this.loadingClass="loading",this.loadedClass="loaded",this.errorClass="error",this.el=t.nativeElement,setTimeout(function(){n.loadImage()},100)}return t.prototype.loadImage=function(){var t=this;if(!this.loaded&&!this.loading||this.hasClassName("always-replace")){this.loading=!0,this.addClassName(this.loadingClass);var e="art-"+this.media.name;this.media.artist&&!this.media.trackArtist?e="art-"+this.media.artist.name+"-"+this.media.name:this.media.trackArtist&&(e="art-"+this.media.trackArtist+"-"+this.media.album.name),Object(r.c)(e).then(function(e){e?t.setImage(e):t.backgroundArtService.getMediaArt(t.media).subscribe(function(e){return t.setImage(e)},function(e){t.el.style.backgroundImage="url("+t.NOIMAGE+")",t.error=!0,t.loading=!1,t.removeClassName(t.loadingClass),t.addClassName(t.errorClass)})})}},t.prototype.setImage=function(t){return a(this,void 0,void 0,function(){var e,n,s=this;return i(this,function(o){switch(o.label){case 0:return(e=localStorage.getItem("dsm"))&&(e+="/data/image-proxy?url="),this.loaded&&!this.hasClassName("always-replace")?[3,4]:t!==this.NOIMAGE&&""!==t&&t?[3,1]:(this.backgroundArtService.getMediaArtFromLastFm(this.media).subscribe(function(t){return a(s,void 0,void 0,function(){var n;return i(this,function(a){switch(a.label){case 0:return[4,this.backgroundArtService.returnImageUrlFromLastFMResponse(t)];case 1:return(t=a.sent())&&t!==this.NOIMAGE?this.el.style.backgroundImage="url("+e+encodeURIComponent(t)+")":(t||(t=this.NOIMAGE),this.el.style.backgroundImage="url("+t+")"),n={_id:"art-"+this.media.name,url:t||this.NOIMAGE},this.media.artist&&(n._id="art-"+this.media.artist.name+"-"+this.media.name),Object(r.d)(n._id,n.url),[2]}})})},function(t){return s.el.style.backgroundImage="url("+s.NOIMAGE+")"}),[3,3]);case 1:return[4,this.backgroundArtService.returnImageUrlFromLastFMResponse(t)];case 2:t=o.sent(),this.el.style.backgroundImage=t?"url("+t+")":"url("+this.NOIMAGE+")",n={_id:"art-"+this.media.name,url:t||this.NOIMAGE},this.media.artist&&(n._id="art-"+this.media.artist.name+"-"+this.media.name),Object(r.d)(n._id,n.url),o.label=3;case 3:this.loading=!1,this.toggleLoaded(!0),o.label=4;case 4:return[2]}})})},t.prototype.getPosition=function(){var t=this.el.getBoundingClientRect(),e=t.top+(window.pageYOffset-document.documentElement.clientTop);return{top:e,left:t.left+(window.pageXOffset-document.documentElement.clientLeft),bottom:e+this.el.clientHeight}},t.prototype.getLoadingContainer=function(){return this.el},t.prototype.hasClassName=function(t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(this.getLoadingContainer().className)},t.prototype.addClassName=function(t){if(!this.hasClassName(t)){var e=this.getLoadingContainer();e.className=e.className?[e.className,t].join(" "):t}},t.prototype.removeClassName=function(t){if(this.hasClassName(t)){var e=this.getLoadingContainer();e.className=e.className.replace(new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)","g"),"")}},t.prototype.toggleLoaded=function(t){this.loaded=t,t?(this.removeClassName(this.loadingClass),this.addClassName(this.loadedClass)):this.removeClassName(this.loadedClass)},t}()},g2JG:function(t,e,n){"use strict";n.r(e);var r=n("CcnG"),a=function(){return function(){}}(),i=n("pMnS"),s=n("BZiF"),o=n("EAnT"),l=n("ZYCi"),u=n("Ip0R"),c=n("ktVm"),h=n("XtVx"),d=function(){function t(t,e,n,r){var a=this;this.coreService=t,this.router=e,this.pathService=n,this.route=r,this.artists=[],this.sorting=[{name:"name",value:"sortName"},{name:"albums",value:"albums"}],this.core=this.coreService.getCore(),this.subscription=this.core.coreParsed$.subscribe(function(t){a.ngOnInit()}),this.letter=decodeURIComponent(this.route.snapshot.params.letter),this.route.params.subscribe(function(t){a.letter=decodeURIComponent(t.letter),a.ngOnInit()})}return t.prototype.ngOnInit=function(){this.coreletter=this.core.letters[this.letter],this.coreletter&&(this.pathService.announcePage("JSMusicDB Next",this.coreletter),this.artists=this.coreletter.sortAndReturnArtistsBy("sortName","asc"))},t.prototype.onSelect=function(t){this.router.navigate(["Artist",{letter:t.letter.escapedLetter,artist:t.sortName}])},t.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},t.prototype.onSortChange=function(t,e){this.artists=this.coreletter.sortAndReturnArtistsBy(e,"asc")},t}(),m=r.ob({encapsulation:2,styles:[],data:{}});function f(t){return r.Lb(0,[(t()(),r.qb(0,0,null,null,2,"div",[["class","artist-panel media-panel"]],null,null,null,null,null)),(t()(),r.qb(1,0,null,null,1,"mdb-artist",[],null,null,null,s.b,s.a)),r.pb(2,49152,null,0,o.a,[l.k],{artist:[0,"artist"]},null)],function(t,e){t(e,2,0,e.context.$implicit)},null)}function p(t){return r.Lb(0,[(t()(),r.qb(0,0,null,null,2,"div",[["class","media-container animated-page"]],null,null,null,null,null)),(t()(),r.gb(16777216,null,null,1,null,f)),r.pb(2,278528,null,0,u.j,[r.O,r.L,r.s],{ngForOf:[0,"ngForOf"]},null)],function(t,e){t(e,2,0,e.component.artists)},null)}function b(t){return r.Lb(0,[(t()(),r.qb(0,0,null,null,1,"app-letter-detail",[],null,null,null,p,m)),r.pb(1,245760,null,0,d,[c.a,l.k,h.a,l.a],null,null)],function(t,e){t(e,1,0)},null)}var g=r.mb("app-letter-detail",d,b,{},{},[]),v=function(){return function(){}}(),y=n("hDf6");n.d(e,"LetterDetailModuleNgFactory",function(){return A});var A=r.nb(a,[],function(t){return r.zb([r.Ab(512,r.j,r.Z,[[8,[i.a,g]],[3,r.j],r.x]),r.Ab(4608,u.m,u.l,[r.u,[2,u.z]]),r.Ab(1073742336,u.b,u.b,[]),r.Ab(1073742336,l.m,l.m,[[2,l.r],[2,l.k]]),r.Ab(1073742336,v,v,[]),r.Ab(1073742336,y.a,y.a,[]),r.Ab(1073742336,a,a,[]),r.Ab(256,r.u,"en-GB",[]),r.Ab(1024,l.i,function(){return[[{path:"",component:d}]]},[])])})},xOws:function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n("XWo6"),a=function(t,e,n,r){return new(n||(n=Promise))(function(a,i){function s(t){try{l(r.next(t))}catch(e){i(e)}}function o(t){try{l(r.throw(t))}catch(e){i(e)}}function l(t){t.done?a(t.value):new n(function(e){e(t.value)}).then(s,o)}l((r=r.apply(t,e||[])).next())})},i=function(t,e){var n,r,a,i,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(i){return function(o){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){s.label=i[1];break}if(6===i[0]&&s.label<a[1]){s.label=a[1],a=i;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(i);break}a[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(o){i=[6,o],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,o])}}},s=function(){function t(t){this.http=t,this.API_KEY="639fca5adcf955a19f9a04f8985e9ded",this.lastFMImageRetriever=new r.a(t)}return t.prototype.getMediaArt=function(t){var e=this.extractInfo(t);return this.lastFMImageRetriever.getMediaArt(e.artist,e.album,e.type)},t.prototype.getMediaArtFromLastFm=function(t){var e=this.extractInfo(t);return this.lastFMImageRetriever.getMediaArt(e.artist,e.album,e.type)},t.prototype.returnImageUrlFromLastFMResponse=function(t){return a(this,void 0,void 0,function(){var e;return i(this,function(n){return t.album?[2,t.album.image[t.album.image.length-1]["#text"]]:t.artist?(e=t.artist.mbid)?[2,this.getArtistURLArtFormFanart(e,t.artist)]:[2,t.artist.image[t.artist.image.length-1]["#text"]]:[2,t]})})},t.prototype.getArtistURLArtFormFanart=function(t,e){return a(this,void 0,void 0,function(){var n,r;return i(this,function(a){switch(a.label){case 0:return[4,fetch("https://webservice.fanart.tv/v3/music/"+t+"&?api_key="+this.API_KEY+"&format=json")];case 1:return 200!==(n=a.sent()).status?[3,3]:[4,n.json()];case 2:if((r=a.sent()).artistbackground)return[2,r.artistbackground[0].url];a.label=3;case 3:return[2,this.getArtistURLArtFromAudioDB(e)]}})})},t.prototype.getArtistURLArtFromAudioDB=function(t){return a(this,void 0,void 0,function(){var e,n;return i(this,function(r){switch(r.label){case 0:return[4,fetch("https://www.theaudiodb.com/api/v1/json/1/search.php?s="+encodeURIComponent(t.name))];case 1:return 200!==(e=r.sent()).status?[3,3]:[4,e.json()];case 2:if((n=r.sent())&&n.artists)return[2,n.artists[0].strArtistFanart];r.label=3;case 3:return[2,t.image[t.image.length-1]["#text"]]}})})},t.prototype.extractInfo=function(t){var e="",n="",r="artist";return t.trackArtist&&t.album.artist.isCollection?e=t.trackArtist:t.artist?(e=t.artist.albumArtist||t.artist.name,n=t.name||t.album.name,r="album"):e=t.albumArtist||t.name,{artist:e,album:n,type:r}},t}()}}]);